function msieversion(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");return t>0?parseInt(e.substring(t+5,e.indexOf(".",t))):0}var Handlebars=function(){var e=function(){"use strict";function e(e){this.string=e}var t;return e.prototype.toString=function(){return""+this.string},t=e}(),t=function(e){"use strict";function t(e){return a[e]||"&amp;"}function i(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}function n(e){return e instanceof r?e.toString():e||0===e?(e=""+e,c.test(e)?e.replace(l,t):e):""}function s(e){return e||0===e?h(e)&&0===e.length?!0:!1:!0}var o={},r=e,a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},l=/[&<>"'`]/g,c=/[&<>"'`]/;o.extend=i;var d=Object.prototype.toString;o.toString=d;var u=function(e){return"function"==typeof e};u(/x/)&&(u=function(e){return"function"==typeof e&&"[object Function]"===d.call(e)});var u;o.isFunction=u;var h=Array.isArray||function(e){return e&&"object"==typeof e?"[object Array]"===d.call(e):!1};return o.isArray=h,o.escapeExpression=n,o.isEmpty=s,o}(e),i=function(){"use strict";function e(e,t){var n;t&&t.firstLine&&(n=t.firstLine,e+=" - "+n+":"+t.firstColumn);for(var s=Error.prototype.constructor.call(this,e),o=0;o<i.length;o++)this[i[o]]=s[i[o]];n&&(this.lineNumber=n,this.column=t.firstColumn)}var t,i=["description","fileName","lineNumber","message","name","number","stack"];return e.prototype=new Error,t=e}(),n=function(e,t){"use strict";function i(e,t){this.helpers=e||{},this.partials=t||{},n(this)}function n(e){e.registerHelper("helperMissing",function(e){if(2===arguments.length)return void 0;throw new a("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,i){var n=i.inverse||function(){},s=i.fn;return h(t)&&(t=t.call(this)),t===!0?s(this):t===!1||null==t?n(this):u(t)?t.length>0?e.helpers.each(t,i):n(this):s(t)}),e.registerHelper("each",function(e,t){var i,n=t.fn,s=t.inverse,o=0,r="";if(h(e)&&(e=e.call(this)),t.data&&(i=g(t.data)),e&&"object"==typeof e)if(u(e))for(var a=e.length;a>o;o++)i&&(i.index=o,i.first=0===o,i.last=o===e.length-1),r+=n(e[o],{data:i});else for(var l in e)e.hasOwnProperty(l)&&(i&&(i.key=l,i.index=o,i.first=0===o),r+=n(e[l],{data:i}),o++);return 0===o&&(r=s(this)),r}),e.registerHelper("if",function(e,t){return h(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||r.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,i){return e.helpers["if"].call(this,t,{fn:i.inverse,inverse:i.fn,hash:i.hash})}),e.registerHelper("with",function(e,t){return h(e)&&(e=e.call(this)),r.isEmpty(e)?void 0:t.fn(e)}),e.registerHelper("log",function(t,i){var n=i.data&&null!=i.data.level?parseInt(i.data.level,10):1;e.log(n,t)})}function s(e,t){m.log(e,t)}var o={},r=e,a=t,l="1.3.0";o.VERSION=l;var c=4;o.COMPILER_REVISION=c;var d={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};o.REVISION_CHANGES=d;var u=r.isArray,h=r.isFunction,p=r.toString,f="[object Object]";o.HandlebarsEnvironment=i,i.prototype={constructor:i,logger:m,log:s,registerHelper:function(e,t,i){if(p.call(e)===f){if(i||t)throw new a("Arg not supported with multiple helpers");r.extend(this.helpers,e)}else i&&(t.not=i),this.helpers[e]=t},registerPartial:function(e,t){p.call(e)===f?r.extend(this.partials,e):this.partials[e]=t}};var m={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){if(m.level<=e){var i=m.methodMap[e];"undefined"!=typeof console&&console[i]&&console[i].call(console,t)}}};o.logger=m,o.log=s;var g=function(e){var t={};return r.extend(t,e),t};return o.createFrame=g,o}(t,i),s=function(e,t,i){"use strict";function n(e){var t=e&&e[0]||1,i=h;if(t!==i){if(i>t){var n=p[i],s=p[t];throw new u("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+s+").")}throw new u("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function s(e,t){if(!t)throw new u("No environment passed to template");var i=function(e,i,n,s,o,r){var a=t.VM.invokePartial.apply(this,arguments);if(null!=a)return a;if(t.compile){var l={helpers:s,partials:o,data:r};return o[i]=t.compile(e,{data:void 0!==r},t),o[i](n,l)}throw new u("The partial "+i+" could not be compiled when running in runtime-only mode")},n={escapeExpression:d.escapeExpression,invokePartial:i,programs:[],program:function(e,t,i){var n=this.programs[e];return i?n=r(e,t,i):n||(n=this.programs[e]=r(e,t)),n},merge:function(e,t){var i=e||t;return e&&t&&e!==t&&(i={},d.extend(i,t),d.extend(i,e)),i},programWithDepth:t.VM.programWithDepth,noop:t.VM.noop,compilerInfo:null};return function(i,s){s=s||{};var o,r,a=s.partial?s:t;s.partial||(o=s.helpers,r=s.partials);var l=e.call(n,a,i,o,r,s.data);return s.partial||t.VM.checkRevision(n.compilerInfo),l}}function o(e,t,i){var n=Array.prototype.slice.call(arguments,3),s=function(e,s){return s=s||{},t.apply(this,[e,s.data||i].concat(n))};return s.program=e,s.depth=n.length,s}function r(e,t,i){var n=function(e,n){return n=n||{},t(e,n.data||i)};return n.program=e,n.depth=0,n}function a(e,t,i,n,s,o){var r={partial:!0,helpers:n,partials:s,data:o};if(void 0===e)throw new u("The partial "+t+" could not be found");return e instanceof Function?e(i,r):void 0}function l(){return""}var c={},d=e,u=t,h=i.COMPILER_REVISION,p=i.REVISION_CHANGES;return c.checkRevision=n,c.template=s,c.programWithDepth=o,c.program=r,c.invokePartial=a,c.noop=l,c}(t,i,n),o=function(e,t,i,n,s){"use strict";var o,r=e,a=t,l=i,c=n,d=s,u=function(){var e=new r.HandlebarsEnvironment;return c.extend(e,r),e.SafeString=a,e.Exception=l,e.Utils=c,e.VM=d,e.template=function(t){return d.template(t,e)},e},h=u();return h.create=u,o=h}(n,e,i,t,s),r=function(e){"use strict";function t(e){e=e||{},this.firstLine=e.first_line,this.firstColumn=e.first_column,this.lastColumn=e.last_column,this.lastLine=e.last_line}var i,n=e,s={ProgramNode:function(e,i,n,o){var r,a;3===arguments.length?(o=n,n=null):2===arguments.length&&(o=i,i=null),t.call(this,o),this.type="program",this.statements=e,this.strip={},n?(a=n[0],a?(r={first_line:a.firstLine,last_line:a.lastLine,last_column:a.lastColumn,first_column:a.firstColumn},this.inverse=new s.ProgramNode(n,i,r)):this.inverse=new s.ProgramNode(n,i),this.strip.right=i.left):i&&(this.strip.left=i.right)},MustacheNode:function(e,i,n,o,r){if(t.call(this,r),this.type="mustache",this.strip=o,null!=n&&n.charAt){var a=n.charAt(3)||n.charAt(2);this.escaped="{"!==a&&"&"!==a}else this.escaped=!!n;this.sexpr=e instanceof s.SexprNode?e:new s.SexprNode(e,i),this.sexpr.isRoot=!0,this.id=this.sexpr.id,this.params=this.sexpr.params,this.hash=this.sexpr.hash,this.eligibleHelper=this.sexpr.eligibleHelper,this.isHelper=this.sexpr.isHelper},SexprNode:function(e,i,n){t.call(this,n),this.type="sexpr",this.hash=i;var s=this.id=e[0],o=this.params=e.slice(1),r=this.eligibleHelper=s.isSimple;this.isHelper=r&&(o.length||i)},PartialNode:function(e,i,n,s){t.call(this,s),this.type="partial",this.partialName=e,this.context=i,this.strip=n},BlockNode:function(e,i,s,o,r){if(t.call(this,r),e.sexpr.id.original!==o.path.original)throw new n(e.sexpr.id.original+" doesn't match "+o.path.original,this);this.type="block",this.mustache=e,this.program=i,this.inverse=s,this.strip={left:e.strip.left,right:o.strip.right},(i||s).strip.left=e.strip.right,(s||i).strip.right=o.strip.left,s&&!i&&(this.isInverse=!0)},ContentNode:function(e,i){t.call(this,i),this.type="content",this.string=e},HashNode:function(e,i){t.call(this,i),this.type="hash",this.pairs=e},IdNode:function(e,i){t.call(this,i),this.type="ID";for(var s="",o=[],r=0,a=0,l=e.length;l>a;a++){var c=e[a].part;if(s+=(e[a].separator||"")+c,".."===c||"."===c||"this"===c){if(o.length>0)throw new n("Invalid path: "+s,this);".."===c?r++:this.isScoped=!0}else o.push(c)}this.original=s,this.parts=o,this.string=o.join("."),this.depth=r,this.isSimple=1===e.length&&!this.isScoped&&0===r,this.stringModeValue=this.string},PartialNameNode:function(e,i){t.call(this,i),this.type="PARTIAL_NAME",this.name=e.original},DataNode:function(e,i){t.call(this,i),this.type="DATA",this.id=e},StringNode:function(e,i){t.call(this,i),this.type="STRING",this.original=this.string=this.stringModeValue=e},IntegerNode:function(e,i){t.call(this,i),this.type="INTEGER",this.original=this.integer=e,this.stringModeValue=Number(e)},BooleanNode:function(e,i){t.call(this,i),this.type="BOOLEAN",this.bool=e,this.stringModeValue="true"===e},CommentNode:function(e,i){t.call(this,i),this.type="comment",this.comment=e}};return i=s}(i),a=function(){"use strict";var e,t=function(){function e(e,t){return{left:"~"===e.charAt(2),right:"~"===t.charAt(0)||"~"===t.charAt(1)}}function t(){this.yy={}}var i={trace:function(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,sexpr:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,sexpr_repetition0:28,sexpr_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,OPEN_SEXPR:35,CLOSE_SEXPR:36,hash:37,hash_repetition_plus0:38,hashSegment:39,ID:40,EQUALS:41,DATA:42,pathSegments:43,SEP:44,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",35:"OPEN_SEXPR",36:"CLOSE_SEXPR",40:"ID",41:"EQUALS",42:"DATA",44:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[31,3],[37,1],[39,3],[26,1],[26,1],[26,1],[30,2],[21,1],[43,3],[43,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[38,1],[38,2]],performAction:function(t,i,n,s,o,r){var a=r.length-1;switch(o){case 1:return new s.ProgramNode(r[a-1],this._$);case 2:return new s.ProgramNode([],this._$);case 3:this.$=new s.ProgramNode([],r[a-1],r[a],this._$);break;case 4:this.$=new s.ProgramNode(r[a-2],r[a-1],r[a],this._$);break;case 5:this.$=new s.ProgramNode(r[a-1],r[a],[],this._$);break;case 6:this.$=new s.ProgramNode(r[a],this._$);break;case 7:this.$=new s.ProgramNode([],this._$);break;case 8:this.$=new s.ProgramNode([],this._$);break;case 9:this.$=[r[a]];break;case 10:r[a-1].push(r[a]),this.$=r[a-1];break;case 11:this.$=new s.BlockNode(r[a-2],r[a-1].inverse,r[a-1],r[a],this._$);break;case 12:this.$=new s.BlockNode(r[a-2],r[a-1],r[a-1].inverse,r[a],this._$);break;case 13:this.$=r[a];break;case 14:this.$=r[a];break;case 15:this.$=new s.ContentNode(r[a],this._$);break;case 16:this.$=new s.CommentNode(r[a],this._$);break;case 17:this.$=new s.MustacheNode(r[a-1],null,r[a-2],e(r[a-2],r[a]),this._$);break;case 18:this.$=new s.MustacheNode(r[a-1],null,r[a-2],e(r[a-2],r[a]),this._$);break;case 19:this.$={path:r[a-1],strip:e(r[a-2],r[a])};break;case 20:this.$=new s.MustacheNode(r[a-1],null,r[a-2],e(r[a-2],r[a]),this._$);break;case 21:this.$=new s.MustacheNode(r[a-1],null,r[a-2],e(r[a-2],r[a]),this._$);break;case 22:this.$=new s.PartialNode(r[a-2],r[a-1],e(r[a-3],r[a]),this._$);break;case 23:this.$=e(r[a-1],r[a]);break;case 24:this.$=new s.SexprNode([r[a-2]].concat(r[a-1]),r[a],this._$);break;case 25:this.$=new s.SexprNode([r[a]],null,this._$);break;case 26:this.$=r[a];break;case 27:this.$=new s.StringNode(r[a],this._$);break;case 28:this.$=new s.IntegerNode(r[a],this._$);break;case 29:this.$=new s.BooleanNode(r[a],this._$);break;case 30:this.$=r[a];break;case 31:r[a-1].isHelper=!0,this.$=r[a-1];break;case 32:this.$=new s.HashNode(r[a],this._$);break;case 33:this.$=[r[a-2],r[a]];break;case 34:this.$=new s.PartialNameNode(r[a],this._$);break;case 35:this.$=new s.PartialNameNode(new s.StringNode(r[a],this._$),this._$);break;case 36:this.$=new s.PartialNameNode(new s.IntegerNode(r[a],this._$));break;case 37:this.$=new s.DataNode(r[a],this._$);break;case 38:this.$=new s.IdNode(r[a],this._$);break;case 39:r[a-2].push({part:r[a],separator:r[a-1]}),this.$=r[a-2];break;case 40:this.$=[{part:r[a]}];break;case 43:this.$=[];break;case 44:r[a-1].push(r[a]);break;case 47:this.$=[r[a]];break;case 48:r[a-1].push(r[a])}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:29,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:30,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:31,21:24,30:25,40:[1,28],42:[1,27],43:26},{21:33,26:32,32:[1,34],33:[1,35],40:[1,28],43:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,40:[1,28],42:[1,27],43:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,43],24:[2,43],28:43,32:[2,43],33:[2,43],34:[2,43],35:[2,43],36:[2,43],40:[2,43],42:[2,43]},{18:[2,25],24:[2,25],36:[2,25]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],35:[2,38],36:[2,38],40:[2,38],42:[2,38],44:[1,44]},{21:45,40:[1,28],43:26},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],42:[2,40],44:[2,40]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,41],21:50,27:49,40:[1,28],43:26},{18:[2,34],40:[2,34]},{18:[2,35],40:[2,35]},{18:[2,36],40:[2,36]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,40:[1,28],43:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,45],21:56,24:[2,45],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:[1,61],36:[2,45],37:55,38:62,39:63,40:[1,64],42:[1,27],43:26},{40:[1,65]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],35:[2,37],36:[2,37],40:[2,37],42:[2,37]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,66]},{18:[2,42]},{18:[1,67]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24],36:[2,24]},{18:[2,44],24:[2,44],32:[2,44],33:[2,44],34:[2,44],35:[2,44],36:[2,44],40:[2,44],42:[2,44]},{18:[2,46],24:[2,46],36:[2,46]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26],40:[2,26],42:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27],40:[2,27],42:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28],40:[2,28],42:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],35:[2,29],36:[2,29],40:[2,29],42:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],35:[2,30],36:[2,30],40:[2,30],42:[2,30]},{17:68,21:24,30:25,40:[1,28],42:[1,27],43:26},{18:[2,32],24:[2,32],36:[2,32],39:69,40:[1,70]},{18:[2,47],24:[2,47],36:[2,47],40:[2,47]},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],41:[1,71],42:[2,40],44:[2,40]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],35:[2,39],36:[2,39],40:[2,39],42:[2,39],44:[2,39]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{36:[1,72]},{18:[2,48],24:[2,48],36:[2,48],40:[2,48]},{41:[1,71]},{21:56,30:60,31:73,32:[1,57],33:[1,58],34:[1,59],35:[1,61],40:[1,28],42:[1,27],43:26},{18:[2,31],24:[2,31],32:[2,31],33:[2,31],34:[2,31],35:[2,31],36:[2,31],40:[2,31],42:[2,31]},{18:[2,33],24:[2,33],36:[2,33],40:[2,33]}],defaultActions:{3:[2,2],16:[2,1],50:[2,42]},parseError:function(e){throw new Error(e)},parse:function(e){function t(){var e;return e=i.lexer.lex()||1,"number"!=typeof e&&(e=i.symbols_[e]||e),e}var i=this,n=[0],s=[null],o=[],r=this.table,a="",l=0,c=0,d=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;o.push(u);var h=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,g,v,y,b,w,_,x={};;){if(m=n[n.length-1],this.defaultActions[m]?g=this.defaultActions[m]:((null===p||"undefined"==typeof p)&&(p=t()),g=r[m]&&r[m][p]),"undefined"==typeof g||!g.length||!g[0]){var k="";if(!d){_=[];for(y in r[m])this.terminals_[y]&&y>2&&_.push("'"+this.terminals_[y]+"'");k=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+_.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(k,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:u,expected:_})}}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);switch(g[0]){case 1:n.push(p),s.push(this.lexer.yytext),o.push(this.lexer.yylloc),n.push(g[1]),p=null,f?(p=f,f=null):(c=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,u=this.lexer.yylloc,d>0&&d--);break;case 2:if(b=this.productions_[g[1]][1],x.$=s[s.length-b],x._$={first_line:o[o.length-(b||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(b||1)].first_column,last_column:o[o.length-1].last_column},h&&(x._$.range=[o[o.length-(b||1)].range[0],o[o.length-1].range[1]]),v=this.performAction.call(x,a,c,l,this.yy,g[1],s,o),"undefined"!=typeof v)return v;b&&(n=n.slice(0,-1*b*2),s=s.slice(0,-1*b),o=o.slice(0,-1*b)),n.push(this.productions_[g[1]][0]),s.push(x.$),o.push(x._$),w=r[n[n.length-2]][n[n.length-1]],n.push(w);break;case 3:return!0}}return!0}},n=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,i=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var s=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[s[0],s[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,i,n,s;this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),r=0;r<o.length&&(i=this._input.match(this.rules[o[r]]),!i||t&&!(i[0].length>t[0].length)||(t=i,n=r,this.options.flex));r++);return t?(s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e?e:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return"undefined"!=typeof e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.options={},e.performAction=function(e,t,i,n){function s(e,i){return t.yytext=t.yytext.substr(e,t.yyleng-i)}switch(i){case 0:if("\\\\"===t.yytext.slice(-2)?(s(0,1),this.begin("mu")):"\\"===t.yytext.slice(-1)?(s(0,1),this.begin("emu")):this.begin("mu"),t.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return s(0,4),this.popState(),15;case 4:return 35;case 5:return 36;case 6:return 25;case 7:return 16;case 8:return 20;case 9:return 19;case 10:return 19;case 11:return 23;case 12:return 22;case 13:this.popState(),this.begin("com");break;case 14:return s(3,5),this.popState(),15;case 15:return 22;case 16:return 41;case 17:return 40;case 18:return 40;case 19:return 44;case 20:break;case 21:return this.popState(),24;case 22:return this.popState(),18;case 23:return t.yytext=s(1,2).replace(/\\"/g,'"'),32;case 24:return t.yytext=s(1,2).replace(/\\'/g,"'"),32;case 25:return 42;case 26:return 34;case 27:return 34;case 28:return 33;case 29:return 40;case 30:return t.yytext=s(1,2),40;case 31:return"INVALID";case 32:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},INITIAL:{rules:[0,1,32],inclusive:!0}},e}();return i.lexer=n,t.prototype=i,i.Parser=t,new t}();return e=t}(),l=function(e,t){"use strict";function i(e){return e.constructor===o.ProgramNode?e:(s.yy=o,s.parse(e))}var n={},s=e,o=t;return n.parser=s,n.parse=i,n}(a,r),c=function(e){"use strict";function t(){}function i(e,t,i){if(null==e||"string"!=typeof e&&e.constructor!==i.AST.ProgramNode)throw new o("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);t=t||{},"data"in t||(t.data=!0);var n=i.parse(e),s=(new i.Compiler).compile(n,t);return(new i.JavaScriptCompiler).compile(s,t)}function n(e,t,i){function n(){var n=i.parse(e),s=(new i.Compiler).compile(n,t),o=(new i.JavaScriptCompiler).compile(s,t,void 0,!0);return i.template(o)}if(null==e||"string"!=typeof e&&e.constructor!==i.AST.ProgramNode)throw new o("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);t=t||{},"data"in t||(t.data=!0);var s;return function(e,t){return s||(s=n()),s.call(this,e,t)}}var s={},o=e;return s.Compiler=t,t.prototype={compiler:t,disassemble:function(){for(var e,t,i,n=this.opcodes,s=[],o=0,r=n.length;r>o;o++)if(e=n[o],"DECLARE"===e.opcode)s.push("DECLARE "+e.name+"="+e.value);else{t=[];for(var a=0;a<e.args.length;a++)i=e.args[a],"string"==typeof i&&(i='"'+i.replace("\n","\\n")+'"'),t.push(i);s.push(e.opcode+" "+t.join(" "))}return s.join("\n")},equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var i=0;t>i;i++){var n=this.opcodes[i],s=e.opcodes[i];if(n.opcode!==s.opcode||n.args.length!==s.args.length)return!1;for(var o=0;o<n.args.length;o++)if(n.args[o]!==s.args[o])return!1}if(t=this.children.length,e.children.length!==t)return!1;for(i=0;t>i;i++)if(!this.children[i].equals(e.children[i]))return!1;return!0},guid:0,compile:function(e,t){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=t;var i=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},i)for(var n in i)this.options.knownHelpers[n]=i[n];return this.accept(e)},accept:function(e){var t,i=e.strip||{};return i.left&&this.opcode("strip"),t=this[e.type](e),i.right&&this.opcode("strip"),t},program:function(e){for(var t=e.statements,i=0,n=t.length;n>i;i++)this.accept(t[i]);return this.isSimple=1===n,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t,i=(new this.compiler).compile(e,this.options),n=this.guid++;this.usePartial=this.usePartial||i.usePartial,this.children[n]=i;for(var s=0,o=i.depths.list.length;o>s;s++)t=i.depths.list[s],2>t||this.addDepth(t-1);return n},block:function(e){var t=e.mustache,i=e.program,n=e.inverse;i&&(i=this.compileProgram(i)),n&&(n=this.compileProgram(n));var s=t.sexpr,o=this.classifySexpr(s);"helper"===o?this.helperSexpr(s,i,n):"simple"===o?(this.simpleSexpr(s),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousSexpr(s,i,n),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t,i,n=e.pairs;this.opcode("pushHash");for(var s=0,o=n.length;o>s;s++)t=n[s],i=t[1],this.options.stringParams?(i.depth&&this.addDepth(i.depth),this.opcode("getContext",i.depth||0),this.opcode("pushStringParam",i.stringModeValue,i.type),"sexpr"===i.type&&this.sexpr(i)):this.accept(i),this.opcode("assignToHash",t[0]);this.opcode("popHash")},partial:function(e){var t=e.partialName;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.name),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){this.sexpr(e.sexpr),this.opcode(e.escaped&&!this.options.noEscape?"appendEscaped":"append")},ambiguousSexpr:function(e,t,i){var n=e.id,s=n.parts[0],o=null!=t||null!=i;this.opcode("getContext",n.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",i),this.opcode("invokeAmbiguous",s,o)},simpleSexpr:function(e){var t=e.id;"DATA"===t.type?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,i){var n=this.setupFullMustacheParams(e,t,i),s=e.id.parts[0];if(this.options.knownHelpers[s])this.opcode("invokeKnownHelper",n.length,s);else{if(this.options.knownHelpersOnly)throw new o("You specified knownHelpersOnly, but used the unknown helper "+s,e);this.opcode("invokeHelper",n.length,s,e.isRoot)}},sexpr:function(e){var t=this.classifySexpr(e);"simple"===t?this.simpleSexpr(e):"helper"===t?this.helperSexpr(e):this.ambiguousSexpr(e)},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var i=1,n=e.parts.length;n>i;i++)this.opcode("lookup",e.parts[i])},DATA:function(e){if(this.options.data=!0,e.id.isScoped||e.id.depth)throw new o("Scoped data references are not supported: "+e.original,e);this.opcode("lookupData");for(var t=e.id.parts,i=0,n=t.length;n>i;i++)this.opcode("lookup",t[i])},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){0!==e&&(this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e)))},classifySexpr:function(e){var t=e.isHelper,i=e.eligibleHelper,n=this.options;if(i&&!t){var s=e.id.parts[0];n.knownHelpers[s]?t=!0:n.knownHelpersOnly&&(i=!1)}return t?"helper":i?"ambiguous":"simple"},pushParams:function(e){for(var t,i=e.length;i--;)t=e[i],this.options.stringParams?(t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",t.stringModeValue,t.type),"sexpr"===t.type&&this.sexpr(t)):this[t.type](t)},setupFullMustacheParams:function(e,t,i){var n=e.params;return this.pushParams(n),this.opcode("pushProgram",t),this.opcode("pushProgram",i),e.hash?this.hash(e.hash):this.opcode("emptyHash"),n}},s.precompile=i,s.compile=n,s}(i),d=function(e,t){"use strict";function i(e){this.value=e}function n(){}var s,o=e.COMPILER_REVISION,r=e.REVISION_CHANGES,a=e.log,l=t;n.prototype={nameLookup:function(e,t){var i,s;return 0===e.indexOf("depth")&&(i=!0),s=/^[0-9]+$/.test(t)?e+"["+t+"]":n.isValidJavaScriptVariableName(t)?e+"."+t:e+"['"+t+"']",i?"("+e+" && "+s+")":s},compilerInfo:function(){var e=o,t=r[e];return"this.compilerInfo = ["+e+",'"+t+"'];\n"},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":{appendToBuffer:!0,content:e,toString:function(){return"buffer += "+e+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(e,t,i,n){this.environment=e,this.options=t||{},a("debug",this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!i,this.context=i||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.compileChildren(e,t);var s,o=e.opcodes;this.i=0;for(var r=o.length;this.i<r;this.i++)s=o[this.i],"DECLARE"===s.opcode?this[s.name]=s.value:this[s.opcode].apply(this,s.args),s.opcode!==this.stripNext&&(this.stripNext=!1);if(this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new l("Compile completed with content left on stack");return this.createFunctionContext(n)},preamble:function(){var e=[];if(this.isChild)e.push("");else{var t=this.namespace,i="helpers = this.merge(helpers, "+t+".helpers);";this.environment.usePartial&&(i=i+" partials = this.merge(partials, "+t+".partials);"),this.options.data&&(i+=" data = data || {};"),e.push(i)
}e.push(this.environment.isSimple?"":", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(e){var t=this.stackVars.concat(this.registers.list);if(t.length>0&&(this.source[1]=this.source[1]+", "+t.join(", ")),!this.isChild)for(var i in this.context.aliases)this.context.aliases.hasOwnProperty(i)&&(this.source[1]=this.source[1]+", "+i+"="+this.context.aliases[i]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.pushSource("return buffer;");for(var n=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],s=0,o=this.environment.depths.list.length;o>s;s++)n.push("depth"+this.environment.depths.list[s]);var r=this.mergeSource();if(this.isChild||(r=this.compilerInfo()+r),e)return n.push(r),Function.apply(this,n);var l="function "+(this.name||"")+"("+n.join(",")+") {\n  "+r+"}";return a("debug",l+"\n\n"),l},mergeSource:function(){for(var e,t="",i=0,n=this.source.length;n>i;i++){var s=this.source[i];s.appendToBuffer?e=e?e+"\n    + "+s.content:s.content:(e&&(t+="buffer += "+e+";\n  ",e=void 0),t+=s+"\n  ")}return t},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),"blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();e.splice(1,0,t),this.pushSource("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.pendingContent&&(e=this.pendingContent+e),this.stripNext&&(e=e.replace(/^\s+/,"")),this.pendingContent=e},strip:function(){this.pendingContent&&(this.pendingContent=this.pendingContent.replace(/\s+$/,"")),this.stripNext="strip"},append:function(){this.flushInline();var e=this.popStack();this.pushSource("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.push(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+".apply(depth0) : "+e})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(){this.pushStackLiteral("data")},pushStringParam:function(e,t){this.pushStackLiteral("depth"+this.lastContext),this.pushString(t),"sexpr"!==t&&("string"==typeof e?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.push("{}"),this.push("{}"))},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.options.stringParams&&(this.push("{"+e.contexts.join(",")+"}"),this.push("{"+e.types.join(",")+"}")),this.push("{\n    "+e.values.join(",\n    ")+"\n  }")},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){return this.inlineStack.push(e),e},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){this.pushStackLiteral(null!=e?this.programExpression(e):null)},invokeHelper:function(e,t,i){this.context.aliases.helperMissing="helpers.helperMissing",this.useRegister("helper");var n=this.lastHelper=this.setupHelper(e,t,!0),s=this.nameLookup("depth"+this.lastContext,t,"context"),o="helper = "+n.name+" || "+s;n.paramsInit&&(o+=","+n.paramsInit),this.push("("+o+",helper ? helper.call("+n.callParams+") : helperMissing.call("+n.helperMissingParams+"))"),i||this.flushInline()},invokeKnownHelper:function(e,t){var i=this.setupHelper(e,t);this.push(i.name+".call("+i.callParams+")")},invokeAmbiguous:function(e,t){this.context.aliases.functionType='"function"',this.useRegister("helper"),this.emptyHash();var i=this.setupHelper(0,e,t),n=this.lastHelper=this.nameLookup("helpers",e,"helper"),s=this.nameLookup("depth"+this.lastContext,e,"context"),o=this.nextStack();i.paramsInit&&this.pushSource(i.paramsInit),this.pushSource("if (helper = "+n+") { "+o+" = helper.call("+i.callParams+"); }"),this.pushSource("else { helper = "+s+"; "+o+" = typeof helper === functionType ? helper.call("+i.callParams+") : helper; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+t.join(", ")+")")},assignToHash:function(e){var t,i,n=this.popStack();this.options.stringParams&&(i=this.popStack(),t=this.popStack());var s=this.hash;t&&s.contexts.push("'"+e+"': "+t),i&&s.types.push("'"+e+"': "+i),s.values.push("'"+e+"': ("+n+")")},compiler:n,compileChildren:function(e,t){for(var i,n,s=e.children,o=0,r=s.length;r>o;o++){i=s[o],n=new this.compiler;var a=this.matchExistingProgram(i);null==a?(this.context.programs.push(""),a=this.context.programs.length,i.index=a,i.name="program"+a,this.context.programs[a]=n.compile(i,t,this.context),this.context.environments[a]=i):(i.index=a,i.name="program"+a)}},matchExistingProgram:function(e){for(var t=0,i=this.context.environments.length;i>t;t++){var n=this.context.environments[t];if(n&&n.equals(e))return t}},programExpression:function(e){if(this.context.aliases.self="this",null==e)return"self.noop";for(var t,i=this.environment.children[e],n=i.depths.list,s=[i.index,i.name,"data"],o=0,r=n.length;r>o;o++)t=n[o],s.push(1===t?"depth0":"depth"+(t-1));return(0===n.length?"self.program(":"self.programWithDepth(")+s.join(", ")+")"},register:function(e,t){this.useRegister(e),this.pushSource(e+" = "+t+";")},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.push(new i(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=void 0),e&&this.source.push(e)},pushStack:function(e){this.flushInline();var t=this.incrStack();return e&&this.pushSource(t+" = "+e+";"),this.compileStack.push(t),t},replaceStack:function(e){var t,n,s,o="",r=this.isInline();if(r){var a=this.popStack(!0);if(a instanceof i)t=a.value,s=!0;else{n=!this.stackSlot;var l=n?this.incrStack():this.topStackName();o="("+this.push(l)+" = "+a+"),",t=this.topStack()}}else t=this.topStack();var c=e.call(this,t);return r?(s||this.popStack(),n&&this.stackSlot--,this.push("("+o+c+")")):(/^stack/.test(t)||(t=this.nextStack()),this.pushSource(t+" = ("+o+c+");")),t},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;if(e.length){this.inlineStack=[];for(var t=0,n=e.length;n>t;t++){var s=e[t];s instanceof i?this.compileStack.push(s):this.pushStack(s)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),n=(t?this.inlineStack:this.compileStack).pop();if(!e&&n instanceof i)return n.value;if(!t){if(!this.stackSlot)throw new l("Invalid stack pop");this.stackSlot--}return n},topStack:function(e){var t=this.isInline()?this.inlineStack:this.compileStack,n=t[t.length-1];return!e&&n instanceof i?n.value:n},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(e,t,i){var n=[],s=this.setupParams(e,n,i),o=this.nameLookup("helpers",t,"helper");return{params:n,paramsInit:s,name:o,callParams:["depth0"].concat(n).join(", "),helperMissingParams:i&&["depth0",this.quotedString(t)].concat(n).join(", ")}},setupOptions:function(e,t){var i,n,s,o=[],r=[],a=[];o.push("hash:"+this.popStack()),this.options.stringParams&&(o.push("hashTypes:"+this.popStack()),o.push("hashContexts:"+this.popStack())),n=this.popStack(),s=this.popStack(),(s||n)&&(s||(this.context.aliases.self="this",s="self.noop"),n||(this.context.aliases.self="this",n="self.noop"),o.push("inverse:"+n),o.push("fn:"+s));for(var l=0;e>l;l++)i=this.popStack(),t.push(i),this.options.stringParams&&(a.push(this.popStack()),r.push(this.popStack()));return this.options.stringParams&&(o.push("contexts:["+r.join(",")+"]"),o.push("types:["+a.join(",")+"]")),this.options.data&&o.push("data:data"),o},setupParams:function(e,t,i){var n="{"+this.setupOptions(e,t).join(",")+"}";return i?(this.useRegister("options"),t.push("options"),"options="+n):(t.push(n),"")}};for(var c="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),d=n.RESERVED_WORDS={},u=0,h=c.length;h>u;u++)d[c[u]]=!0;return n.isValidJavaScriptVariableName=function(e){return!n.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)?!0:!1},s=n}(n,i),u=function(e,t,i,n,s){"use strict";var o,r=e,a=t,l=i.parser,c=i.parse,d=n.Compiler,u=n.compile,h=n.precompile,p=s,f=r.create,m=function(){var e=f();return e.compile=function(t,i){return u(t,i,e)},e.precompile=function(t,i){return h(t,i,e)},e.AST=a,e.Compiler=d,e.JavaScriptCompiler=p,e.Parser=l,e.parse=c,e};return r=m(),r.create=m,o=r}(o,r,l,c,d);return u}();!function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var i,n=e(document);e.rails=i={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var i=e('meta[name="csrf-token"]').attr("content");i&&t.setRequestHeader("X-CSRF-Token",i)},refreshCSRFTokens:function(){var t=e("meta[name=csrf-token]").attr("content"),i=e("meta[name=csrf-param]").attr("content");e('form input[name="'+i+'"]').val(t)},fire:function(t,i,n){var s=e.Event(i);return t.trigger(s,n),s.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(n){var s,o,r,a,l,c,d,u;if(i.fire(n,"ajax:before")){if(a=n.data("cross-domain"),l=a===t?null:a,c=n.data("with-credentials")||null,d=n.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,n.is("form")){s=n.attr("method"),o=n.attr("action"),r=n.serializeArray();var h=n.data("ujs:submit-button");h&&(r.push(h),n.data("ujs:submit-button",null))}else n.is(i.inputChangeSelector)?(s=n.data("method"),o=n.data("url"),r=n.serialize(),n.data("params")&&(r=r+"&"+n.data("params"))):n.is(i.buttonClickSelector)?(s=n.data("method")||"get",o=n.data("url"),r=n.serialize(),n.data("params")&&(r=r+"&"+n.data("params"))):(s=n.data("method"),o=i.href(n),r=n.data("params")||null);u={type:s||"GET",data:r,dataType:d,beforeSend:function(e,s){return s.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+s.accepts.script),i.fire(n,"ajax:beforeSend",[e,s])},success:function(e,t,i){n.trigger("ajax:success",[e,t,i])},complete:function(e,t){n.trigger("ajax:complete",[e,t])},error:function(e,t,i){n.trigger("ajax:error",[e,t,i])},crossDomain:l},c&&(u.xhrFields={withCredentials:c}),o&&(u.url=o);var p=i.ajax(u);return n.trigger("ajax:send",p),p}return!1},handleMethod:function(n){var s=i.href(n),o=n.data("method"),r=n.attr("target"),a=e("meta[name=csrf-token]").attr("content"),l=e("meta[name=csrf-param]").attr("content"),c=e('<form method="post" action="'+s+'"></form>'),d='<input name="_method" value="'+o+'" type="hidden" />';l!==t&&a!==t&&(d+='<input name="'+l+'" value="'+a+'" type="hidden" />'),r&&c.attr("target",r),c.hide().append(d).appendTo("body"),c.submit()},disableFormElements:function(t){t.find(i.disableSelector).each(function(){var t=e(this),i=t.is("button")?"html":"val";t.data("ujs:enable-with",t[i]()),t[i](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(i.enableSelector).each(function(){var t=e(this),i=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[i](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t,n=e.data("confirm"),s=!1;return n?(i.fire(e,"confirm")&&(s=i.confirm(n),t=i.fire(e,"confirm:complete",[s])),s&&t):!0},blankInputs:function(t,i,n){var s,o,r=e(),a=i||"input,textarea",l=t.find(a);return l.each(function(){if(s=e(this),o=s.is("input[type=checkbox],input[type=radio]")?s.is(":checked"):s.val(),!o==!n){if(s.is("input[type=radio]")&&l.filter('input[type=radio]:checked[name="'+s.attr("name")+'"]').length)return!0;r=r.add(s)}}),r.length?r:!1},nonBlankInputs:function(e,t){return i.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return i.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},i.fire(n,"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,n){e.crossDomain||i.CSRFProtection(n)}),n.delegate(i.linkDisableSelector,"ajax:complete",function(){i.enableElement(e(this))}),n.delegate(i.linkClickSelector,"click.rails",function(n){var s=e(this),o=s.data("method"),r=s.data("params"),a=n.metaKey||n.ctrlKey;if(!i.allowAction(s))return i.stopEverything(n);if(!a&&s.is(i.linkDisableSelector)&&i.disableElement(s),s.data("remote")!==t){if(a&&(!o||"GET"===o)&&!r)return!0;var l=i.handleRemote(s);return l===!1?i.enableElement(s):l.error(function(){i.enableElement(s)}),!1}return s.data("method")?(i.handleMethod(s),!1):void 0}),n.delegate(i.buttonClickSelector,"click.rails",function(t){var n=e(this);return i.allowAction(n)?(i.handleRemote(n),!1):i.stopEverything(t)}),n.delegate(i.inputChangeSelector,"change.rails",function(t){var n=e(this);return i.allowAction(n)?(i.handleRemote(n),!1):i.stopEverything(t)}),n.delegate(i.formSubmitSelector,"submit.rails",function(n){var s=e(this),o=s.data("remote")!==t,r=i.blankInputs(s,i.requiredInputSelector),a=i.nonBlankInputs(s,i.fileInputSelector);if(!i.allowAction(s))return i.stopEverything(n);if(r&&s.attr("novalidate")==t&&i.fire(s,"ajax:aborted:required",[r]))return i.stopEverything(n);if(o){if(a){setTimeout(function(){i.disableFormElements(s)},13);var l=i.fire(s,"ajax:aborted:file",[a]);return l||setTimeout(function(){i.enableFormElements(s)},13),l}return i.handleRemote(s),!1}setTimeout(function(){i.disableFormElements(s)},13)}),n.delegate(i.formInputClickSelector,"click.rails",function(t){var n=e(this);if(!i.allowAction(n))return i.stopEverything(t);var s=n.attr("name"),o=s?{name:s,value:n.val()}:null;n.closest("form").data("ujs:submit-button",o)}),n.delegate(i.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&i.disableFormElements(e(this))}),n.delegate(i.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&i.enableFormElements(e(this))}),e(function(){i.refreshCSRFTokens()}))}(jQuery),function(e){var t=function(){function t(e){return" "===e||"	"===e||"\r"===e||"\n"===e||""===e}function i(e,t,i){var n=l.createElement("div");n.setAttribute("class","smile sprite-"+i),n.setAttribute("data-smile",":"+i+":"),n.setAttribute("id",":"+i+":"),e.splitText(t.index),e.nextSibling.nodeValue=e.nextSibling.nodeValue.substr(t[0].length,e.nextSibling.nodeValue.length),n.appendChild(e.splitText(t.index)),e.parentNode.insertBefore(n,e.nextSibling)}function n(e){if(e[1]&&e[2]){var t=e[2];if(u[t])return t}else for(var i=3;i<e.length-1;i++)if(e[i])return p[i-2][1]}function s(e,t){return"<div class='smile sprite-'"+emojiName+"style ='background-images:url('"+g.img_dir+"/"+emojiName+".png)>:"+t+":</span>"}function o(){this.lastEmojiTerminatedAt=-1}function r(e,t){if(!e)return e;t||(t=s);var i=new o;return e.replace(m,function(){var e=Array.prototype.slice.call(arguments,0,-2),n=arguments[arguments.length-2],s=arguments[arguments.length-1],o=i.validate(e,n,s);return o?t(arguments[0],o):arguments[0]})}function a(e){"undefined"==typeof e&&(e=g.only_crawl_id?l.getElementById(g.only_crawl_id):l.body);for(var t,s=g.ignored_tags,r=l.createTreeWalker(e,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,function(e){return 1!==e.nodeType?NodeFilter.FILTER_ACCEPT:s[e.tagName]||e.classList.contains("no-emojify")?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_SKIP},!1),a=[];null!==(t=r.nextNode());)a.push(t);a.forEach(function(e){for(var t,s=[],r=new o;null!==(t=m.exec(e.data));)r.validate(t,t.index,t.input)&&s.push(t);for(var a=s.length;a-->0;){var l=n(s[a]);i(e,s[a],l)}})}var l=e.window.document,c="1,be,100,109,1234,8ball,a,ab,abc,abcd,accept,aerial_tramway,airplane,alarm_clock,alien,ambulance,anchor,angel,anger,angry,anguished,ant,apple,aquarius,aries,arrow_backward,arrow_double_down,arrow_double_up,arrow_down,arrow_down_small,arrow_forward,arrow_heading_down,arrow_heading_up,arrow_left,arrow_lower_left,arrow_lower_right,arrow_right,arrow_right_hook,arrow_up,arrow_up_down,arrow_up_small,arrow_upper_left,arrow_upper_right,arrows_clockwise,arrows_counterclockwise,art,articulated_lorry,astonished,atm,b,baby,baby_bottle,baby_chick,baby_symbol,baggage_claim,balloon,ballot_box_with_check,bamboo,banana,bangbang,bank,bar_chart,barber,baseball,basketball,bath,bathtub,battery,bear,bee,beer,beers,beetle,beginner,bell,bento,bicyclist,bike,bikini,bird,birthday,black_circle,black_joker,black_nib,black_square,black_square_button,blossom,blowfish,blue_book,blue_car,blue_heart,blush,boar,boat,bomb,book,bookmark,bookmark_tabs,books,boom,boot,bouquet,bow,bowling,bowtie,boy,bread,bride_with_veil,bridge_at_night,briefcase,broken_heart,bug,bulb,bullettrain_front,bullettrain_side,bus,busstop,bust_in_silhouette,busts_in_silhouette,cactus,cake,calendar,calling,camel,camera,cancer,candy,capital_abcd,capricorn,car,card_index,carousel_horse,cat,cat2,cd,chart,chart_with_downwards_trend,chart_with_upwards_trend,checkered_flag,cherries,cherry_blossom,chestnut,chicken,children_crossing,chocolate_bar,christmas_tree,church,cinema,circus_tent,city_sunrise,city_sunset,cl,clap,clapper,clipboard,clock1,clock10,clock1030,clock11,clock1130,clock12,clock1230,clock130,clock2,clock230,clock3,clock330,clock4,clock430,clock5,clock530,clock6,clock630,clock7,clock730,clock8,clock830,clock9,clock930,closed_book,closed_lock_with_key,closed_umbrella,cloud,clubs,cn,cocktail,coffee,cold_sweat,collision,computer,confetti_ball,confounded,confused,congratulations,construction,construction_worker,convenience_store,cookie,cool,cop,copyright,corn,couple,couple_with_heart,couplekiss,cow,cow2,credit_card,crocodile,crossed_flags,crown,cry,crying_cat_face,crystal_ball,cupid,curly_loop,currency_exchange,curry,custard,customs,cyclone,dancer,dancers,dango,dart,dash,date,de,deciduous_tree,department_store,diamond_shape_with_a_dot_inside,diamonds,disappointed,disappointed_relieved,dizzy,dizzy_face,do_not_litter,dog,dog2,dollar,dolls,dolphin,donut,door,doughnut,dragon,dragon_face,dress,dromedary_camel,droplet,dvd,e-mail,ear,ear_of_rice,earth_africa,earth_americas,earth_asia,egg,eggplant,eight,eight_pointed_black_star,eight_spoked_asterisk,electric_plug,elephant,email,end,envelope,es,euro,european_castle,european_post_office,evergreen_tree,exclamation,expressionless,eyeglasses,eyes,facepunch,factory,fallen_leaf,family,fast_forward,fax,fearful,feelsgood,feet,ferris_wheel,file_folder,finnadie,fire,fire_engine,fireworks,first_quarter_moon,first_quarter_moon_with_face,fish,fish_cake,fishing_pole_and_fish,fist,five,flags,flashlight,floppy_disk,flower_playing_cards,flushed,foggy,football,fork_and_knife,fountain,four,four_leaf_clover,fr,free,fried_shrimp,fries,frog,frowning,fu,fuelpump,full_moon,full_moon_with_face,game_die,gb,gem,gemini,ghost,gift,gift_heart,girl,globe_with_meridians,goat,goberserk,godmode,golf,grapes,green_apple,green_book,green_heart,grey_exclamation,grey_question,grimacing,grin,grinning,guardsman,guitar,gun,haircut,hamburger,hammer,hamster,hand,handbag,hankey,hash,hatched_chick,hatching_chick,headphones,hear_no_evil,heart,heart_decoration,heart_eyes,heart_eyes_cat,heartbeat,heartpulse,hearts,heavy_check_mark,heavy_division_sign,heavy_dollar_sign,heavy_exclamation_mark,heavy_minus_sign,heavy_multiplication_x,heavy_plus_sign,helicopter,herb,hibiscus,high_brightness,high_heel,hocho,honey_pot,honeybee,horse,horse_racing,hospital,hotel,hotsprings,hourglass,hourglass_flowing_sand,house,house_with_garden,hurtrealbad,hushed,ice_cream,icecream,id,ideograph_advantage,imp,inbox_tray,incoming_envelope,information_desk_person,information_source,innocent,interrobang,iphone,it,izakaya_lantern,jack_o_lantern,japan,japanese_castle,japanese_goblin,japanese_ogre,jeans,joy,joy_cat,jp,key,keycap_ten,kimono,kiss,kissing,kissing_cat,kissing_closed_eyes,kissing_face,kissing_heart,kissing_smiling_eyes,koala,koko,kr,large_blue_circle,large_blue_diamond,large_orange_diamond,last_quarter_moon,last_quarter_moon_with_face,laughing,leaves,ledger,left_luggage,left_right_arrow,leftwards_arrow_with_hook,lemon,leo,leopard,libra,light_rail,link,lips,lipstick,lock,lock_with_ink_pen,lollipop,loop,loudspeaker,love_hotel,love_letter,low_brightness,m,mag,mag_right,mahjong,mailbox,mailbox_closed,mailbox_with_mail,mailbox_with_no_mail,man,man_with_gua_pi_mao,man_with_turban,mans_shoe,maple_leaf,mask,massage,meat_on_bone,mega,melon,memo,mens,metal,metro,microphone,microscope,milky_way,minibus,minidisc,mobile_phone_off,money_with_wings,moneybag,monkey,monkey_face,monorail,moon,mortar_board,mount_fuji,mountain_bicyclist,mountain_cableway,mountain_railway,mouse,mouse2,movie_camera,moyai,muscle,mushroom,musical_keyboard,musical_note,musical_score,mute,nail_care,name_badge,neckbeard,necktie,negative_squared_cross_mark,neutral_face,new,new_moon,new_moon_with_face,newspaper,ng,nine,no_bell,no_bicycles,no_entry,no_entry_sign,no_good,no_mobile_phones,no_mouth,no_pedestrians,no_smoking,non-potable_water,nose,notebook,notebook_with_decorative_cover,notes,nut_and_bolt,o,o2,ocean,octocat,octopus,oden,office,ok,ok_hand,ok_woman,older_man,older_woman,on,oncoming_automobile,oncoming_bus,oncoming_police_car,oncoming_taxi,one,open_file_folder,open_hands,open_mouth,ophiuchus,orange_book,outbox_tray,ox,page_facing_up,page_with_curl,pager,palm_tree,panda_face,paperclip,parking,part_alternation_mark,partly_sunny,passport_control,paw_prints,peach,pear,pencil,pencil2,penguin,pensive,performing_arts,persevere,person_frowning,person_with_blond_hair,person_with_pouting_face,phone,pig,pig2,pig_nose,pill,pineapple,pisces,pizza,plus1,point_down,point_left,point_right,point_up,point_up_2,police_car,poodle,poop,post_office,postal_horn,postbox,potable_water,pouch,poultry_leg,pound,pouting_cat,pray,princess,punch,purple_heart,purse,pushpin,put_litter_in_its_place,question,rabbit,rabbit2,racehorse,radio,radio_button,rage,rage1,rage2,rage3,rage4,railway_car,rainbow,raised_hand,raised_hands,raising_hand,ram,ramen,rat,recycle,red_car,red_circle,registered,relaxed,relieved,repeat,repeat_one,restroom,revolving_hearts,rewind,ribbon,rice,rice_ball,rice_cracker,rice_scene,ring,rocket,roller_coaster,rooster,rose,rotating_light,round_pushpin,rowboat,ru,rugby_football,runner,running,running_shirt_with_sash,sa,sagittarius,sailboat,sake,sandal,santa,satellite,satisfied,saxophone,school,school_satchel,scissors,scorpius,scream,scream_cat,scroll,seat,secret,see_no_evil,seedling,seven,shaved_ice,sheep,shell,ship,shipit,shirt,shit,shoe,shower,signal_strength,six,six_pointed_star,ski,skull,sleeping,sleepy,slot_machine,small_blue_diamond,small_orange_diamond,small_red_triangle,small_red_triangle_down,smile,smile_cat,smiley,smiley_cat,smiling_imp,smirk,smirk_cat,smoking,snail,snake,snowboarder,snowflake,snowman,sob,soccer,soon,sos,sound,space_invader,spades,spaghetti,sparkler,sparkles,sparkling_heart,speak_no_evil,speaker,speech_balloon,speedboat,squirrel,star,star2,stars,station,statue_of_liberty,steam_locomotive,stew,straight_ruler,strawberry,stuck_out_tongue,stuck_out_tongue_closed_eyes,stuck_out_tongue_winking_eye,sun_with_face,sunflower,sunglasses,sunny,sunrise,sunrise_over_mountains,surfer,sushi,suspect,suspension_railway,sweat,sweat_drops,sweat_smile,sweet_potato,swimmer,symbols,syringe,tada,tanabata_tree,tangerine,taurus,taxi,tea,telephone,telephone_receiver,telescope,tennis,tent,thought_balloon,three,thumbsdown,thumbsup,ticket,tiger,tiger2,tired_face,tm,toilet,tokyo_tower,tomato,tongue,top,tophat,tractor,traffic_light,train,train2,tram,triangular_flag_on_post,triangular_ruler,trident,triumph,trolleybus,trollface,trophy,tropical_drink,tropical_fish,truck,trumpet,tshirt,tulip,turtle,tv,twisted_rightwards_arrows,two,two_hearts,two_men_holding_hands,two_women_holding_hands,u5272,u5408,u55b6,u6307,u6708,u6709,u6e80,u7121,u7533,u7981,u7a7a,uk,umbrella,unamused,underage,unlock,up,us,v,vertical_traffic_light,vhs,vibration_mode,video_camera,video_game,violin,virgo,volcano,vs,walking,waning_crescent_moon,waning_gibbous_moon,warning,watch,water_buffalo,watermelon,wave,wavy_dash,waxing_crescent_moon,waxing_gibbous_moon,wc,weary,wedding,whale,whale2,wheelchair,white_check_mark,white_circle,white_flower,white_square,white_square_button,wind_chime,wine_glass,wink,wink2,wolf,woman,womans_clothes,womans_hat,womens,worried,wrench,x,yellow_heart,yen,yum,zap,zero,zzz",d=c.split(/,/),u=d.reduce(function(e,t){return e[t]=!0,e},{}),h={named:/:([a-z0-9A-Z_-]+):/,blush:/:-?\)/g,scream:/:-o/gi,smirk:/[:;]-?]/g,smiley:/[:;]-?d/gi,stuck_out_tongue_closed_eyes:/x-d/gi,stuck_out_tongue_winking_eye:/[:;]-?p/gi,rage:/:-?[\[@]/g,disappointed:/:-?\(/g,sob:/:['\u2019]-?\(|:&#x27;\(/g,kissing_heart:/:-?\*/g,wink:/;-?\)/g,pensive:/:-?\//g,confounded:/:-?s/gi,flushed:/:-?\|/g,relaxed:/:-?\$/g,mask:/:-x/gi,heart:/<3|&lt;3/g,broken_heart:/<\/3|&lt;&#x2F;3/g,thumbsup:/:1:/g,thumbsdown:/:be:/g},p=Object.keys(h).map(function(e){return[h[e],e]}),f=p.map(function(e){var t=e[0],i=t.source||t;return i=i.replace(/(^|[^\[])\^/g,"$1"),"("+i+")"}).join("|"),m=new RegExp(f,"gi"),g={emojify_tag_type:"div",only_crawl_id:null,img_dir:"/assets",ignored_tags:{SCRIPT:1,TEXTAREA:1,A:1,PRE:1,CODE:1}};return o.prototype={validate:function(e,i,s){function o(){return r.lastEmojiTerminatedAt=c+i,a}var r=this,a=n(e);if(a){var l=e[0],c=l.length;return l.length>2?o():0===i?o():s.length===l.length+i?o():t(s.charAt(i-1))?o():t(s.charAt(l.length+i))?o():this.lastEmojiTerminatedAt===i?o():void 0}}},{defaultConfig:g,emojiNames:d,setConfig:function(e){Object.keys(g).forEach(function(t){t in e&&(g[t]=e[t])})},replace:r,run:a}}();return e.emojify=t,"function"==typeof define&&define.amd&&define([],function(){return t}),t}(this),function(e,t,i){!function(){for(var e=new RegExp("audio(.min)?.js.*"),t=document.getElementsByTagName("script"),i=0,n=t.length;n>i;i++){var s=t[i].getAttribute("src");if(e.test(s))return s.replace(e,"")}}();i[e]={instanceCount:0,instances:{},flashSource:'      <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="$1" width="1" height="1" name="$1" style="position: absolute; left: -1px;">         <param name="movie" value="$2?playerInstance='+e+'.instances[\'$1\']&datetime=$3">         <param name="allowscriptaccess" value="always">         <embed name="$1" src="$2?playerInstance='+e+'.instances[\'$1\']&datetime=$3" width="1" height="1" allowscriptaccess="always">       </object>',settings:{autoplay:!1,loop:!1,preload:!0,imageLocation:"/assets/audiojs-player-graphics-32f3105bdf2ebf0f650ada924b8fced3.gif",swfLocation:"/assets/audiojs-3146e8da3fef83b1a7f267969ac3fa1f.swf",useFlash:function(){var e=document.createElement("audio");return!(e.canPlayType&&e.canPlayType("audio/mpeg;").replace(/no/,""))}(),hasFlash:function(){if(navigator.plugins&&navigator.plugins.length&&navigator.plugins["Shockwave Flash"])return!0;if(navigator.mimeTypes&&navigator.mimeTypes.length){var e=navigator.mimeTypes["application/x-shockwave-flash"];return e&&e.enabledPlugin}try{{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}return!0}catch(t){}return!1}(),createPlayer:{markup:'          <div class="play-pause">             <p class="play"></p>             <p class="pause"></p>             <p class="loading"></p>             <p class="error"></p>           </div>           <div class="scrubber">             <div class="progress"></div>             <div class="loaded"></div>           </div>           <div class="time">             <em class="played">00:00</em>/<strong class="duration">00:00</strong>           </div>           <div class="error-message"></div>',playPauseClass:"play-pause",scrubberClass:"scrubber",progressClass:"progress",loaderClass:"loaded",timeClass:"time",durationClass:"duration",playedClass:"played",errorMessageClass:"error-message",playingClass:"playing",loadingClass:"loading",errorClass:"error"},css:'        .audiojs audio { position: absolute; left: -1px; }         .audiojs { width: 460px; height: 36px; background: #404040; overflow: hidden; font-family: monospace; font-size: 12px;           background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #444), color-stop(0.5, #555), color-stop(0.51, #444), color-stop(1, #444));           background-image: -moz-linear-gradient(center top, #444 0%, #555 50%, #444 51%, #444 100%);           -webkit-box-shadow: 1px 1px 8px rgba(0, 0, 0, 0.3); -moz-box-shadow: 1px 1px 8px rgba(0, 0, 0, 0.3);           -o-box-shadow: 1px 1px 8px rgba(0, 0, 0, 0.3); box-shadow: 1px 1px 8px rgba(0, 0, 0, 0.3); }         .audiojs .play-pause { width: 25px; height: 40px; padding: 4px 6px; margin: 0px; float: left; overflow: hidden; border-right: 1px solid #000; }         .audiojs p { display: none; width: 25px; height: 40px; margin: 0px; cursor: pointer; }         .audiojs .play { display: block; }         .audiojs .scrubber { position: relative; float: left; width: 280px; background: #5a5a5a; height: 14px; margin: 10px; border-top: 1px solid #3f3f3f; border-left: 0px; border-bottom: 0px; overflow: hidden; }         .audiojs .progress { position: absolute; top: 0px; left: 0px; height: 14px; width: 0px; background: #ccc; z-index: 1;           background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #ccc), color-stop(0.5, #ddd), color-stop(0.51, #ccc), color-stop(1, #ccc));           background-image: -moz-linear-gradient(center top, #ccc 0%, #ddd 50%, #ccc 51%, #ccc 100%); }         .audiojs .loaded { position: absolute; top: 0px; left: 0px; height: 14px; width: 0px; background: #000;           background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #222), color-stop(0.5, #333), color-stop(0.51, #222), color-stop(1, #222));           background-image: -moz-linear-gradient(center top, #222 0%, #333 50%, #222 51%, #222 100%); }         .audiojs .time { float: left; height: 36px; line-height: 36px; margin: 0px 0px 0px 6px; padding: 0px 6px 0px 12px; border-left: 1px solid #000; color: #ddd; text-shadow: 1px 1px 0px rgba(0, 0, 0, 0.5); }         .audiojs .time em { padding: 0px 2px 0px 0px; color: #f9f9f9; font-style: normal; }         .audiojs .time strong { padding: 0px 0px 0px 2px; font-weight: normal; }         .audiojs .error-message { float: left; display: none; margin: 0px 10px; height: 36px; width: 400px; overflow: hidden; line-height: 36px; white-space: nowrap; color: #fff;           text-overflow: ellipsis; -o-text-overflow: ellipsis; -icab-text-overflow: ellipsis; -khtml-text-overflow: ellipsis; -moz-text-overflow: ellipsis; -webkit-text-overflow: ellipsis; }         .audiojs .error-message a { color: #eee; text-decoration: none; padding-bottom: 1px; border-bottom: 1px solid #999; white-space: wrap; }                 .audiojs .play { background: url("$1") -2px -1px no-repeat; }         .audiojs .loading { background: url("$1") -2px -31px no-repeat; }         .audiojs .error { background: url("$1") -2px -61px no-repeat; }         .audiojs .pause { background: url("$1") -2px -91px no-repeat; }                 .playing .play, .playing .loading, .playing .error { display: none; }         .playing .pause { display: block; }                 .loading .play, .loading .pause, .loading .error { display: none; }         .loading .loading { display: block; }                 .error .time, .error .play, .error .pause, .error .scrubber, .error .loading { display: none; }         .error .error { display: block; }         .error .play-pause p { cursor: auto; }         .error .error-message { display: block; }',trackEnded:function(){},flashError:function(){var t=this.settings.createPlayer,s=n(t.errorMessageClass,this.wrapper),o='Missing <a href="http://get.adobe.com/flashplayer/">flash player</a> plugin.';
this.mp3&&(o+=' <a href="'+this.mp3+'">Download audio file</a>.'),i[e].helpers.removeClass(this.wrapper,t.loadingClass),i[e].helpers.addClass(this.wrapper,t.errorClass),s.innerHTML=o},loadError:function(){var t=this.settings.createPlayer,s=n(t.errorMessageClass,this.wrapper);i[e].helpers.removeClass(this.wrapper,t.loadingClass),i[e].helpers.addClass(this.wrapper,t.errorClass),s.innerHTML='Error loading: "'+this.mp3+'"'},init:function(){var t=this.settings.createPlayer;i[e].helpers.addClass(this.wrapper,t.loadingClass)},loadStarted:function(){var t=this.settings.createPlayer,s=n(t.durationClass,this.wrapper),o=Math.floor(this.duration/60),r=Math.floor(this.duration%60);i[e].helpers.removeClass(this.wrapper,t.loadingClass),s.innerHTML=(10>o?"0":"")+o+":"+(10>r?"0":"")+r},loadProgress:function(e){var t=this.settings.createPlayer,i=n(t.scrubberClass,this.wrapper),s=n(t.loaderClass,this.wrapper);s.style.width=i.offsetWidth*e+"px"},playPause:function(){this.playing?this.settings.play():this.settings.pause()},play:function(){var t=this.settings.createPlayer;i[e].helpers.addClass(this.wrapper,t.playingClass)},pause:function(){var t=this.settings.createPlayer;i[e].helpers.removeClass(this.wrapper,t.playingClass)},updatePlayhead:function(e){var t=this.settings.createPlayer,i=n(t.scrubberClass,this.wrapper),s=n(t.progressClass,this.wrapper);s.style.width=i.offsetWidth*e+"px";var o=n(t.playedClass,this.wrapper),r=this.duration*e,a=Math.floor(r/60),l=Math.floor(r%60);o.innerHTML=(10>a?"0":"")+a+":"+(10>l?"0":"")+l}},create:function(e,t){var t=t||{};return e.length?this.createAll(t,e):this.newInstance(e,t)},createAll:function(e,t){var i=t||document.getElementsByTagName("audio"),n=[];e=e||{};for(var s=0,o=i.length;o>s;s++)n.push(this.newInstance(i[s],e));return n},newInstance:function(e,n){{var e=e,s=this.helpers.clone(this.settings),o="audiojs"+this.instanceCount,r="audiojs_wrapper"+this.instanceCount;this.instanceCount++}null!=e.getAttribute("autoplay")&&(s.autoplay=!0),null!=e.getAttribute("loop")&&(s.loop=!0),"none"==e.getAttribute("preload")&&(s.preload=!1),n&&this.helpers.merge(s,n),s.createPlayer.markup?e=this.createPlayer(e,s.createPlayer,r):e.parentNode.setAttribute("id",r);var a=new i[t](e,s);return s.css&&this.helpers.injectCss(a,s.css),s.useFlash&&s.hasFlash?(this.injectFlash(a,o),this.attachFlashEvents(a.wrapper,a)):s.useFlash&&!s.hasFlash&&this.settings.flashError.apply(a),(!s.useFlash||s.useFlash&&s.hasFlash)&&this.attachEvents(a.wrapper,a),this.instances[o]=a,a},createPlayer:function(e,t,i){var n=document.createElement("div"),s=e.cloneNode(!0);return n.setAttribute("class","audiojs"),n.setAttribute("className","audiojs"),n.setAttribute("id",i),s.outerHTML&&!document.createElement("audio").canPlayType?(s=this.helpers.cloneHtml5Node(e),n.innerHTML=t.markup,n.appendChild(s),e.outerHTML=n.outerHTML,n=document.getElementById(i)):(n.appendChild(s),n.innerHTML=n.innerHTML+t.markup,e.parentNode.replaceChild(n,e)),n.getElementsByTagName("audio")[0]},attachEvents:function(t,s){if(s.settings.createPlayer){var o=s.settings.createPlayer,r=n(o.playPauseClass,t),a=n(o.scrubberClass,t),l=function(e){var t=0;if(e.offsetParent)do t+=e.offsetLeft;while(e=e.offsetParent);return t};i[e].events.addListener(r,"click",function(){s.playPause.apply(s)}),i[e].events.addListener(a,"click",function(e){var t=e.clientX-l(this);s.skipTo(t/a.offsetWidth)}),s.settings.useFlash||(i[e].events.trackLoadProgress(s),i[e].events.addListener(s.element,"timeupdate",function(){s.updatePlayhead.apply(s)}),i[e].events.addListener(s.element,"ended",function(){s.trackEnded.apply(s)}),i[e].events.addListener(s.source,"error",function(){clearInterval(s.readyTimer),clearInterval(s.loadTimer),s.settings.loadError.apply(s)}))}},attachFlashEvents:function(e,t){t.swfReady=!1,t.load=function(e){t.mp3=e,t.swfReady&&t.element.load(e)},t.loadProgress=function(e,i){t.loadedPercent=e,t.duration=i,t.settings.loadStarted.apply(t),t.settings.loadProgress.apply(t,[e])},t.skipTo=function(e){e>t.loadedPercent||(t.updatePlayhead.call(t,[e]),t.element.skipTo(e))},t.updatePlayhead=function(e){t.settings.updatePlayhead.apply(t,[e])},t.play=function(){t.settings.preload||(t.settings.preload=!0,t.element.init(t.mp3)),t.playing=!0,t.element.pplay(),t.settings.play.apply(t)},t.pause=function(){t.playing=!1,t.element.ppause(),t.settings.pause.apply(t)},t.setVolume=function(e){t.element.setVolume(e)},t.loadStarted=function(){t.swfReady=!0,t.settings.preload&&t.element.init(t.mp3),t.settings.autoplay&&t.play.apply(t)}},injectFlash:function(e,t){var i=this.flashSource.replace(/\$1/g,t);i=i.replace(/\$2/g,e.settings.swfLocation),i=i.replace(/\$3/g,+new Date+Math.random());var n=e.wrapper.innerHTML,s=document.createElement("div");s.innerHTML=i+n,e.wrapper.innerHTML=s.innerHTML,e.element=this.helpers.getSwf(t)},helpers:{merge:function(e,t){for(attr in t)(e.hasOwnProperty(attr)||t.hasOwnProperty(attr))&&(e[attr]=t[attr])},clone:function(e){if(null==e||"object"!=typeof e)return e;var t=new e.constructor;for(var i in e)t[i]=arguments.callee(e[i]);return t},addClass:function(e,t){var i=new RegExp("(\\s|^)"+t+"(\\s|$)");i.test(e.className)||(e.className+=" "+t)},removeClass:function(e,t){var i=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(i," ")},injectCss:function(e,t){for(var i="",n=document.getElementsByTagName("style"),s=t.replace(/\$1/g,e.settings.imageLocation),o=0,r=n.length;r>o;o++){var a=n[o].getAttribute("title");if(a&&~a.indexOf("audiojs")){if(d=n[o],d.innerHTML===s)return;i=d.innerHTML;break}}var l=document.getElementsByTagName("head")[0],c=l.firstChild,d=document.createElement("style");l&&(d.setAttribute("type","text/css"),d.setAttribute("title","audiojs"),d.styleSheet?d.styleSheet.cssText=i+s:d.appendChild(document.createTextNode(i+s)),c?l.insertBefore(d,c):l.appendChild(styleElement))},cloneHtml5Node:function(e){var t=document.createDocumentFragment(),i=t.createElement?t:document;i.createElement("audio");var n=i.createElement("div");return t.appendChild(n),n.innerHTML=e.outerHTML,n.firstChild},getSwf:function(e){var t=document[e]||window[e];return t.length>1?t[t.length-1]:t}},events:{memoryLeaking:!1,listeners:[],addListener:function(t,n,s){t.addEventListener?t.addEventListener(n,s,!1):t.attachEvent&&(this.listeners.push(t),this.memoryLeaking||(window.attachEvent("onunload",function(){if(this.listeners)for(var t=0,n=this.listeners.length;n>t;t++)i[e].events.purge(this.listeners[t])}),this.memoryLeaking=!0),t.attachEvent("on"+n,function(){s.call(t,window.event)}))},trackLoadProgress:function(e){if(e.settings.preload){var t,i,e=e,n=/(ipod|iphone|ipad)/i.test(navigator.userAgent);t=setInterval(function(){e.element.readyState>-1&&(n||e.init.apply(e)),e.element.readyState>1&&(e.settings.autoplay&&e.play.apply(e),clearInterval(t),i=setInterval(function(){e.loadProgress.apply(e),e.loadedPercent>=1&&clearInterval(i)}))},10),e.readyTimer=t,e.loadTimer=i}},purge:function(e){var t,i=e.attributes;if(i)for(t=0;t<i.length;t+=1)"function"==typeof e[i[t].name]&&(e[i[t].name]=null);if(i=e.childNodes)for(t=0;t<i.length;t+=1)purge(e.childNodes[t])},ready:function(){return function(e){var t=window,i=!1,n=!0,s=t.document,o=s.documentElement,r=s.addEventListener?"addEventListener":"attachEvent",a=s.addEventListener?"removeEventListener":"detachEvent",l=s.addEventListener?"":"on",c=function(n){("readystatechange"!=n.type||"complete"==s.readyState)&&(("load"==n.type?t:s)[a](l+n.type,c,!1),!i&&(i=!0)&&e.call(t,n.type||n))},d=function(){try{o.doScroll("left")}catch(e){return void setTimeout(d,50)}c("poll")};if("complete"==s.readyState)e.call(t,"lazy");else{if(s.createEventObject&&o.doScroll){try{n=!t.frameElement}catch(u){}n&&d()}s[r](l+"DOMContentLoaded",c,!1),s[r](l+"readystatechange",c,!1),t[r](l+"load",c,!1)}}}()}},i[t]=function(e,t){this.element=e,this.wrapper=e.parentNode,this.source=e.getElementsByTagName("source")[0]||e,this.mp3=function(e){var t=e.getElementsByTagName("source")[0];return e.getAttribute("src")||(t?t.getAttribute("src"):null)}(e),this.settings=t,this.loadStartedCalled=!1,this.loadedPercent=0,this.duration=1,this.playing=!1},i[t].prototype={updatePlayhead:function(){var e=this.element.currentTime/this.duration;this.settings.updatePlayhead.apply(this,[e])},skipTo:function(e){e>this.loadedPercent||(this.element.currentTime=this.duration*e,this.updatePlayhead())},load:function(t){this.loadStartedCalled=!1,this.source.setAttribute("src",t),this.element.load(),this.mp3=t,i[e].events.trackLoadProgress(this)},loadError:function(){this.settings.loadError.apply(this)},init:function(){this.settings.init.apply(this)},loadStarted:function(){return this.element.duration?(this.duration=this.element.duration,this.updatePlayhead(),void this.settings.loadStarted.apply(this)):!1},loadProgress:function(){if(null!=this.element.buffered&&this.element.buffered.length){this.loadStartedCalled||(this.loadStartedCalled=this.loadStarted());var e=this.element.buffered.end(this.element.buffered.length-1);this.loadedPercent=e/this.duration,this.settings.loadProgress.apply(this,[this.loadedPercent])}},playPause:function(){this.playing?this.pause():this.play()},play:function(){var t=/(ipod|iphone|ipad)/i.test(navigator.userAgent);t&&0==this.element.readyState&&this.init.apply(this),this.settings.preload||(this.settings.preload=!0,this.element.setAttribute("preload","auto"),i[e].events.trackLoadProgress(this)),this.playing=!0,this.element.play(),this.settings.play.apply(this)},pause:function(){this.playing=!1,this.element.pause(),this.settings.pause.apply(this)},setVolume:function(e){this.element.volume=e},trackEnded:function(){this.skipTo.apply(this,[0]),this.settings.loop||this.pause.apply(this),this.settings.trackEnded.apply(this)}};var n=function(e,t){var i=[];if(t=t||document,t.getElementsByClassName)i=t.getElementsByClassName(e);else{var n,s,o=t.getElementsByTagName("*"),r=new RegExp("(^|\\s)"+e+"(\\s|$)");for(n=0,s=o.length;s>n;n++)r.test(o[n].className)&&i.push(o[n])}return i.length>1?i:i[0]}}("audiojs","audiojsInstance",this),function(){var e;e=jQuery,e.bootstrapGrowl=function(t,i){var n,s,o;switch(i=e.extend({},e.bootstrapGrowl.default_options,i),n=e("<div>"),n.attr("class","bootstrap-growl alert"),i.type&&n.addClass("alert-"+i.type),i.allow_dismiss&&n.append('<span class="close" data-dismiss="alert">&times;</span>'),n.append(t),i.top_offset&&(i.offset={from:"top",amount:i.top_offset}),o=i.offset.amount,e(".bootstrap-growl").each(function(){return o=Math.max(o,parseInt(e(this).css(i.offset.from))+e(this).outerHeight()+i.stackup_spacing)}),s={position:"body"===i.ele?"fixed":"absolute",margin:0,"z-index":"9999",display:"none"},s[i.offset.from]=o+"px",n.css(s),"auto"!==i.width&&n.css("width",i.width+"px"),e(i.ele).append(n),i.align){case"center":n.css({left:"50%","margin-left":"-"+n.outerWidth()/2+"px"});break;case"left":n.css("left","20px");break;default:n.css("right","20px")}return n.fadeIn(),i.delay>0&&n.delay(i.delay).fadeOut(function(){return e(this).alert("close")}),n},e.bootstrapGrowl.default_options={ele:"body",type:"info",offset:{from:"top",amount:20},align:"right",width:250,delay:4e3,allow_dismiss:!0,stackup_spacing:10}}.call(this),function(e){e.fn.confirm=function(t){return"undefined"==typeof t&&(t={}),this.click(function(i){i.preventDefault();var n=e.extend({button:e(this)},t);e.confirm(n,i)}),this},e.confirm=function(t,i){var n=e.extend(e.confirm.options,{confirm:function(){var n=i&&("string"==typeof i&&i||i.currentTarget&&i.currentTarget.attributes.href.value);if(n)if(t.post){var s=e('<form method="post" class="hide" action="'+n+'"></form>');e("body").append(s),s.submit()}else window.location=n},cancel:function(){},button:null},t),s="";""!==n.title&&(s='<div class=modal-header><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">'+n.title+"</h4></div>");var o='<div class="confirmation-modal modal fade" tabindex="-1" role="dialog"><div class="modal-dialog"><div class="modal-content">'+s+'<div class="modal-body">'+n.text+'</div><div class="modal-footer"><button class="confirm btn btn-primary" type="button" data-dismiss="modal">'+n.confirmButton+'</button><button class="cancel btn btn-default" type="button" data-dismiss="modal">'+n.cancelButton+"</div></div></div></div></div>",r=e(o);r.on("shown",function(){r.find(".btn-primary:first").focus()}),r.on("hidden",function(){r.remove()}),r.find(".confirm").click(function(){n.confirm(n.button)}),r.find(".cancel").click(function(){n.cancel(n.button)}),e("body").append(r),r.modal("show")},e.confirm.options={text:"Are you sure?",title:"",confirmButton:"Yes",cancelButton:"Cancel",post:!1}}(jQuery),function(e){"use strict";var t=function(){var t;return t=e("<div></div>").css(["color"]).color,"undefined"!=typeof t?function(e,t){return e.css(t)}:function(t,i){var n;return n={},e.each(i,function(e,i){n[i]=t.css(i)}),n}}(),i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},n=/[&<>"'\/]/g,s=function(e){return e.replace(n,function(e){return i[e]})},o=function(){function i(i){var s,l;l=i.css("position"),"static"===l&&(l="relative"),s=e(n.wrapper).css(e.extend({},o.wrapper,t(i,r),{position:l})),this.textareaTop=parseInt(i.css("border-top-width")),this.$el=e(n.overlay).css(e.extend({},o.overlay,t(i,a),{top:this.textareaTop,right:parseInt(i.css("border-right-width")),bottom:parseInt(i.css("border-bottom-width")),left:parseInt(i.css("border-left-width"))})),this.$textarea=i.css(o.textarea),this.$textarea.wrap(s).before(this.$el),this.$textarea.origVal=i.val,this.$textarea.val=e.proxy(this.val,this),this.$textarea.on({"input.overlay":e.proxy(this.onInput,this),"change.overlay":e.proxy(this.onInput,this),"scroll.overlay":e.proxy(this.resizeOverlay,this),"resize.overlay":e.proxy(this.resizeOverlay,this)}),this.strategies=[]}var n,o,r,a;return n={wrapper:'<div class="textoverlay-wrapper"></div>',overlay:'<div class="textoverlay"></div>'},o={wrapper:{margin:0,padding:0,overflow:"hidden"},overlay:{position:"absolute",color:"transparent","white-space":"pre-wrap","word-wrap":"break-word",overflow:"hidden"},textarea:{background:"transparent",position:"relative",outline:0}},r=["display"],a=["margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","font-family","font-weight","font-size","background-color"],e.extend(i.prototype,{val:function(e){return null==e?this.$textarea.origVal():this.setVal(e)},setVal:function(e){return this.$textarea.origVal(e),this.renderTextOnOverlay(),this.$textarea},onInput:function(){this.renderTextOnOverlay()},renderTextOnOverlay:function(){var t,i,n,o,r,a;for(t=s(this.$textarea.val()),i=0,n=this.strategies.length;n>i;i++)o=this.strategies[i],r=o.match,e.isArray(r)&&(r=e.map(r,function(e){return e.replace(/(\(|\)|\|)/g,"$1")}),r=new RegExp("("+r.join("|")+")","g")),a="background-color:"+o.css["background-color"],t=t.replace(r,function(e){return'<span style="'+a+'">'+e+"</span>"});return this.$el.html(t),this},resizeOverlay:function(){this.$el.css({top:this.textareaTop-this.$textarea.scrollTop()})},register:function(t){return t=e.isArray(t)?t:[t],this.strategies=this.strategies.concat(t),this.renderTextOnOverlay()},destroy:function(){var e;this.$textarea.off(".overlay"),e=this.$textarea.parent(),e.after(this.$textarea).remove(),this.$textarea.data("overlay",void 0),this.$textarea=null}}),i}();e.fn.overlay=function(t){var i;return i="overlay",this.each("destroy"===t?function(){var t=e(this).data(i);t&&t.destroy()}:function(){var n,s;n=e(this),s=n.data(i),s||(s=new o(n),n.data(i,s)),s.register(t)})}}(window.jQuery),!function(e){"use strict";var t=function(e){var t,n;return t=function(){n=!1},function(){var s;n||(n=!0,s=i(arguments),s.unshift(t),e.apply(this,s))}},i=function(e){var t;return t=Array.prototype.slice.call(e)},n=function(){var t;return t=e("<div></div>").css(["color"]).color,"undefined"!=typeof t?function(e,t){return e.css(t)}:function(t,i){var n;return n={},e.each(i,function(e,i){n[i]=t.css(i)}),n}}(),s=function(e){return e},o=function(e){var t={};return function(i,n){t[i]?n(t[i]):e.call(this,i,function(e){t[i]=(t[i]||[]).concat(e),n.apply(null,arguments)})}},r=function(e,t){var i,n;if(e.indexOf)return-1!=e.indexOf(t);for(i=0,n=e.length;n>i;i++)if(e[i]===t)return!0;return!1},a=function(){function i(t){var i;this.el=t.get(0),i=this.el===document.activeElement,this.$el=d(t),this.id="textComplete"+c++,this.strategies=[],i?(this.initialize(),this.$el.focus()):this.$el.one("focus.textComplete",e.proxy(this.initialize,this))}var s,o,r,a,c;s={wrapper:'<div class="textcomplete-wrapper"></div>',list:'<ul class="dropdown-menu"></ul>'},o={wrapper:{position:"relative"},list:{position:"absolute",top:0,left:0,zIndex:"100",display:"none"}},r=e(s.wrapper).css(o.wrapper),a=e(s.list).css(o.list),c=0,e.extend(i.prototype,{initialize:function(){var t,i;t=a.clone(),this.listView=new l(t,this),this.$el.before(t).on({"keyup.textComplete":e.proxy(this.onKeyup,this),"keydown.textComplete":e.proxy(this.listView.onKeydown,this.listView)}),i={},i["click."+this.id]=e.proxy(this.onClickDocument,this),i["keyup."+this.id]=e.proxy(this.onKeyupDocument,this),e(document).on(i)},register:function(e){this.strategies=this.strategies.concat(e)},renderList:function(e){this.clearAtNext&&(this.listView.clear(),this.clearAtNext=!1),e.length&&(this.listView.shown||(this.listView.setPosition(this.getCaretPosition()).clear().activate(),this.listView.strategy=this.strategy),e=e.slice(0,this.strategy.maxCount),this.listView.render(e)),!this.listView.data.length&&this.listView.shown&&this.listView.deactivate()},searchCallbackFactory:function(e){var t=this;return function(i,n){t.renderList(i),n||(e(),t.clearAtNext=!0)}},onKeyup:function(e){var t,i;if(!this.skipSearch(e))if(t=this.extractSearchQuery(this.getTextFromHeadToCaret()),t.length){if(i=t[1],this.term===i)return;this.term=i,this.search(t)}else this.term=null,this.listView.deactivate()},skipSearch:function(e){if(this.skipNextKeyup)return this.skipNextKeyup=!1,!0;switch(e.keyCode){case 40:case 38:return!0}},onSelect:function(t){var i,n,s;i=this.getTextFromHeadToCaret(),n=this.el.value.substring(this.el.selectionEnd),s=this.strategy.replace(t),e.isArray(s)&&(n=s[1]+n,s=s[0]),i=i.replace(this.strategy.match,s),this.$el.val(i+n).trigger("change").trigger("textComplete:select",t),this.el.focus(),this.el.selectionStart=this.el.selectionEnd=i.length,this.skipNextKeyup=!0},onClickDocument:function(e){e.originalEvent&&!e.originalEvent.keepTextCompleteDropdown&&this.listView.deactivate()},onKeyupDocument:function(e){this.listView.shown&&27===e.keyCode&&(this.listView.deactivate(),this.$el.focus())},destroy:function(){var t;this.$el.off(".textComplete"),e(document).off("."+this.id),this.listView&&this.listView.destroy(),t=this.$el.parent(),t.after(this.$el).remove(),this.$el.data("textComplete",void 0),this.$el=null},getCaretPosition:function(){if(0!==this.el.selectionEnd){var t,i,s,o,r,a;return a=this.$el.attr("dir")||this.$el.css("direction"),t=["border-width","font-family","font-size","font-style","font-variant","font-weight","height","letter-spacing","word-spacing","line-height","text-decoration","text-align","width","padding-top","padding-right","padding-bottom","padding-left","margin-top","margin-right","margin-bottom","margin-left"],i=e.extend({position:"absolute",overflow:"auto","white-space":"pre-wrap",top:0,left:-9999,direction:a},n(this.$el,t)),s=e("<div></div>").css(i).text(this.getTextFromHeadToCaret()),o=e("<span></span>").text(".").appendTo(s),this.$el.before(s),r=o.position(),r.top+=o.height()-this.$el.scrollTop(),"rtl"===a&&(r.left-=this.listView.$el.width()),s.remove(),r}},getTextFromHeadToCaret:function(){var e,t,i;return t=this.el.selectionEnd,"number"==typeof t?e=this.el.value.substring(0,t):document.selection&&(i=this.el.createTextRange(),i.moveStart("character",0),i.moveEnd("textedit"),e=i.text),e},extractSearchQuery:function(e){var t,i,n,s;for(t=0,i=this.strategies.length;i>t;t++)if(n=this.strategies[t],s=e.match(n.match))return[n,s[n.index]];return[]},search:t(function(e,t){var i;this.strategy=t[0],i=t[1],this.strategy.search(i,this.searchCallbackFactory(e))})});var d=function(e){return e.wrap(r.clone().css("display",e.css("display")))};return i}(),l=function(){function t(t,i){this.data=[],this.$el=t,this.index=0,this.completer=i,this.$el.on("click.textComplete","li.textcomplete-item",e.proxy(this.onClick,this))}return e.extend(t.prototype,{shown:!1,render:function(e){var t,i,n,s,o;for(t="",i=0,n=e.length;n>i&&(o=e[i],r(this.data,o)||(s=this.data.length,this.data.push(o),t+='<li class="textcomplete-item" data-index="'+s+'"><a>',t+=this.strategy.template(o),t+="</a></li>",this.data.length!==this.strategy.maxCount));i++);this.$el.append(t),this.data.length?this.activateIndexedItem():this.deactivate()},clear:function(){return this.data=[],this.$el.html(""),this.index=0,this},activateIndexedItem:function(){this.$el.find(".active").removeClass("active"),this.getActiveItem().addClass("active")},getActiveItem:function(){return e(this.$el.children().get(this.index))},activate:function(){return this.shown||(this.$el.show(),this.completer.$el.trigger("textComplete:show"),this.shown=!0),this},deactivate:function(){return this.shown&&(this.$el.hide(),this.completer.$el.trigger("textComplete:hide"),this.shown=!1,this.data=[],this.index=null),this},setPosition:function(e){return this.$el.css(e),this},select:function(e){var t=this;this.completer.onSelect(this.data[e]),setTimeout(function(){t.deactivate()},0)},onKeydown:function(e){this.shown&&(38===e.keyCode?(e.preventDefault(),0===this.index?this.index=this.data.length-1:this.index-=1,this.activateIndexedItem()):40===e.keyCode?(e.preventDefault(),this.index===this.data.length-1?this.index=0:this.index+=1,this.activateIndexedItem()):9===e.keyCode&&(e.preventDefault(),this.select(parseInt(this.getActiveItem().data("index"),10))))},onClick:function(t){var i=e(t.target);t.originalEvent.keepTextCompleteDropdown=!0,i.hasClass("textcomplete-item")||(i=i.parents("li.textcomplete-item")),this.select(parseInt(i.data("index"),10))},destroy:function(){this.deactivate(),this.$el.off("click.textComplete").remove(),this.$el=null}}),t}();e.fn.textcomplete=function(t){var i,n,r,l;if(l="textComplete","destroy"===t)return this.each(function(){var t=e(this).data(l);t&&t.destroy()});for(i=0,n=t.length;n>i;i++)r=t[i],r.template||(r.template=s),null==r.index&&(r.index=2),r.cache&&(r.search=o(r.search)),r.maxCount||(r.maxCount=10);return this.each(function(){var i,n;i=e(this),n=i.data(l),n||(n=new a(i),i.data(l,n)),n.register(t)})}}(window.jQuery||window.Zepto),function(e,t,i){"use strict";var n,s,o,r,a,l,c,d,u,h,p,f,m,g,v,y,b,w,_,x,k,S,$,C,T,E,P,I,O;k={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},y="scrollbar",v="scroll",d="mousedown",u="mousemove",p="mousewheel",h="mouseup",g="resize",a="drag",w="up",m="panedown",o="DOMMouseScroll",r="down",_="wheel",l="keydown",c="keyup",b="touchmove",n="Microsoft Internet Explorer"===t.navigator.appName&&/msie 7./i.test(t.navigator.appVersion)&&t.ActiveXObject,s=null,T=t.requestAnimationFrame,x=t.cancelAnimationFrame,P=i.createElement("div").style,O=function(){var e,t,i,n,s,o;for(n=["t","webkitT","MozT","msT","OT"],e=s=0,o=n.length;o>s;e=++s)if(i=n[e],t=n[e]+"ransform",t in P)return n[e].substr(0,n[e].length-1);return!1}(),I=function(e){return O===!1?!1:""===O?e:O+e.charAt(0).toUpperCase()+e.substr(1)},E=I("transform"),$=E!==!1,S=function(){var e,t,n;return e=i.createElement("div"),t=e.style,t.position="absolute",t.width="100px",t.height="100px",t.overflow=v,t.top="-9999px",i.body.appendChild(e),n=e.offsetWidth-e.clientWidth,i.body.removeChild(e),n},C=function(){var e,i,n;return i=t.navigator.userAgent,(e=/(?=.+Mac OS X)(?=.+Firefox)/.test(i))?(n=/Firefox\/\d{2}\./.exec(i),n&&(n=n[0].replace(/\D+/g,"")),e&&+n>23):!1},f=function(){function l(n,o){this.el=n,this.options=o,s||(s=S()),this.$el=e(this.el),this.doc=e(this.options.documentContext||i),this.win=e(this.options.windowContext||t),this.$content=this.$el.children("."+o.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return l.prototype.preventScrolling=function(e,t){if(this.isActive)if(e.type===o)(t===r&&e.originalEvent.detail>0||t===w&&e.originalEvent.detail<0)&&e.preventDefault();else if(e.type===p){if(!e.originalEvent||!e.originalEvent.wheelDelta)return;(t===r&&e.originalEvent.wheelDelta<0||t===w&&e.originalEvent.wheelDelta>0)&&e.preventDefault()}},l.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},l.prototype.updateScrollValues=function(){var e,t;e=this.content,this.maxScrollTop=e.scrollHeight-e.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=e.scrollTop,t=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!==t&&this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:t}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},l.prototype.setOnScrollStyles=function(){var e;$?(e={},e[E]="translate(0, "+this.sliderTop+"px)"):e={top:this.sliderTop},T?this.scrollRAF||(this.scrollRAF=T(function(t){return function(){t.scrollRAF=null,t.slider.css(e)}}(this))):this.slider.css(e)},l.prototype.createEvents=function(){this.events={down:function(e){return function(t){return e.isBeingDragged=!0,e.offsetY=t.pageY-e.slider.offset().top,e.pane.addClass("active"),e.doc.bind(u,e.events[a]).bind(h,e.events[w]),!1}}(this),drag:function(e){return function(t){return e.sliderY=t.pageY-e.$el.offset().top-e.offsetY,e.scroll(),e.contentScrollTop>=e.maxScrollTop&&e.prevScrollTop!==e.maxScrollTop?e.$el.trigger("scrollend"):0===e.contentScrollTop&&0!==e.prevScrollTop&&e.$el.trigger("scrolltop"),!1}}(this),up:function(e){return function(){return e.isBeingDragged=!1,e.pane.removeClass("active"),e.doc.unbind(u,e.events[a]).unbind(h,e.events[w]),!1}}(this),resize:function(e){return function(){e.reset()}}(this),panedown:function(e){return function(t){return e.sliderY=(t.offsetY||t.originalEvent.layerY)-.5*e.sliderHeight,e.scroll(),e.events.down(t),!1}}(this),scroll:function(e){return function(t){e.updateScrollValues(),e.isBeingDragged||(e.iOSNativeScrolling||(e.sliderY=e.sliderTop,e.setOnScrollStyles()),null!=t&&(e.contentScrollTop>=e.maxScrollTop?(e.options.preventPageScrolling&&e.preventScrolling(t,r),e.prevScrollTop!==e.maxScrollTop&&e.$el.trigger("scrollend")):0===e.contentScrollTop&&(e.options.preventPageScrolling&&e.preventScrolling(t,w),0!==e.prevScrollTop&&e.$el.trigger("scrolltop"))))}}(this),wheel:function(e){return function(t){var i;if(null!=t)return i=t.delta||t.wheelDelta||t.originalEvent&&t.originalEvent.wheelDelta||-t.detail||t.originalEvent&&-t.originalEvent.detail,i&&(e.sliderY+=-i/3),e.scroll(),!1}}(this)}},l.prototype.addEvents=function(){var e;this.removeEvents(),e=this.events,this.options.disableResize||this.win.bind(g,e[g]),this.iOSNativeScrolling||(this.slider.bind(d,e[r]),this.pane.bind(d,e[m]).bind(""+p+" "+o,e[_])),this.$content.bind(""+v+" "+p+" "+o+" "+b,e[v])},l.prototype.removeEvents=function(){var e;e=this.events,this.win.unbind(g,e[g]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(""+v+" "+p+" "+o+" "+b,e[v])},l.prototype.generate=function(){var e,i,n,o,r,a;return o=this.options,r=o.paneClass,a=o.sliderClass,e=o.contentClass,this.$el.find("."+r).length||this.$el.find("."+a).length||this.$el.append('<div class="'+r+'"><div class="'+a+'" /></div>'),this.pane=this.$el.children("."+r),this.slider=this.pane.find("."+a),0===s&&C()?(n=t.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/\D+/g,""),i={right:-14,paddingRight:+n+14}):s&&(i={right:-s},this.$el.addClass("has-scrollbar")),null!=i&&this.$content.css(i),this},l.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},l.prototype.reset=function(){var e,t,i,o,r,a,l,c,d,u,h,p;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),e=this.content,o=e.style,r=o.overflowY,n&&this.$content.css({height:this.$content.height()}),t=e.scrollHeight+s,u=parseInt(this.$el.css("max-height"),10),u>0&&(this.$el.height(""),this.$el.height(e.scrollHeight>u?u:e.scrollHeight)),l=this.pane.outerHeight(!1),d=parseInt(this.pane.css("top"),10),a=parseInt(this.pane.css("bottom"),10),c=l+d+a,p=Math.round(c/t*c),p<this.options.sliderMinHeight?p=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&p>this.options.sliderMaxHeight&&(p=this.options.sliderMaxHeight),r===v&&o.overflowX!==v&&(p+=s),this.maxSliderTop=c-p,this.contentHeight=t,this.paneHeight=l,this.paneOuterHeight=c,this.sliderHeight=p,this.slider.height(p),this.events.scroll(),this.pane.show(),this.isActive=!0,e.scrollHeight===e.clientHeight||this.pane.outerHeight(!0)>=e.scrollHeight&&r!==v?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===e.scrollHeight&&r===v?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),i=this.$content.css("position"),("static"===i||"relative"===i)&&(h=parseInt(this.$content.css("right"),10),h&&this.$content.css({right:"",marginRight:h})),this)},l.prototype.scroll=function(){return this.isActive?(this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop((this.paneHeight-this.contentHeight+s)*this.sliderY/this.maxSliderTop*-1),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this):void 0},l.prototype.scrollBottom=function(e){return this.isActive?(this.$content.scrollTop(this.contentHeight-this.$content.height()-e).trigger(p),this.stop().restore(),this):void 0},l.prototype.scrollTop=function(e){return this.isActive?(this.$content.scrollTop(+e).trigger(p),this.stop().restore(),this):void 0},l.prototype.scrollTo=function(e){return this.isActive?(this.scrollTop(this.$el.find(e).get(0).offsetTop),this):void 0},l.prototype.stop=function(){return x&&this.scrollRAF&&(x(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},l.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),n&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass("has-scrollbar")&&(this.$el.removeClass("has-scrollbar"),this.$content.css({right:""})),this},l.prototype.flash=function(){return!this.iOSNativeScrolling&&this.isActive?(this.reset(),this.pane.addClass("flashed"),setTimeout(function(e){return function(){e.pane.removeClass("flashed")}}(this),this.options.flashDelay),this):void 0},l}(),e.fn.nanoScroller=function(t){return this.each(function(){var i,n;if((n=this.nanoscroller)||(i=e.extend({},k,t),this.nanoscroller=n=new f(this,i)),t&&"object"==typeof t){if(e.extend(n.options,t),null!=t.scrollBottom)return n.scrollBottom(t.scrollBottom);if(null!=t.scrollTop)return n.scrollTop(t.scrollTop);if(t.scrollTo)return n.scrollTo(t.scrollTo);if("bottom"===t.scroll)return n.scrollBottom(0);if("top"===t.scroll)return n.scrollTop(0);if(t.scroll&&t.scroll instanceof e)return n.scrollTo(t.scroll);if(t.stop)return n.stop();if(t.destroy)return n.destroy();if(t.flash)return n.flash()}return n.reset()})},e.fn.nanoScroller.Constructor=f}(jQuery,window,document),function(){"use strict";function e(e){function t(t,n){var o,m,g=t==window,v=n&&void 0!==n.message?n.message:void 0;if(n=e.extend({},e.blockUI.defaults,n||{}),!n.ignoreIfBlocked||!e(t).data("blockUI.isBlocked")){if(n.overlayCSS=e.extend({},e.blockUI.defaults.overlayCSS,n.overlayCSS||{}),o=e.extend({},e.blockUI.defaults.css,n.css||{}),n.onOverlayClick&&(n.overlayCSS.cursor="pointer"),m=e.extend({},e.blockUI.defaults.themedCSS,n.themedCSS||{}),v=void 0===v?n.message:v,g&&p&&i(window,{fadeOut:0}),v&&"string"!=typeof v&&(v.parentNode||v.jquery)){var y=v.jquery?v[0]:v,b={};
e(t).data("blockUI.history",b),b.el=y,b.parent=y.parentNode,b.display=y.style.display,b.position=y.style.position,b.parent&&b.parent.removeChild(y)}e(t).data("blockUI.onUnblock",n.onUnblock);var w,_,x,k,S=n.baseZ;w=e(d||n.forceIframe?'<iframe class="blockUI" style="z-index:'+S++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+n.iframeSrc+'"></iframe>':'<div class="blockUI" style="display:none"></div>'),_=e(n.theme?'<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+S++ +';display:none"></div>':'<div class="blockUI blockOverlay" style="z-index:'+S++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>'),n.theme&&g?(k='<div class="blockUI '+n.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(S+10)+';display:none;position:fixed">',n.title&&(k+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(n.title||"&nbsp;")+"</div>"),k+='<div class="ui-widget-content ui-dialog-content"></div>',k+="</div>"):n.theme?(k='<div class="blockUI '+n.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(S+10)+';display:none;position:absolute">',n.title&&(k+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(n.title||"&nbsp;")+"</div>"),k+='<div class="ui-widget-content ui-dialog-content"></div>',k+="</div>"):k=g?'<div class="blockUI '+n.blockMsgClass+' blockPage" style="z-index:'+(S+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+n.blockMsgClass+' blockElement" style="z-index:'+(S+10)+';display:none;position:absolute"></div>',x=e(k),v&&(n.theme?(x.css(m),x.addClass("ui-widget-content")):x.css(o)),n.theme||_.css(n.overlayCSS),_.css("position",g?"fixed":"absolute"),(d||n.forceIframe)&&w.css("opacity",0);var $=[w,_,x],C=e(g?"body":t);e.each($,function(){this.appendTo(C)}),n.theme&&n.draggable&&e.fn.draggable&&x.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var T=h&&(!e.support.boxModel||e("object,embed",g?null:t).length>0);if(u||T){if(g&&n.allowBodyStretch&&e.support.boxModel&&e("html,body").css("height","100%"),(u||!e.support.boxModel)&&!g)var E=l(t,"borderTopWidth"),P=l(t,"borderLeftWidth"),I=E?"(0 - "+E+")":0,O=P?"(0 - "+P+")":0;e.each($,function(e,t){var i=t[0].style;if(i.position="absolute",2>e)g?i.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+n.quirksmodeOffsetHack+') + "px"'):i.setExpression("height",'this.parentNode.offsetHeight + "px"'),g?i.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):i.setExpression("width",'this.parentNode.offsetWidth + "px"'),O&&i.setExpression("left",O),I&&i.setExpression("top",I);else if(n.centerY)g&&i.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),i.marginTop=0;else if(!n.centerY&&g){var s=n.css&&n.css.top?parseInt(n.css.top,10):0,o="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+s+') + "px"';i.setExpression("top",o)}})}if(v&&(n.theme?x.find(".ui-widget-content").append(v):x.append(v),(v.jquery||v.nodeType)&&e(v).show()),(d||n.forceIframe)&&n.showOverlay&&w.show(),n.fadeIn){var M=n.onBlock?n.onBlock:c,A=n.showOverlay&&!v?M:c,D=v?M:c;n.showOverlay&&_._fadeIn(n.fadeIn,A),v&&x._fadeIn(n.fadeIn,D)}else n.showOverlay&&_.show(),v&&x.show(),n.onBlock&&n.onBlock();if(s(1,t,n),g?(p=x[0],f=e(n.focusableElements,p),n.focusInput&&setTimeout(r,20)):a(x[0],n.centerX,n.centerY),n.timeout){var j=setTimeout(function(){g?e.unblockUI(n):e(t).unblock(n)},n.timeout);e(t).data("blockUI.timeout",j)}}}function i(t,i){var o,r=t==window,a=e(t),l=a.data("blockUI.history"),c=a.data("blockUI.timeout");c&&(clearTimeout(c),a.removeData("blockUI.timeout")),i=e.extend({},e.blockUI.defaults,i||{}),s(0,t,i),null===i.onUnblock&&(i.onUnblock=a.data("blockUI.onUnblock"),a.removeData("blockUI.onUnblock"));var d;d=r?e("body").children().filter(".blockUI").add("body > .blockUI"):a.find(">.blockUI"),i.cursorReset&&(d.length>1&&(d[1].style.cursor=i.cursorReset),d.length>2&&(d[2].style.cursor=i.cursorReset)),r&&(p=f=null),i.fadeOut?(o=d.length,d.stop().fadeOut(i.fadeOut,function(){0===--o&&n(d,l,i,t)})):n(d,l,i,t)}function n(t,i,n,s){var o=e(s);if(!o.data("blockUI.isBlocked")){t.each(function(){this.parentNode&&this.parentNode.removeChild(this)}),i&&i.el&&(i.el.style.display=i.display,i.el.style.position=i.position,i.parent&&i.parent.appendChild(i.el),o.removeData("blockUI.history")),o.data("blockUI.static")&&o.css("position","static"),"function"==typeof n.onUnblock&&n.onUnblock(s,n);var r=e(document.body),a=r.width(),l=r[0].style.width;r.width(a-1).width(a),r[0].style.width=l}}function s(t,i,n){var s=i==window,r=e(i);if((t||(!s||p)&&(s||r.data("blockUI.isBlocked")))&&(r.data("blockUI.isBlocked",t),s&&n.bindEvents&&(!t||n.showOverlay))){var a="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";t?e(document).bind(a,n,o):e(document).unbind(a,o)}}function o(t){if("keydown"===t.type&&t.keyCode&&9==t.keyCode&&p&&t.data.constrainTabKey){var i=f,n=!t.shiftKey&&t.target===i[i.length-1],s=t.shiftKey&&t.target===i[0];if(n||s)return setTimeout(function(){r(s)},10),!1}var o=t.data,a=e(t.target);return a.hasClass("blockOverlay")&&o.onOverlayClick&&o.onOverlayClick(t),a.parents("div."+o.blockMsgClass).length>0?!0:0===a.parents().children().filter("div.blockUI").length}function r(e){if(f){var t=f[e===!0?f.length-1:0];t&&t.focus()}}function a(e,t,i){var n=e.parentNode,s=e.style,o=(n.offsetWidth-e.offsetWidth)/2-l(n,"borderLeftWidth"),r=(n.offsetHeight-e.offsetHeight)/2-l(n,"borderTopWidth");t&&(s.left=o>0?o+"px":"0"),i&&(s.top=r>0?r+"px":"0")}function l(t,i){return parseInt(e.css(t,i),10)||0}e.fn._fadeIn=e.fn.fadeIn;var c=e.noop||function(){},d=/MSIE/.test(navigator.userAgent),u=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent),h=(document.documentMode||0,e.isFunction(document.createElement("div").style.setExpression));e.blockUI=function(e){t(window,e)},e.unblockUI=function(e){i(window,e)},e.growlUI=function(t,i,n,s){var o=e('<div class="growlUI"></div>');t&&o.append("<h1>"+t+"</h1>"),i&&o.append("<h2>"+i+"</h2>"),void 0===n&&(n=3e3);var r=function(t){t=t||{},e.blockUI({message:o,fadeIn:"undefined"!=typeof t.fadeIn?t.fadeIn:700,fadeOut:"undefined"!=typeof t.fadeOut?t.fadeOut:1e3,timeout:"undefined"!=typeof t.timeout?t.timeout:n,centerY:!1,showOverlay:!1,onUnblock:s,css:e.blockUI.defaults.growlCSS})};r();o.css("opacity");o.mouseover(function(){r({fadeIn:0,timeout:3e4});var t=e(".blockMsg");t.stop(),t.fadeTo(300,1)}).mouseout(function(){e(".blockMsg").fadeOut(1e3)})},e.fn.block=function(i){if(this[0]===window)return e.blockUI(i),this;var n=e.extend({},e.blockUI.defaults,i||{});return this.each(function(){var t=e(this);n.ignoreIfBlocked&&t.data("blockUI.isBlocked")||t.unblock({fadeOut:0})}),this.each(function(){"static"==e.css(this,"position")&&(this.style.position="relative",e(this).data("blockUI.static",!0)),this.style.zoom=1,t(this,i)})},e.fn.unblock=function(t){return this[0]===window?(e.unblockUI(t),this):this.each(function(){i(this,t)})},e.blockUI.version=2.66,e.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",textAlign:"center",color:"#000",cursor:"wait"},themedCSS:{width:"30%",top:"40%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,centerX:!1,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1};var p=null,f=[]}"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],e):e(jQuery)}(),function(){function e(e,i){function l(t){t&&(t=JSON.parse(t),"text"===t.data.type?M.receive(t.data,t.userid,t.extra):"undefined"!=typeof t.data.maxChunks?O.receive(t.data):e.autoTranslateText?(t.original=t.data,e.Translator.TranslateText(t.data,function(i){t.data=i,e.onmessage(t)})):e.onmessage(t))}function m(t){return e.sessionid&&t.sessionid!=e.sessionid?void 0:e.onNewSession?(t.join=function(i){if(!i)return e.join(t);for(var n in i)t.session[n]=i[n];var s=e.dontAttachStream;e.dontAttachStream=!1,e.captureUserMedia(function(){e.dontAttachStream=!0,e.join(t),e.dontAttachStream=s},i)},t.extra||(t.extra={}),e.onNewSession(t)):void e.join(t)}function v(t){for(var i=0;i<e.localStreamids.length;i++){var n=e.localStreamids[i];e.streams[n]&&e.streams[n].sockets.push(t)}}function y(i){function n(t,s,o){o||(o=0),o++,t.readyState<=HTMLMediaElement.HAVE_CURRENT_DATA||t.paused||t.currentTime<=0?(o>=60?C.send({userid:e.userid,extra:e.extra,failedToReceiveRemoteVideo:!0,streamid:i.stream.streamid}):console.log("connection.attachStreams",e.attachStreams),setTimeout(function(){A("Waiting for incoming remote stream to be started flowing: "+o+" seconds."),n(t,s,o)},900)):r(t,s)}function s(){if(e.fakeDataChannels&&!e.channels[i.userid]&&!e.session.data){var t={send:function(e){C.send({fakeData:e})},readyState:"open"};e.channels[i.userid]={channel:t,send:function(e){this.channel.send(e)}},I.onopen(t)}}function r(t,n){var s=i.stream;s.onended=function(){e.onstreamended(r)};var r={mediaElement:t,stream:s,streamid:s.streamid,session:n||e.session,blobURL:t.mozSrcObject||t.src,type:"remote",extra:i.extra,userid:i.userid,isVideo:s.getVideoTracks().length>0,isAudio:!s.getVideoTracks().length&&s.getAudioTracks().length>0,isInitiator:!!i.isInitiator};if(e.streams[s.streamid]=e._getStream({stream:s,userid:i.userid,streamid:s.streamid,socket:C,type:"remote",streamObject:r,mediaElement:t,rtcMultiConnection:e,session:n||e.session}),e.onstream(r),_(),e.onspeaking){var a=new o({context:e._audioContext,connection:e,event:r});a.connectToSource(s)}}function m(t){i.channel=t,e.channels[i.userid]={channel:i.channel,send:function(t){e.send(t,this.channel)}},e.onopen({extra:i.extra,userid:i.userid});for(var n in e.fileQueue)e.send(e.fileQueue[n],t);a(e.session)&&_()}function y(){C.userid!=i.userid&&(C.userid=i.userid,R[i.socketIndex]=C,e.stats.numberOfConnectedUsers++,e.peers[i.userid]={socket:C,peer:$,userid:i.userid,extra:i.extra,targetBrowser:i.targetBrowser,addStream:function(t){e.addStream(t,this.socket)},removeStream:function(t){return e.streams[t]?(this.peer.connection.removeStream(e.streams[t].stream),void this.renegotiate()):j("No such stream exists. Stream-id:",t)},renegotiate:function(t,i){e.renegotiate(t,i)},changeBandwidth:function(t){if(!t)throw"You MUST pass bandwidth object.";if("string"==typeof t)throw"Pass object for bandwidth instead of string; e.g. {audio:10, video:20}";this.peer.bandwidth=t,this.socket.send({userid:e.userid,extra:e.extra||{},changeBandwidth:!0,bandwidth:t})},sendCustomMessage:function(t){this.socket.send({userid:e.userid,extra:e.extra||{},customMessage:!0,message:t})},onCustomMessage:function(e){A('Received "private" message from',this.userid,"string"==typeof e?e:d(e))},drop:function(t){for(var i in e.streams)-1==e._skip.indexOf(i)&&(i=e.streams[i],i.userid==e.userid&&"local"==i.type&&(this.peer.connection.removeStream(i.stream),e.onstreamended(i.streamObject)),"remote"==i.type&&i.userid==this.userid&&e.onstreamended(i.streamObject));!t&&this.socket.send({userid:e.userid,extra:e.extra||{},drop:!0})},hold:function(t){this.socket.send({userid:e.userid,extra:e.extra||{},hold:!0,holdMLine:t||"both"}),this.peer.hold=!0,this.fireHoldUnHoldEvents({kind:t,isHold:!0,userid:e.userid,remoteUser:this.userid})},unhold:function(t){this.socket.send({userid:e.userid,extra:e.extra||{},unhold:!0,holdMLine:t||"both"}),this.peer.hold=!1,this.fireHoldUnHoldEvents({kind:t,isHold:!1,userid:e.userid,remoteUser:this.userid})},fireHoldUnHoldEvents:function(t){var i=t.isHold,n=t.kind,s=t.remoteUser||t.userid;for(var o in e.streams)-1==e._skip.indexOf(o)&&(o=e.streams[o],o.userid==s&&(i&&e.onhold(p({kind:n},o.streamObject)),i||e.onunhold(p({kind:n},o.streamObject))))},redial:function(){for(var i in e.streams)-1==e._skip.indexOf(i)&&(i=e.streams[i],i.userid==this.userid&&"remote"==i.type&&e.onstreamended(i.streamObject));A("ReDialing..."),C.send({userid:e.userid,extra:e.extra,recreatePeer:!0}),$=new t,$.create("offer",I)},sharePartOfScreen:function(t){function i(){return s.stopPartOfScreenSharing?(s.stopPartOfScreenSharing=!1,void(e.onpartofscreenstopped&&e.onpartofscreenstopped())):s.pausePartOfScreenSharing?(e.onpartofscreenpaused&&e.onpartofscreenpaused(),setTimeout(i,t.interval||200)):void html2canvas(n,{onrendered:function(n){var r=n.toDataURL();if(!e.channels[s.userid])throw"No such data channel exists.";r!=o&&(o=r,e.channels[s.userid].send({userid:e.userid,extra:e.extra,screenshot:r,isPartOfScreen:!0})),!t.once&&setTimeout(i,t.interval||200)}})}var n=t.element,s=this;if(!window.html2canvas)return f("https://www.webrtc-experiment.com/screenshot.js",function(){s.sharePartOfScreen(t)});if("string"==typeof n&&(n=document.querySelector(n),n||(n=document.getElementById(n))),!n)throw"HTML Element is inaccessible!";var o="";i()}})}function _(){if(e.isInitiator&&u(H)&&u(H)<=e.maxParticipantsAllowed&&(e.session.oneway||e.session.broadcast||L.send({sessionid:e.sessionid,newParticipant:i.userid||C.channel,userid:e.userid,extra:e.extra,userData:{userid:i.userid||C.channel,extra:i.extra}})),"chromium"==i.targetBrowser&&!i.renegotiatedOnce)for(var t in e.renegotiatedSessions)i.renegotiatedOnce=!0,e.renegotiatedSessions[t]&&e.renegotiatedSessions[t].stream&&e.peers[i.userid].renegotiate(e.renegotiatedSessions[t].stream,e.renegotiatedSessions[t].session)}function x(n){if(n.userid!=e.userid){if(n.sdp){i.userid=n.userid,i.extra=n.extra||{},i.renegotiate=n.renegotiate,i.streaminfo=n.streaminfo,i.isInitiator=n.isInitiator,i.targetBrowser=n.targetBrowser;var o=JSON.parse(n.sdp);"offer"==o.type&&(I.preferSCTP=!!n.preferSCTP,e.fakeDataChannels=!!n.fakeDataChannels),s(),k(o,n.labels)}if(n.candidate&&$&&$.addIceCandidate({sdpMLineIndex:n.candidate.sdpMLineIndex,candidate:JSON.parse(n.candidate.candidate)}),n.mute||n.unmute)if(n.promptMuteUnmute)e.streams[n.streamid]&&(n.mute&&!e.streams[n.streamid].muted&&e.streams[n.streamid].mute(n.session),n.unmute&&e.streams[n.streamid].muted&&e.streams[n.streamid].unmute(n.session));else{var r={};e.streams[n.streamid]&&(r=e.streams[n.streamid].streamObject);var a=n.session,l=p({},r);l.session=a,l.isAudio=a.audio&&!a.video,l.isVideo=!a.audio&&a.video||a.audio&&a.video,n.mute&&e.onmute(l||n),n.unmute&&e.onunmute(l||n)}if(n.isVolumeChanged&&(A("Volume of stream: "+n.streamid+" has changed to: "+n.volume),e.streams[n.streamid])){var c=e.streams[n.streamid].mediaElement;c&&(c.volume=n.volume)}if(n.stopped&&e.streams[n.streamid]&&e.onstreamended(e.streams[n.streamid].streamObject),n.promptStreamStop&&(j("Remote stream has been manually stopped!"),e.streams[n.streamid]&&e.streams[n.streamid].stop()),n.left){if(P){var u=n.userid;for(var h in e.streams)h=e.streams[h],h.userid==u&&(g(h),h.stream.onended(h.streamObject))}$&&$.connection&&("closed"!=$.connection.signalingState&&$.connection.close(),$.connection=null),n.closeEntireSession?(e.close(),e.refresh()):C&&n.ejected&&(C.send({left:!0,extra:e.extra,userid:e.userid}),R[i.socketIndex]&&delete R[i.socketIndex],D[C.channel]&&delete D[C.channel],C=null),e.remove(n.userid),H[n.userid]&&delete H[n.userid],e.onleave({userid:n.userid,extra:n.extra,entireSessionClosed:!!n.closeEntireSession})}if(n.playRoleOfBroadcaster&&(n.extra&&(e.extra=p(e.extra,n.extra)),setTimeout(e.playRoleOfInitiator,2e3)),n.isCreateDataChannel&&P&&$.createDataChannel(),n.changeBandwidth){if(!e.peers[n.userid])throw"No such peer exists.";e.peers[n.userid].peer.bandwidth=n.bandwidth,e.peers[n.userid].renegotiate()}if(n.customMessage){if(!e.peers[n.userid])throw"No such peer exists.";e.peers[n.userid].onCustomMessage(n.message)}if(n.drop){if(!e.peers[n.userid])throw"No such peer exists.";e.peers[n.userid].drop(!0),e.peers[n.userid].renegotiate(),e.ondrop(n.userid)}if(n.hold){if(!e.peers[n.userid])throw"No such peer exists.";e.peers[n.userid].peer.hold=!0,e.peers[n.userid].peer.holdMLine=n.holdMLine,e.peers[n.userid].renegotiate(),e.peers[n.userid].fireHoldUnHoldEvents({kind:n.holdMLine,isHold:!0,userid:n.userid})}if(n.unhold){if(!e.peers[n.userid])throw"No such peer exists.";e.peers[n.userid].peer.hold=!1,e.peers[n.userid].peer.holdMLine=n.holdMLine,e.peers[n.userid].renegotiate(),e.peers[n.userid].fireHoldUnHoldEvents({kind:n.holdMLine,isHold:!1,userid:n.userid})}n.fakeData&&I.onmessage(n.fakeData),n.recreatePeer&&($=new t),n.failedToReceiveRemoteVideo&&(A("Remote peer hasn't received stream: "+n.streamid+". Renegotiating..."),e.peers[n.userid]&&e.peers[n.userid].renegotiate()),n.redial&&e.peers[n.userid]&&("disconnected"!=e.peers[n.userid].peer.connection.iceConnectionState&&(i.redialing=!1),"disconnected"!=e.peers[n.userid].peer.connection.iceConnectionState||i.redialing||(i.redialing=!0,j("Peer connection is closed.",d(e.peers[n.userid].peer.connection),"ReDialing.."),e.peers[n.userid].redial()))}}function k(n,s){function o(){return P||"gecko"==i.targetBrowser?void(e.peers[i.userid]&&e.peers[i.userid].redial()):void $.recreateAnswer(n,r,function(e,t){w({sdp:e,socket:C,streaminfo:t})})}if(A(n.type,n.sdp),"answer"==n.type)return $.setRemoteDescription(n),void y();if(!i.renegotiate&&"offer"==n.type)return I.offerDescription=n,I.session=e.session,$||($=new t),$.create("answer",I),void y();var r=i.renegotiate;if(b(s,$.connection),r.oneway||a(r))o(),delete i.renegotiate;else{if(i.capturing)return;i.capturing=!0,e.captureUserMedia(function(t){i.capturing=!1,(E||P&&!$.connection.getLocalStreams().length)&&$.connection.addStream(t),e.renegotiatedSessions[JSON.stringify(i.renegotiate)]={session:i.renegotiate,stream:t},delete i.renegotiate,o()},i.renegotiate)}}var S={channel:i.channel,onmessage:x,onopen:function(n){n&&(C=n),T&&!$&&(I.session=e.session,$||($=new t),$.create("offer",I)),i.socketIndex=C.index=R.length,D[S.channel]=C,R[i.socketIndex]=C,v(C)}};S.callback=function(e){C=e,S.onopen()};var $,C=e.openSignalingChannel(S),T=i.isofferer,I={onopen:m,onicecandidate:function(t){if(!e.candidates)throw"ICE candidates are mandatory.";(e.candidates.host||-1==t.candidate.indexOf("typ host "))&&(e.candidates.relay||-1==t.candidate.indexOf("typ relay "))&&(e.candidates.reflexive||-1==t.candidate.indexOf("typ srflx "))&&(A(t.candidate),C&&C.send({userid:e.userid,candidate:{sdpMLineIndex:t.sdpMLineIndex,candidate:JSON.stringify(t.candidate)}}))},onmessage:l,onaddstream:function(t,s){if(s=s||i.renegotiate||e.session,!a(s)){if(i.streaminfo){for(var o=i.streaminfo.split("----"),l=0;l<o.length;l++)t.streamid=o[l];i.streaminfo=c(o.pop()).join("----")}var d=h(t,p({remote:!0},s));i.stream=t,t.getVideoTracks().length?n(d,s):d.addEventListener("play",function(){setTimeout(function(){d.muted=!1,r(d,s)},3e3)},!1),e.setDefaultEventsForMediaElement&&e.setDefaultEventsForMediaElement(d,t.streamid),e.isInitiator&&u(H)>1&&u(H)<=e.maxParticipantsAllowed&&(e.session.oneway||e.session.broadcast||L.send({joinUsers:H,userid:e.userid,extra:e.extra}))}},onremovestream:function(e){j("onremovestream",e)},onclose:function(t){t.extra=i.extra,t.userid=i.userid,e.onclose(t),e.channels[t.userid]&&delete e.channels[t.userid]},onerror:function(t){t.extra=i.extra,t.userid=i.userid,e.onerror(t)},oniceconnectionstatechange:function(t){if(A("oniceconnectionstatechange",d(t)),e.peers[i.userid]&&e.peers[i.userid].oniceconnectionstatechange&&e.peers[i.userid].oniceconnectionstatechange(t),e.peers[i.userid]&&"failed"==e.peers[i.userid].peer.connection.iceConnectionState&&(P||"gecko"==i.targetBrowser?(j("ICE connectivity check is failed. Re-establishing peer connection."),e.peers[i.userid].redial()):(j("ICE connectivity check is failed. Renegotiating peer connection."),e.peers[i.userid].renegotiate())),e.peers[i.userid]&&"disconnected"==e.peers[i.userid].peer.connection.iceConnectionState){for(var n in e.streams)n=e.streams[n],n.userid==i.userid&&"remote"==n.type&&e.onstreamended(n.streamObject);e.remove(i.userid)}if(e.autoReDialOnFailure&&e.peers[i.userid]&&("disconnected"!=e.peers[i.userid].peer.connection.iceConnectionState&&(i.redialing=!1),"disconnected"==e.peers[i.userid].peer.connection.iceConnectionState&&!i.redialing)){i.redialing=!0,j("Peer connection is closed.",d(e.peers[i.userid].peer.connection),"ReDialing.."),e.peers[i.userid].socket.send({userid:e.userid,extra:e.extra||{},redial:!0});for(var n in e.streams)n=e.streams[n],n.userid==i.userid&&"remote"==n.type&&e.onstreamended(n.streamObject)}},onsignalingstatechange:function(e){A("onsignalingstatechange",d(e))},attachStreams:e.attachStreams,iceServers:e.iceServers,bandwidth:e.bandwidth,sdpConstraints:e.sdpConstraints,optionalArgument:e.optionalArgument,disableDtlsSrtp:e.disableDtlsSrtp,dataChannelDict:e.dataChannelDict,preferSCTP:e.preferSCTP,onSessionDescription:function(e,t){w({sdp:e,socket:C,streaminfo:t})},socket:C,selfUserid:e.userid,trickleIce:e.trickleIce};e.playRoleOfInitiator=function(){e.dontAttachStream=!0,e.open(),R=c(R),e.dontAttachStream=!1},e.askToShareParticipants=function(){L&&L.send({userid:e.userid,extra:e.extra,askToShareParticipants:!0})},e.shareParticipants=function(t){var i={joinUsers:H,userid:e.userid,extra:e.extra};t&&(t.dontShareWith&&(i.dontShareWith=t.dontShareWith),t.shareWith&&(i.shareWith=t.shareWith)),L.send(i)}}function b(t,i){if(t)for(var n=0;n<t.length;n++){var s=t[n];e.streams[s]&&i.removeStream(e.streams[s].stream)}}function w(t){t.socket.send({userid:e.userid,sdp:JSON.stringify(t.sdp),extra:e.extra,renegotiate:t.renegotiate?t.renegotiate:!1,streaminfo:t.streaminfo||"",labels:t.labels||[],preferSCTP:!!e.preferSCTP,fakeDataChannels:!!e.fakeDataChannels,isInitiator:!!e.isInitiator,targetBrowser:P?"gecko":"chromium"})}function _(t){var i=t.newParticipant;if(i&&!H[i]&&i!=e.userid){H[i]=i;var n=e.token();y({channel:n,extra:t.userData?t.userData.extra:t.extra,userid:t.userData?t.userData.userid:t.userid}),L.send({participant:!0,userid:e.userid,targetUser:i,channel:n,extra:e.extra})}}function x(t){e.stats.numberOfConnectedUsers--;var i={left:!0,extra:e.extra,userid:e.userid,sessionid:e.sessionid};if(e.isInitiator&&(e.autoCloseEntireSession?i.closeEntireSession=!0:R[0]&&R[0].send({playRoleOfBroadcaster:!0,userid:e.userid})),!t)for(var n=R.length,s=0;n>s;s++)socket=R[s],socket&&(socket.send(i),D[socket.channel]&&delete D[socket.channel],delete R[s]);t&&(socket=D[t],socket&&(i.ejected=!0,socket.send(i),R[socket.index]&&delete R[socket.index],delete D[t])),R=c(R)}function S(){N.signalingReady||(N.signalingReady=!0,setTimeout(i,1e3),e.isInitiator||L.send({userid:e.userid,extra:e.extra,searchingForRooms:!0}))}function $(t){for(var i in t)H[t[i]]||_({sessionid:e.sessionid,newParticipant:t[i],userid:e.userid,extra:e.extra})}function C(){var t=0;256!=e.maxParticipantsAllowed&&(t=e.maxParticipantsAllowed),"one-way"==e.direction&&(e.session.oneway=!0),"one-to-one"==e.direction&&(e.maxParticipantsAllowed=1),"one-to-many"==e.direction&&(e.session.broadcast=!0),"many-to-many"==e.direction&&(e.maxParticipantsAllowed&&1!=e.maxParticipantsAllowed||(e.maxParticipantsAllowed=256)),t&&1!=e.maxParticipantsAllowed&&(e.maxParticipantsAllowed=t)}function T(t){if(N.requestsFrom||(N.requestsFrom={}),!N.requestsFrom[t.userid]){var i={userid:t.userid,extra:t.extra,channel:t.channel||t.userid,session:t.session||e.session};N.requestsFrom[t.userid]=i,e.onRequest&&e.isInitiator?e.onRequest(i):I(i)}}function I(t){H[t.userid]=t.userid,y({isofferer:!0,userid:t.userid,channel:t.channel,extra:t.extra||{},session:t.session||e.session})}var O=new n(e),M=new s(e),D={},R=[],N=this,H={};e.remove=function(t){N.requestsFrom&&N.requestsFrom[t]&&delete N.requestsFrom[t],e.peers[t]&&(e.peers[t].peer&&e.peers[t].peer.connection&&("closed"!=e.peers[t].peer.connection.signalingState&&e.peers[t].peer.connection.close(),e.peers[t].peer.connection=null),delete e.peers[t]),H[t]&&delete H[t];for(var i in e.streams)i=e.streams[i],i.userid==t&&(e.onstreamended(i.streamObject),i.stop&&i.stop(),delete e.streams[i]);D[t]&&delete D[t]},e.refresh=function(){e.isInitiator&&e.socket&&e.socket.remove&&e.socket.remove(),H=[];for(var t=0;t<e.attachStreams.length;t++)console.log("self",e.attachStreams[t]),g(e.attachStreams[t]);e.attachStreams=[],k={streams:[],mutex:!1,queueRequests:[]};for(var i in e.streams)-1==e._skip.indexOf(i)&&(e.onstreamended(e.streams[i].streamObject),delete e.streams[i]);N.isOwnerLeaving=!0,e.isInitiator=!1},e.reject=function(t){"string"!=typeof t&&(t=t.userid),L.send({rejectedRequestOf:t,userid:e.userid,extra:e.extra||{}})},window.addEventListener("beforeunload",function(){x()},!1),window.addEventListener("keyup",function(e){116==e.keyCode&&x()},!1);var L=e.openSignalingChannel({onmessage:function(t){if(t.userid!=e.userid){if(t.sessionid&&t.userid&&(e.stats.sessions[t.sessionid]||(e.stats.numberOfSessions++,e.stats.sessions[t.sessionid]=t)),e.isAcceptNewSession&&t.sessionid&&t.userid&&(e.dontOverrideSession||(e.session=t.session),m(t)),t.newParticipant&&!e.isAcceptNewSession&&N.broadcasterid===t.userid&&_(t),u(H)<e.maxParticipantsAllowed&&t.userid&&t.targetUser==e.userid&&t.participant&&!H[t.userid]&&T(t),t.acceptedRequestOf==e.userid&&e.onstats&&e.onstats("accepted",t),t.rejectedRequestOf==e.userid&&e.onstats&&e.onstats("rejected",t),t.customMessage)if(t.message.drop){e.ondrop(t.userid),e.attachStreams=[];for(var i in e.streams)-1==e._skip.indexOf(i)&&(i=e.streams[i],"local"==i.type?(e.detachStreams.push(i.streamid),e.onstreamended(i.streamObject)):e.onstreamended(i.streamObject));t.message.renegotiate&&e.addStream()}else e.onCustomMessage&&e.onCustomMessage(t.message);if(e.isInitiator&&t.searchingForRooms&&L.send({userid:e.userid,extra:e.extra,sessionDescription:e.sessionDescription,responseFor:t.userid}),t.sessionDescription&&t.responseFor==e.userid){var n=t.sessionDescription;e.stats.sessions[n.sessionid]||(e.stats.numberOfSessions++,e.stats.sessions[n.sessionid]=n)}e.isInitiator&&t.askToShareParticipants&&e.shareParticipants({shareWith:t.userid}),t.shareWith==e.userid&&t.dontShareWith!=e.userid&&t.joinUsers&&$(t.joinUsers),!t.shareWith&&t.joinUsers&&t.dontShareWith&&e.userid!=t.dontShareWith&&$(t.joinUsers)}},callback:function(e){e&&(L=e),S&&S()},onopen:function(e){e&&(L=e),S&&S()}});L&&S&&setTimeout(S,2e3),this.initSession=function(t){function i(){L&&u(H)<e.maxParticipantsAllowed&&!N.isOwnerLeaving&&L.send(e.sessionDescription),e.transmitRoomOnce||N.isOwnerLeaving||setTimeout(i,e.interval||3e3)}N.isOwnerLeaving=!1,C(),H={},N.isOwnerLeaving=!1,"undefined"!=typeof t.transmitRoomOnce&&(e.transmitRoomOnce=t.transmitRoomOnce),t.dontTransmit||i()},this.joinSession=function(t){if(!L)return setTimeout(function(){j("Default-Socket is not yet initialized."),N.joinSession(t)},1e3);t=t||{},H={},e.dontOverrideSession||(e.session=t.session||{}),N.broadcasterid=t.userid,t.sessionid&&(e.sessionid=t.sessionid),e.isAcceptNewSession=!1;var i=r();y({channel:i,extra:t.extra||{},userid:t.userid}),L.send({participant:!0,userid:e.userid,channel:i,targetUser:t.userid,extra:e.extra,session:e.session})},this.send=function(t,i){if(t=JSON.stringify({extra:e.extra,userid:e.userid,data:t}),i)return void("open"==i.readyState&&i.send(t));for(var n in e.channels){var s=e.channels[n].channel;"open"==s.readyState&&s.send(t)}},this.leave=function(t){x(t),e.refresh()},this.addStream=function(t){function i(i){var s=i.socket;if(!s)return void j(i,"doesn't has socket.");if(v(s),!i||!i.peer)throw"No peer to renegotiate.";var o=i.peer;return t.stream&&(o.attachStreams=[t.stream]),b(e.detachStreams,o.connection),t.stream&&(n.audio||n.video||n.screen)&&(E||P&&!o.connection.getLocalStreams().length)&&o.connection.addStream(t.stream),P||"gecko"==i.targetBrowser?i.redial():void o.recreateOffer(n,function(t,i){w({sdp:t,socket:s,renegotiate:n,labels:e.detachStreams,streaminfo:i}),e.detachStreams=[]})}var n=t.renegotiate;if(e.renegotiatedSessions[JSON.stringify(t.renegotiate)]||(e.renegotiatedSessions[JSON.stringify(t.renegotiate)]={session:t.renegotiate,stream:t.stream}),t.socket)i(e.peers[t.socket.userid]);else for(var s in e.peers)i(e.peers[s])},e.request=function(t,i){e.captureUserMedia(function(){y({channel:e.userid,extra:i||{},userid:t}),L.send({participant:!0,userid:e.userid,extra:e.extra||{},targetUser:t})})},e.sendCustomMessage=function(t){return L?void L.send({userid:e.userid,customMessage:!0,message:t}):setTimeout(function(){e.sendMessage(t)},1e3)},e.accept=function(t){arguments.length>1&&"string"==typeof arguments[0]&&(t={},arguments[0]&&(t.userid=arguments[0]),arguments[1]&&(t.extra=arguments[1]),arguments[2]&&(t.channel=arguments[2])),e.captureUserMedia(function(){I(t)})}}function t(){return{create:function(e,t){p(this,t);var i=this;return this.type=e,this.init(),this.attachMediaStreams(),a(this.session)&&P&&navigator.mozGetUserMedia({audio:!0,fake:!0},function(t){i.connection.addStream(t),"offer"==e&&i.createDataChannel(),i.getLocalDescription(e),"answer"==e&&i.createDataChannel()},this.onMediaError),!a(this.session)&&P&&(this.session.data&&"offer"==e&&this.createDataChannel(),this.getLocalDescription(e),this.session.data&&"answer"==e&&this.createDataChannel()),E&&i.getLocalDescription(e),this},getLocalDescription:function(e){A("peer type is",e),"answer"==e&&this.setRemoteDescription(this.offerDescription);var t=this;this.connection["offer"==e?"createOffer":"createAnswer"](function(e){e.sdp=t.serializeSdp(e.sdp),t.connection.setLocalDescription(e),t.trickleIce&&t.onSessionDescription(e,t.streaminfo)},this.onSdpError,this.constraints)},serializeSdp:function(e){if(e=this.setBandwidth(e),"both"==this.holdMLine)this.hold?(this.prevSDP=e,e=e.replace(/sendonly|recvonly|sendrecv/g,"inactive")):this.prevSDP&&(e=this.prevSDP);else if("audio"==this.holdMLine||"video"==this.holdMLine){e=e.split("m=");var t="",i="";e[1]&&0==e[1].indexOf("audio")&&(t="m="+e[1]),e[2]&&0==e[2].indexOf("audio")&&(t="m="+e[2]),e[1]&&0==e[1].indexOf("video")&&(i="m="+e[1]),e[2]&&0==e[2].indexOf("video")&&(i="m="+e[2]),"audio"==this.holdMLine&&(this.hold?(this.prevSDP=e[0]+t+i,e=e[0]+t.replace(/sendonly|recvonly|sendrecv/g,"inactive")+i):this.prevSDP&&(e=this.prevSDP)),"video"==this.holdMLine&&(this.hold?(this.prevSDP=e[0]+t+i,e=e[0]+t+i.replace(/sendonly|recvonly|sendrecv/g,"inactive")):this.prevSDP&&(e=this.prevSDP))}return e},init:function(){function e(){t.onSessionDescription(t.connection.localDescription,t.streaminfo)}this.setConstraints(),this.connection=new b(this.iceServers,this.optionalArgument),this.session.data&&E&&this.createDataChannel(),this.connection.onicecandidate=function(i){return i.candidate?void(t.trickleIce&&t.onicecandidate(i.candidate)):void(t.trickleIce||e())},this.connection.ongatheringchange=function(){A("iceGatheringState",t.connection.iceGatheringState),t.trickleIce||"complete"==t.connection.iceGatheringState&&e()},this.connection.onaddstream=function(e){t.onaddstream(e.stream,t.session),A("onaddstream",d(e.stream))},this.connection.onremovestream=function(e){t.onremovestream(e.stream)},this.connection.onsignalingstatechange=function(){t.connection&&t.oniceconnectionstatechange({iceConnectionState:t.connection.iceConnectionState,iceGatheringState:t.connection.iceGatheringState,signalingState:t.connection.signalingState})},this.connection.oniceconnectionstatechange=function(){t.connection&&t.oniceconnectionstatechange({iceConnectionState:t.connection.iceConnectionState,iceGatheringState:t.connection.iceGatheringState,signalingState:t.connection.signalingState})};var t=this},setBandwidth:function(e){if(I||P||!this.bandwidth)return e;var t=this.bandwidth;return this.session.screen&&(t.screen?t.screen<300&&j("It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail."):j("It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.")),t.screen&&this.session.screen&&(e=e.replace(/b=AS([^\r\n]+\r\n)/g,""),e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+t.screen+"\r\n")),(t.audio||t.video||t.data)&&(e=e.replace(/b=AS([^\r\n]+\r\n)/g,"")),t.audio&&(e=e.replace(/a=mid:audio\r\n/g,"a=mid:audio\r\nb=AS:"+t.audio+"\r\n")),t.video&&(e=e.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:"+(t.screen||t.video)+"\r\n")),t.data&&!this.preferSCTP&&(e=e.replace(/a=mid:data\r\n/g,"a=mid:data\r\nb=AS:"+t.data+"\r\n")),e
},setConstraints:function(){this.constraints={optional:this.sdpConstraints.optional||[{VoiceActivityDetection:!1}],mandatory:this.sdpConstraints.mandatory||{OfferToReceiveAudio:!!this.session.audio,OfferToReceiveVideo:!!this.session.video||!!this.session.screen}},this.session.data&&P&&this.constraints.mandatory&&(this.constraints.mandatory.OfferToReceiveAudio=!0),this.constraints.mandatory&&A("sdp-mandatory-constraints",d(this.constraints.mandatory)),this.constraints.optional&&A("sdp-optional-constraints",d(this.constraints.optional)),this.optionalArgument={optional:this.optionalArgument.optional||[{DtlsSrtpKeyAgreement:!0}],mandatory:this.optionalArgument.mandatory||{}},E&&M>=32&&!O&&(this.optionalArgument.optional.push({googIPv6:!0}),this.optionalArgument.optional.push({googDscp:!0}),this.optionalArgument.optional.push({googImprovedWifiBwe:!0})),this.preferSCTP||this.optionalArgument.optional.push({RtpDataChannels:!0}),A("optional-argument",d(this.optionalArgument.optional)),this.iceServers="undefined"!=typeof this.iceServers?{iceServers:this.iceServers}:null,A("ice-servers",d(this.iceServers.iceServers))},onSdpError:function(e){var t=d(e);t&&-1!=t.indexOf("RTP/SAVPF Expects at least 4 fields")&&(t="It seems that you are trying to interop RTP-datachannels with SCTP. It is not supported!"),D("onSdpError:",t)},onMediaError:function(e){D(d(e))},setRemoteDescription:function(e){if(!e)throw"Remote session description should NOT be NULL.";A("setting remote description",e.type,e.sdp),this.connection.setRemoteDescription(new w(e))},addIceCandidate:function(e){var t=new _({sdpMLineIndex:e.sdpMLineIndex,candidate:e.candidate});this.connection.addIceCandidate(t)},createDataChannel:function(e){this.channels||(this.channels=[]);var t={};this.dataChannelDict&&(t=this.dataChannelDict),E&&!this.preferSCTP&&(t.reliable=!1),A("dataChannelDict",d(t)),P&&(this.connection.onconnection=function(){i.socket&&i.socket.send({userid:i.selfUserid,isCreateDataChannel:!0})}),("answer"==this.type||P)&&(this.connection.ondatachannel=function(e){i.setChannelEvents(e.channel)}),(E&&"offer"==this.type||P)&&this.setChannelEvents(this.connection.createDataChannel(e||"channel",t));var i=this},setChannelEvents:function(e){var t=this;e.onmessage=function(e){t.onmessage(e.data)};var i=0;e.onopen=function(){e.push=e.send,e.send=function(t){if("open"!=e.readyState)return i++,setTimeout(function(){if(!(20>i))throw"Number of times exceeded to wait for WebRTC data connection to be opened.";e.send(t)},1e3);try{e.push(t)}catch(n){if(i++,j("Data transmission failed. Re-transmitting..",i,d(n)),i>=20)throw"Number of times exceeded to resend data packets over WebRTC data channels.";setTimeout(function(){e.send(t)},100)}},t.onopen(e)},e.onerror=function(e){t.onerror(e)},e.onclose=function(e){t.onclose(e)},this.channels.push(e)},attachMediaStreams:function(){for(var e=this.attachStreams,t=0;t<e.length;t++)A("attaching stream:",e[t].streamid),this.connection.addStream(e[t]);this.getStreamInfo()},getStreamInfo:function(){this.streaminfo="";for(var e=this.attachStreams,t=0;t<e.length;t++)0==t?this.streaminfo=e[t].streamid:this.streaminfo+="----"+e[t].streamid;this.attachStreams=[]},recreateOffer:function(e,t){A("recreating offer"),this.type="offer",this.renegotiate=!0,this.session=e,this.setConstraints(),this.onSessionDescription=t,this.getStreamInfo(),this.session.data&&E&&this.createDataChannel(),this.getLocalDescription("offer")},recreateAnswer:function(e,t,i){A("recreating answer"),this.type="answer",this.renegotiate=!0,this.session=t,this.setConstraints(),this.onSessionDescription=i,this.offerDescription=e,this.getStreamInfo(),this.session.data&&E&&this.createDataChannel(),this.getLocalDescription("answer")}}}function i(e){function t(t,n,s){s||(s=r());var o=e.video;o&&(o[P?"mozSrcObject":"src"]=P?t:window.webkitURL.createObjectURL(t),o.play()),e.onsuccess(t,n,m,s),k.streams[m]={stream:t,streamid:s},k.mutex=!1,k.queueRequests.length&&i(k.queueRequests.shift())}if(k.mutex===!0)return void k.queueRequests.push(e);k.mutex=!0;var n=e.connection,s=e.mediaConstraints||{},o=navigator,a=e.constraints||{audio:!0,video:x};1==a.video&&(a.video=x),"undefined"!=typeof s.audio&&(a.audio=s.audio),"undefined"!=typeof s.video&&a.video&&(a.video=p(a.video,s.video));var u=e.media;if(E){var h={};if(u.minWidth&&(h.minWidth=u.minWidth),u.minHeight&&(h.minHeight=u.minHeight),u.maxWidth&&(h.maxWidth=u.maxWidth),u.maxHeight&&(h.maxHeight=u.maxHeight),u.minAspectRatio&&(h.minAspectRatio=u.minAspectRatio),h.minWidth&&h.minHeight){var f=["1920:1080","1280:720","960:720","640:360","640:480","320:240","320:180"];(-1==f.indexOf(h.minWidth+":"+h.minHeight)||-1==f.indexOf(h.maxWidth+":"+h.maxHeight))&&D('The min/max width/height constraints you passed "seems" NOT supported.',d(h)),(h.minWidth>h.maxWidth||h.minHeight>h.maxHeight)&&D("Minimum value must not exceed maximum value.",d(h)),h.minWidth>=1280&&h.minHeight>=720&&j("Enjoy HD video! min/"+h.minWidth+":"+h.minHeight+", max/"+h.maxWidth+":"+h.maxHeight)}a.video.mandatory=p(a.video.mandatory,h)}s.mandatory&&(a.video.mandatory=p(a.video.mandatory,s.mandatory)),s.optional&&(a.video.optional[0]=p({},s.optional)),a.video.mandatory&&!l(a.video.mandatory)&&n._mediaSources.video&&(a.video.optional.forEach(function(e,t){e.sourceId==n._mediaSources.video&&delete a.video.optional[t]}),a.video.optional=c(a.video.optional),a.video.optional.push({sourceId:n._mediaSources.video})),a.audio.mandatory&&!l(a.audio.mandatory)&&n._mediaSources.audio&&(a.audio.optional.forEach(function(e,t){e.sourceId==n._mediaSources.audio&&delete a.audio.optional[t]}),a.audio.optional=c(a.audio.optional),a.audio.optional.push({sourceId:n._mediaSources.audio})),a.video&&a.video.optional&&a.video.mandatory&&!a.video.optional.length&&l(a.video.mandatory)&&(a.video=!0),A("media hints:",d(a));var m=JSON.stringify(a);k.streams[m]?t(k.streams[m].stream,!0,k.streams[m].streamid):(o.getMedia=o.webkitGetUserMedia||o.mozGetUserMedia,o.getMedia(a,t,function(t){e.onerror?e.onerror(t,m):D(d(t))}))}function n(e){function t(t){var o=t.uuid;if("undefined"!=typeof t.packets&&(s[o]=n[o]=parseInt(t.packets),t.sending=!1,e.onFileStart(t)),e.onFileProgress({remaining:n[o]--,length:s[o],received:s[o]-n[o],maxChunks:s[o],uuid:o,currentPosition:s[o]-n[o],sending:!1},o),i[o]||(i[o]=[]),i[o].push(t.message),t.last){var r=i[o].join("");C.DataURLToBlob(r,t.fileType,function(n){n.uuid=o,n.name=t.name,n.type=t.fileType,n.url=(window.URL||window.webkitURL).createObjectURL(n),n.sending=!1,n.userid=t.userid||e.userid,n.extra=t.extra||e.extra,e.onFileEnd(n),e.autoSaveToDisk&&$.SaveToDisk(n.url,t.name),delete i[o]})}}var i={},n={},s={};return{receive:t}}function s(e){function t(t,n,s){var o=t.uuid;if(i[o]||(i[o]=[]),i[o].push(t.message),t.last){var r=i[o].join("");t.isobject&&(r=JSON.parse(r));var a=(new Date).getTime(),l=a-t.sendingTime,c={data:r,userid:n,extra:s,latency:l};r.preRecordedMediaChunk?(e.preRecordedMedias[r.streamerid]||e.shareMediaFile(null,null,r.streamerid),e.preRecordedMedias[r.streamerid].onData(r.chunk)):e.autoTranslateText?(c.original=c.data,e.Translator.TranslateText(c.data,function(t){c.data=t,e.onmessage(c)})):r.isPartOfScreen?e.onpartofscreen(r):e.onmessage(c),delete i[o]}}var i={};return{receive:t}}function o(e){var t=e.connection,i=e.context;this.context=i,this.volume=0,this.slow_volume=0,this.clip=0,this.script=i.createScriptProcessor(256,1,1),that=this,this.script.onaudioprocess=function(i){var n,s=i.inputBuffer.getChannelData(0),o=0,r=0;for(n=0;n<s.length;++n)o+=s[n]*s[n],Math.abs(s[n])>.99&&(r+=1);that.volume=Math.sqrt(o/s.length);var a=that.volume.toFixed(2);a>=.1&&t.onspeaking&&t.onspeaking(e.event),.1>a&&t.onsilence&&t.onsilence(e.event)}}function r(){return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}function a(e){return!e.audio&&!e.video&&!e.screen&&e.data}function l(e){var t=0;for(var i in e)t++;return 0==t}function c(e){for(var t=[],i=e.length,n=0;i>n;n++)e[n]&&e[n]!==!0&&t.push(e[n]);return t}function d(e){return JSON.stringify(e,function(e,t){return t&&t.sdp?(A(t.sdp.type,"	",t.sdp.sdp),""):t},"	")}function u(e){var t=0;for(var i in e)i&&t++;return t}function h(e,t){var i=t.audio&&!t.video&&!t.screen;E&&e.getAudioTracks&&e.getVideoTracks&&(i=e.getAudioTracks().length&&!e.getVideoTracks().length);var n=document.createElement(i?"audio":"video");return n[P?"mozSrcObject":"src"]=P?e:window.webkitURL.createObjectURL(e),n.controls=!0,n.autoplay=!!t.remote,n.muted=t.remote?!1:!0,n.play(),n}function p(e,t){if(e||(e={}),!t)return e;for(var i in t)e[i]=t[i];return e}function f(e,t){var i=document.createElement("script");i.src=e,t&&(i.onload=t),document.documentElement.appendChild(i)}function m(e){var t=e.stream,i=e.root,n=e.session||{},s=e.enabled;if(n.audio||n.video||(n="string"!=typeof n?p(n,{audio:!0,video:!0}):{audio:!0,video:!0}),n.type){if("remote"==n.type&&"remote"!=i.type)return;if("local"==n.type&&"local"!=i.type)return}if(A(s?"mute":"unmute","session",n),n.audio){var o=t.getAudioTracks()[0];o&&(o.enabled=!s)}if(n.video){var r=t.getVideoTracks()[0];r&&(r.enabled=!s)}i.sockets.forEach(function(e){"local"==i.type&&e.send({userid:i.rtcMultiConnection.userid,streamid:i.streamid,mute:!!s,unmute:!s,session:n}),"remote"==i.type&&e.send({userid:i.rtcMultiConnection.userid,promptMuteUnmute:!0,streamid:i.streamid,mute:!!s,unmute:!s,session:n})});var a=p({},i.streamObject);a.session=n,a.isAudio=n.audio&&!n.video,a.isVideo=!n.audio&&n.video||n.audio&&n.video,s&&i.rtcMultiConnection.onmute(a),s||i.rtcMultiConnection.onunmute(a)}function g(e){if((!e.getAudioTracks||!e.getVideoTracks)&&e.stop)return void e.stop();var t,i=!1,n=e.getAudioTracks(),s=e.getVideoTracks();for(t=0;t<n.length;t++)if(n[t].stop)try{n[t].stop()}catch(o){i=!0;continue}else i=!0;for(t=0;t<s.length;t++)if(s[t].stop)try{s[t].stop()}catch(o){i=!0;continue}else i=!0;i&&e.stop&&e.stop()}function v(e){function t(t){function i(t){function i(){o=new window.FileReader,o.onload=function(t){s.push(new window.Uint8Array(t.target.result)),r+=a,n>=r?setTimeout(i,e.chunkInterval||100):s.push({end:!0})},o.readAsArrayBuffer(t.slice(r,r+a))}if(t){var n=t.size,r=0,a=3e3;A("one chunk size: <",a,">"),i()}}if(!s.push)throw"<push> method is mandatory.";var o=new window.FileReader;o.readAsArrayBuffer(t),o.onload=function(e){i(new window.Blob([new window.Uint8Array(e.target.result)]))};var r,a=new MediaSource;a.addEventListener(n+"sourceopen",function(){r=a.addSourceBuffer('video/webm; codecs="vorbis,vp8"'),A("MediaSource readyState: <",this.readyState,">")},!1),a.addEventListener(n+"sourceended",function(){A("MediaSource readyState: <",this.readyState,">")},!1),i()}function i(){var e=new MediaSource;s.video.src=window.URL.createObjectURL(e),e.addEventListener(n+"sourceopen",function(){s.receiver=e.addSourceBuffer('video/webm; codecs="vorbis,vp8"'),s.mediaSource=e,A("MediaSource readyState: <",this.readyState,">")},!1),e.addEventListener(n+"sourceended",function(){j("MediaSource readyState: <",this.readyState,">")},!1)}var n=navigator.webkitGetUserMedia?"":"moz",s=this;if(s.stream=t,window.MediaSource=window.MediaSource||window.WebKitMediaSource,!window.MediaSource)throw'Chrome >=M28 (or Firefox with flag "media.mediasource.enabled=true") is mandatory to test this experiment.';s.receive=i,this.append=function(e){var t=this;if(!s.receiver)return setTimeout(function(){t.append(e)});try{var i=new window.Uint8Array(e);s.receiver.appendBuffer(i)}catch(n){D("Pre-recorded media streaming:",n)}},this.end=function(){s.mediaSource.endOfStream()}}function y(e){function t(e,t){if(-1!=e.position){var i=+e.position.toFixed(2).split(".")[1]||100;t.innerHTML=i+"%"}}e.onmessage=function(e){A("onmessage",d(e))},e.onopen=function(e){A("Data connection is opened between you and",e.userid)},e.onerror=function(e){D(onerror,d(e))},e.onclose=function(e){j("onclose",d(e))};var i={};e.body=document.body||document.documentElement,e.autoSaveToDisk=!1,e.onFileStart=function(t){var n=document.createElement("div");n.title=t.name,n.innerHTML="<label>0%</label> <progress></progress>",e.body.insertBefore(n,e.body.firstChild),i[t.uuid]={div:n,progress:n.querySelector("progress"),label:n.querySelector("label")},i[t.uuid].progress.max=t.maxChunks},e.onFileProgress=function(e){var n=i[e.uuid];n&&(n.progress.value=e.currentPosition||e.maxChunks||n.progress.max,t(n.progress,n.label))},e.onFileEnd=function(t){i[t.uuid]&&(i[t.uuid].div.innerHTML='<a href="'+t.url+'" target="_blank" download="'+t.name+'">'+t.name+"</a>"),(e.onFileSent||e.onFileReceived)&&(j('Now, "autoSaveToDisk" is false. Read more here: http://www.RTCMultiConnection.org/docs/autoSaveToDisk/'),e.onFileSent&&e.onFileSent(t,t.uuid),e.onFileReceived&&e.onFileReceived(t.name,t))},e.dontAttachStream=!1,e.onstream=function(e){videosContainer=document.getElementById("videos-container"),video_in_div=document.createElement("div"),video_in_div.setAttribute("class","stream"),videosContainer.insertBefore(video_in_div,videosContainer.firstChild),video_in_div.insertBefore(e.mediaElement,video_in_div.firstChild)},e.onstreamended=function(e){e.mediaElement&&e.mediaElement.parentNode&&e.mediaElement.parentNode.removeChild(e.mediaElement)},e.onmute=function(e){A("onmute",e),e.isVideo&&e.mediaElement&&(e.mediaElement.pause(),e.mediaElement.setAttribute("poster",e.snapshot||"https://www.webrtc-experiment.com/images/muted.png")),e.isAudio&&e.mediaElement&&(e.mediaElement.muted=!0)},e.onunmute=function(e){A("onunmute",e),e.isVideo&&e.mediaElement&&(e.mediaElement.play(),e.mediaElement.removeAttribute("poster")),e.isAudio&&e.mediaElement&&(e.mediaElement.muted=!1)},e.onleave=function(e){A("onleave",d(e))},e.token=function(){if(window.crypto){for(var e=window.crypto.getRandomValues(new Uint32Array(3)),t="",i=0,n=e.length;n>i;i++)t+=e[i].toString(36);return t}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")},e.userid=e.token(),e.peers={},e.peers[e.userid]={drop:function(){e.drop()},renegotiate:function(){},addStream:function(){},hold:function(){},unhold:function(){},changeBandwidth:function(){},sharePartOfScreen:function(){}},e._skip=["stop","mute","unmute","_private"],e.streams={mute:function(e){this._private(e,!0)},unmute:function(e){this._private(e,!1)},_private:function(t,i){for(var n in this)-1==e._skip.indexOf(n)&&this[n]._private(t,i)},stop:function(e){var t;for(var i in this)"stop"!=i&&"mute"!=i&&"unmute"!=i&&"_private"!=i&&(t=this[i],e||t.stop(),"local"==e&&"local"==t.type&&t.stop(),"remote"==e&&"remote"==t.type&&t.stop())}},e.renegotiatedSessions={},e.channels={},e.extra={},e.session={audio:!0,video:!0},e.bandwidth={screen:300},e.sdpConstraints={},e.mediaConstraints={},e.optionalArgument={},e.dataChannelDict={};var n=[];P&&(n.push({url:"stun:23.21.150.121"}),n.push({url:"stun:stun.services.mozilla.com"})),E&&(n.push({url:"stun:stun.l.google.com:19302"}),n.push({url:"stun:stun.anyfirewall.com:3478"})),E&&28>M&&(n.push({url:"turn:homeo@turn.bistri.com:80?transport=udp",credential:"homeo"}),n.push({url:"turn:homeo@turn.bistri.com:80?transport=tcp",credential:"homeo"})),E&&M>=28&&(n.push({url:"turn:turn.bistri.com:80?transport=udp",credential:"homeo",username:"homeo"}),n.push({url:"turn:turn.bistri.com:80?transport=tcp",credential:"homeo",username:"homeo"}),n.push({url:"turn:turn.anyfirewall.com:443?transport=tcp",credential:"webrtc",username:"webrtc"})),e.iceServers=n,e.preferSCTP=P||M>=32?!0:!1,e.chunkInterval=P||M>=32?100:500,e.chunkSize=P||M>=32?13e3:1e3,P&&(e.preferSCTP=!0),e.fakeDataChannels=!1,e.UA={Firefox:P,Chrome:E,Mobile:I,Version:M,NodeWebkit:O},e.fileQueue={},e.media={min:function(e,t){this.minWidth=e,this.minHeight=t},max:function(e,t){this.maxWidth=e,this.maxHeight=t}},e.candidates={host:!0,relay:!0,reflexive:!0},e.attachStreams=[],e.detachStreams=[],e.maxParticipantsAllowed=256,e.direction="many-to-many",e._getStream=function(e){return{rtcMultiConnection:e.rtcMultiConnection,streamObject:e.streamObject,stream:e.stream,session:e.session,userid:e.userid,streamid:e.streamid,sockets:e.socket?[e.socket]:[],type:e.type,mediaElement:e.mediaElement,stop:function(e){this.sockets.forEach(function(t){"local"==this.type&&t.send({userid:this.rtcMultiConnection.userid,extra:this.rtcMultiConnection.extra,streamid:this.streamid,stopped:!0}),"remote"==this.type&&e&&t.send({userid:this.rtcMultiConnection.userid,promptStreamStop:!0,streamid:this.streamid})});var t=this.stream;t&&t.stop&&g(t)},mute:function(e){this.muted=!0,this._private(e,!0)},unmute:function(e){this.muted=!1,this._private(e,!1)},_private:function(e,t){m({root:this,session:e,enabled:t,stream:this.stream})},startRecording:function(e){if(e||(e={audio:!0,video:!0}),P&&(e={audio:!0}),!window.RecordRTC){var t=this;return f("https://www.webrtc-experiment.com/RecordRTC.js",function(){t.startRecording(e)})}this.recorder=new MRecordRTC,this.recorder.mediaType=e,this.recorder.addStream(this.stream),this.recorder.startRecording()},stopRecording:function(e){this.recorder.stopRecording(),this.recorder.getBlob(function(t){e(t.audio||t.video,t.video)})}}},e.set=function(e){for(var t in e)this[t]=e[t];return this},e.firebase="chat",e.onMediaError=function(e){D(e)},e.stats={numberOfConnectedUsers:0,numberOfSessions:0,sessions:{}},e.getStats=function(t){var i=0;for(var n in e.peers)i++;e.stats.numberOfConnectedUsers=i,t&&t(e.stats)},e.caniuse={RTCPeerConnection:R.isWebRTCSupported,getUserMedia:!!navigator.webkitGetUserMedia||!!navigator.mozGetUserMedia,AudioContext:R.isAudioContextSupported,ScreenSharing:R.isScreenCapturingSupported,checkIfScreenSharingFlagEnabled:function(e){function t(t){t.stop&&t.stop(),e&&e(!0)}function i(){s=!0,e&&e(r>5,n)}var n;if(P&&(n="Screen sharing is NOT supported on Firefox.",D(n),e&&e(!1)),"https:"!==location.protocol&&(n="Screen sharing is NOT supported on "+location.protocol+" Try https!",D(n),e))return e(!1);26>M&&(n="Screen sharing support is suspicious!",j(n));var s,o={video:{mandatory:{chromeMediaSource:"screen"}}},r=0;!function a(){r++,s||setTimeout(a,10)}(),navigator.webkitGetUserMedia(o,t,i)},RtpDataChannels:R.isRtpDataChannelsSupported,SctpDataChannels:R.isSctpDataChannelsSupported},e.snapshots={},e.takeSnapshot=function(t,i){for(var n in e.streams)if(n=e.streams[n],n.userid==t&&n.stream&&n.stream.getVideoTracks&&n.stream.getVideoTracks().length){var s=n.streamObject.mediaElement,o=document.createElement("canvas");o.width=s.videoWidth||s.clientWidth,o.height=s.videoHeight||s.clientHeight;var r=o.getContext("2d");r.drawImage(s,0,0,o.width,o.height),e.snapshots[t]=o.toDataURL(),i&&i(e.snapshots[t])}else;},e.saveToDisk=function(e,t){e.size&&e.type?$.SaveToDisk(URL.createObjectURL(e),t||e.name||e.type.replace("/","-")+e.type.split("/")[1]):$.SaveToDisk(e,t)},e._mediaSources={},e.selectDevices=function(t,i){function n(t){t&&(e._mediaSources[t.kind]=t.id)}t&&n(this.devices[t]),i&&n(this.devices[i])},e.devices={},e.getDevices=function(t){function i(t){var o=t[n];if(o){if(s[o.id])return n++,i(t);s[o.id]=o,e.devices[o.id]=o,n++,i(t)}}if(!window.MediaStreamTrack&&!navigator.getMediaDevices)return t(e.devices);if(!window.MediaStreamTrack&&navigator.getMediaDevices&&(window.MediaStreamTrack={}),MediaStreamTrack.getSources||(MediaStreamTrack.getSources=MediaStreamTrack.getMediaDevices),!MediaStreamTrack.getSources&&navigator.getMediaDevices&&(MediaStreamTrack.getSources=navigator.getMediaDevices.bind(navigator)),!MediaStreamTrack.getSources)return t(e.devices);MediaStreamTrack.getSources(function(n){for(var s=[],o=0;o<n.length;o++)s.push(n[o]);i(s),t&&t(e.devices)});var n=0,s={}},e.onCustomMessage=function(e){A("Custom message",e)},e.ondrop=function(e){A("Media connection is dropped by "+e)},e.drop=function(e){e=e||{},this.attachStreams=[];for(var t in this.streams)-1==this._skip.indexOf(t)&&(t=this.streams[t],"local"==t.type?(this.detachStreams.push(t.streamid),this.onstreamended(t.streamObject)):this.onstreamended(t.streamObject));this.sendCustomMessage({drop:!0,dontRenegotiate:"undefined"==typeof e.renegotiate?!0:e.renegotiate})},window.AudioContext&&(e._audioContext=new AudioContext),e.language="en",e.autoTranslateText=!1,e.googKey="AIzaSyCUmCjvKRb-kOYrnoL2xaXb8I-_JJeKpf0",e.Translator={TranslateText:function(t,i){var n=document.createElement("script");n.type="text/javascript";var s=encodeURIComponent(t),o="method"+e.token();window[o]=function(e){e.data&&e.data.translations[0]&&i&&i(e.data.translations[0].translatedText)};var r="https://www.googleapis.com/language/translate/v2?key="+e.googKey+"&target="+(e.language||"en-US")+"&callback=window."+o+"&q="+s;n.src=r,document.getElementsByTagName("head")[0].appendChild(n)}},e.setDefaultEventsForMediaElement=function(t,i){t.onpause=function(){e.streams[i]&&!e.streams[i].muted&&e.streams[i].mute()},t.onplay=function(){e.streams[i]&&e.streams[i].muted&&e.streams[i].unmute()};var n=!1;t.onvolumechange=function(){n||(n=!0,setTimeout(function(){var s=e.streams[i];e.streams[i].sockets.forEach(function(i){i.send({userid:e.userid,streamid:s.streamid,isVolumeChanged:!0,volume:t.volume})}),n=!1},2e3))}},e.localStreamids=[],e.onMediaFile=function(t){A("onMediaFile",t),e.body.appendChild(t.mediaElement)},e.preRecordedMedias={},e.shareMediaFile=function(t,i,n){if(t&&("undefined"==typeof t.size||"undefined"==typeof t.type))throw"You MUST attach file using input[type=file] or pass a Blob.";j("Pre-recorded media streaming is added as experimental feature."),i=i||document.createElement("video"),i.autoplay=!0,i.controls=!0,n=n||e.token();var s=new v(this);return s.push=function(t){e.send({preRecordedMediaChunk:!0,chunk:t,streamerid:n})},t&&s.stream(t),s.video=i,s.receive(),e.preRecordedMedias[n]={video:i,streamer:s,onData:function(e){e.end?this.streamer.end():this.streamer.append(e)}},e.onMediaFile({mediaElement:i,userid:e.userid,extra:e.extra}),n},e.onpartofscreen=function(t){var i=document.createElement("img");i.src=t.screenshot,e.body.appendChild(i)},e.skipLogs=function(){A=D=j=function(){}},e.hold=function(t){for(var i in e.peers)e.peers[i].hold(t)},e.onhold=function(e){A("onhold",e),"audio"!=e.kind&&(e.mediaElement.pause(),e.mediaElement.setAttribute("poster",e.screenshot||"https://www.webrtc-experiment.com/images/muted.png")),"audio"==e.kind&&(e.mediaElement.muted=!0)},e.unhold=function(t){for(var i in e.peers)e.peers[i].unhold(t)},e.onunhold=function(e){A("onunhold",e),"audio"!=e.kind&&(e.mediaElement.play(),e.mediaElement.removeAttribute("poster")),"audio"!=e.kind&&(e.mediaElement.muted=!1)},e.sharePartOfScreen=function(t){for(var i in e.peers)e.peers[i].sharePartOfScreen(t)},e.pausePartOfScreenSharing=function(){for(var t in e.peers)e.peers[t].pausePartOfScreenSharing=!0},e.stopPartOfScreenSharing=function(){for(var t in e.peers)e.peers[t].stopPartOfScreenSharing=!0},e.takeScreenshot=function(t,i){if(!t||!i)throw"Invalid number of arguments.";if(!window.html2canvas)return f("https://www.webrtc-experiment.com/screenshot.js",function(){e.takeScreenshot(t)});if("string"==typeof t&&(t=document.querySelector(t),t||(t=document.getElementById(t))),!t)throw"HTML Element is inaccessible!";html2canvas(t,{onrendered:function(e){i(e.toDataURL())}})},e.autoReDialOnFailure=!1,e.isInitiator=!1,e.DetectRTC=R,e.trickleIce=!0}window.RTCMultiConnection=function(t){function n(e){if(u.openSignalingChannel)return e();if(!window.Firebase)return f("https://www.webrtc-experiment.com/firebase.js",function(){n(e)});var i={},s=new Firebase("https://"+u.firebase+".firebaseio.com/"+u.channel);s.on("child_added",function(e){var t=e.val();t.sender!=u.userid&&(i[t.channel]&&i[t.channel](t.message),e.ref().remove())}),u.openSignalingChannel=function(e){var n=e.channel||u.channel;return i[n]=e.onmessage,e.onopen&&setTimeout(e.onopen,1e3),{send:function(e){s.push({sender:u.userid,channel:n,message:e})},channel:t}},e()}function s(t){return p?t():void(p=new e(u,t))}function r(e){if(!p)return A("Signaling channel is not ready. Connecting..."),void n(function(){s(function(){A("Signaling channel is connected. Joining the session again..."),setTimeout(function(){r(e)},1e3)})});if("string"==typeof e){if(!u.stats.sessions[e])return setTimeout(function(){A("Session-Descriptions not found. Rechecking.."),r(e)},1e3);e=u.stats.sessions[e]}if(!e||!e.userid||!e.sessionid)throw'invalid data passed over "join" method';u.dontOverrideSession||(u.session=e.session),extra=u.extra||e.extra||{},e.oneway||a(e)?p.joinSession(e,extra):c(function(){p.joinSession(e,extra)})}function c(e,t){function n(e,t,n){var a={onsuccess:function(e,i,r,a){n&&E&&(e=new window.webkitMediaStream(e.getAudioTracks())),u.localStreamids.push(a),e.onended=function(){u.onstreamended(c);var e=u.streams[a];e&&e.sockets.length&&e.sockets.forEach(function(t){t.send({streamid:e.streamid,userid:e.rtcMultiConnection.userid,extra:e.rtcMultiConnection.extra,stopped:!0})}),k.mutex=!1,k.streams[r]&&delete k.streams[r]};var l=h(e,s);l.muted=!0,e.streamid=a;var c={stream:e,streamid:a,mediaElement:l,blobURL:l.mozSrcObject||l.src,type:"local",userid:u.userid,extra:u.extra,session:s,isVideo:e.getVideoTracks().length>0,isAudio:!e.getVideoTracks().length&&e.getAudioTracks().length>0,isInitiator:!!u.isInitiator},d={stream:e,userid:u.userid,streamid:a,session:s,type:"local",streamObject:c,mediaElement:l,rtcMultiConnection:u};if(m&&u.attachStreams.push(e),m=!1,u.streams[a]=u._getStream(d),i||u.onstream(c),u.setDefaultEventsForMediaElement&&u.setDefaultEventsForMediaElement(l,a),t&&t(e,c),u.onspeaking){var p=new o({context:u._audioContext,connection:u,event:c});p.connectToSource(e)}},onerror:function(e,t){u.onMediaError(d(e)),s.audio&&u.onMediaError("Maybe microphone access is denied."),s.video&&u.onMediaError("Maybe webcam access is denied."),s.screen&&(u.onMediaError(P?"Firefox has not yet released their screen capturing modules. Still work in progress! Please try chrome for now!":"https:"!==location.protocol?"<https> is mandatory to capture screen.":'Unable to detect actual issue. Maybe "deprecated" screen capturing flag is not enabled or maybe you clicked "No" button.'),k.mutex=!1,k.streams[t]&&delete k.streams[t])},mediaConstraints:u.mediaConstraints||{}};a.constraints=e||r,a.media=u.media,a.connection=u,i(a)}var s=t||u.session;if(l(s))return void(e&&e());if(E&&s.audio&&!R.hasMicrophone&&(j("It seems that you have no microphone attached to your device/system."),s.audio=u.session.audio=!1),E&&s.video&&!R.hasWebcam&&(j("It seems that you have no webcam attached to your device/system."),s.video=u.session.video=!1),u.dontAttachStream)return e();if(a(s)||!u.isInitiator&&s.oneway)return u.attachStreams=[],e();var r={audio:!!s.audio,video:!!s.video};u._mediaSources.audio&&(r.audio={optional:[{sourceId:u._mediaSources.audio}]}),u._mediaSources.video&&(r.video={optional:[{sourceId:u._mediaSources.video}]});var c={audio:!1,video:{mandatory:{chromeMediaSource:"screen"},optional:[]}};if(s.screen){var p=m;n(c,r.audio||r.video?function(){p&&(m=!0),n(r,e)}:e)}else n(r,e,s.audio&&!s.video)}var u=this;u.channel=t||location.href.replace(/\/|:|#|%|\.|\[|\]/g,"");var p;u.isAcceptNewSession=!0,u.open=function(e){u.isAcceptNewSession=!1,u.isInitiator=!0;var t=!1;return e&&("string"==typeof e?u.sessionid=e:("undefined"!=typeof e.transmitRoomOnce&&(u.transmitRoomOnce=e.transmitRoomOnce),"undefined"!=typeof e.dontTransmit&&(t=e.dontTransmit),"undefined"!=typeof e.sessionid&&(u.sessionid=e.sessionid))),u.socket&&u.socket.remove&&u.socket.remove(),u.sessionid||(u.sessionid=u.channel),u.sessionDescription={sessionid:u.sessionid,userid:u.userid,session:u.session,extra:u.extra},u.stats.sessions[u.sessionDescription.sessionid]||(u.stats.numberOfSessions++,u.stats.sessions[u.sessionDescription.sessionid]=u.sessionDescription),n(function(){s(function(){c(function(){p.initSession({sessionDescription:u.sessionDescription,dontTransmit:t})})})}),u.sessionDescription},this.connect=function(e){return e&&(u.sessionid=e),n(function(){s(function(){A("Signaling channel is ready.")})}),this},this.join=r,this.send=function(e,t){if(!e)throw"No file, data or text message to share.";if(e.forEach)for(var i=0;i<e.length;i++)u.send(e[i],t);else"undefined"!=typeof e.size&&"undefined"!=typeof e.type?S.send({file:e,channel:p,_channel:t,connection:u}):T.send({text:e,channel:p,_channel:t,connection:u})};var m=!0;this.captureUserMedia=c,this.leave=function(e){m=!0,p.leave(e)},this.eject=function(e){if(!u.isInitiator)throw"Only session-initiator can eject a user.";u.leave(e)},this.close=function(){u.autoCloseEntireSession=!0,u.leave()},this.renegotiate=function(e,t){p.addStream({renegotiate:t||{oneway:!0,audio:!0,video:!0},stream:e})},this.addStream=function(e,t){function i(i){p.addStream({stream:i,renegotiate:e||u.session,socket:t})}if(e){var n;!u.isInitiator&&e.oneway&&(e.oneway=!1,n=!0),c(function(t){n&&(e.oneway=!0),i(t)},e)}else i()},this.removeStream=function(e){return this.streams[e]?(this.detachStreams.push(e),void this.renegotiate()):j("No such stream exists. Stream-id:",e)},y(this)};var b=window.mozRTCPeerConnection||window.webkitRTCPeerConnection,w=window.mozRTCSessionDescription||window.RTCSessionDescription,_=window.mozRTCIceCandidate||window.RTCIceCandidate,x={mandatory:{},optional:[]},k={streams:[],mutex:!1,queueRequests:[]},S={send:function(e){function t(){var e=URL.createObjectURL(new Blob(["function readFile(_file) {postMessage(new FileReaderSync().readAsDataURL(_file));};this.onmessage =  function (e) {readFile(e.data);}"],{type:"application/javascript"})),t=new Worker(e);return URL.revokeObjectURL(e),t}function i(e,t){var r={type:"file",uuid:a.uuid,maxChunks:d,currentPosition:d-u,name:a.name,fileType:a.type,size:a.size,userid:n.userid,extra:n.extra};e&&(t=e,d=u=r.packets=parseInt(t.length/l),a.maxChunks=r.maxChunks=d,r.currentPosition=d-u,a.userid=n.userid,a.extra=n.extra,a.sending=!0,n.onFileStart(a)),n.onFileProgress({remaining:u--,length:d,sent:d-u,maxChunks:d,uuid:a.uuid,currentPosition:d-u,sending:!0},a.uuid),t.length>l?r.message=t.slice(0,l):(r.message=t,r.last=!0,r.name=a.name,a.url=URL.createObjectURL(a),a.userid=n.userid,a.extra=n.extra,a.sending=!0,n.onFileEnd(a)),s.send(r,o),c=t.slice(r.message.length),c.length&&setTimeout(function(){i(null,c)},n.chunkInterval||100)}var n=e.connection,s=e.channel,o=e._channel,a=e.file;if(!e.file)return void D("You must select a file or pass Blob.");var l=navigator.mozGetUserMedia||n.preferSCTP?15e3:1e3;n.chunkSize&&(l=n.chunkSize);var c="",d=0,u=0;if(a.uuid=r(),window.Worker&&!I){var h=t();h.onmessage=function(e){i(e.data)},h.postMessage(a)}else{var p=new FileReader;p.onload=function(e){i(e.target.result)},p.readAsDataURL(a)}}},$={SaveToDisk:function(e,t){var i=document.createElement("a");i.href=e,i.target="_blank",i.download=t||e;var n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});i.dispatchEvent(n)}},C={DataURLToBlob:function(e,t,i){function n(){var e=URL.createObjectURL(new Blob(['function getBlob(_dataURL, _fileType) {var binary = atob(_dataURL.substr(_dataURL.indexOf(",") + 1)),i = binary.length,view = new Uint8Array(i);while (i--) {view[i] = binary.charCodeAt(i);};postMessage(new Blob([view], {type: _fileType}));};this.onmessage =  function (e) {var data = JSON.parse(e.data); getBlob(data.dataURL, data.fileType);}'],{type:"application/javascript"})),t=new Worker(e);return URL.revokeObjectURL(e),t}if(window.Worker&&!I){var s=n();s.onmessage=function(e){i(e.data)},s.postMessage(JSON.stringify({dataURL:e,fileType:t}))}else{for(var o=atob(e.substr(e.indexOf(",")+1)),r=o.length,a=new Uint8Array(r);r--;)a[r]=o.charCodeAt(r);i(new Blob([a]))}}},T={send:function(e){function t(e,o){var r={type:"text",uuid:d,sendingTime:u};e&&(o=e,r.packets=parseInt(o.length/a)),o.length>a?r.message=o.slice(0,a):(r.message=o,r.last=!0,r.isobject=c),n.send(r,s),l=o.slice(r.message.length),l.length&&setTimeout(function(){t(null,l)},i.chunkInterval||100)}var i=e.connection,n=e.channel,s=e._channel,o=e.text,a=i.chunkSize||1e3,l="",c=!1;"string"!=typeof o&&(c=!0,o=JSON.stringify(o));var d=r(),u=(new Date).getTime();t(o)}};o.prototype.connectToSource=function(e){this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),this.script.connect(this.context.destination)},o.prototype.stop=function(){this.mic.disconnect(),this.script.disconnect()};var E=!!navigator.webkitGetUserMedia,P=!!navigator.mozGetUserMedia,I=navigator.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|IEMobile/i),O=window.process&&"object"==typeof window.process&&window.process.versions&&window.process.versions["node-webkit"];window.MediaStream=window.MediaStream||window.webkitMediaStream,window.AudioContext=window.AudioContext||window.webkitAudioContext;var M=navigator.mozGetUserMedia?0:parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2]),A=console.log.bind(console),D=console.error.bind(console),j=console.warn.bind(console),R={};
!function(){function e(){return window.MediaStreamTrack||navigator.getMediaDevices?(!window.MediaStreamTrack&&navigator.getMediaDevices&&(window.MediaStreamTrack={}),MediaStreamTrack.getSources||(MediaStreamTrack.getSources=MediaStreamTrack.getMediaDevices),!MediaStreamTrack.getSources&&navigator.getMediaDevices&&(MediaStreamTrack.getSources=navigator.getMediaDevices.bind(navigator)),MediaStreamTrack.getSources?void MediaStreamTrack.getSources(function(e){for(var t={},i=0;i<e.length;i++)t[e[i].kind]=!0;R.hasMicrophone=t.audio,R.hasWebcam=t.video}):void(E&&(R.hasMicrophone=!0,R.hasWebcam=!0))):void 0}R.isWebRTCSupported=!!window.webkitRTCPeerConnection||!!window.mozRTCPeerConnection,R.isAudioContextSupported=!!window.AudioContext||!!window.webkitAudioContext,R.isScreenCapturingSupported=E&&M>=26&&(O?!0:"https:"==location.protocol),R.isSctpDataChannelsSupported=!!navigator.mozGetUserMedia||E&&M>=25,R.isRtpDataChannelsSupported=E&&M>=31,e()}()}(),function(){$(document).ready(function(){var e;$(".nano").nanoScroller({scroll:"bottom"}),$(".lobby-panel .nano-slider").css("background","rgba(255,255,255,.5)"),e=function(){var e;$(".list").css("height",$(".panel-default")[0].offsetTop-72),$(".list2").css("height",$("body")[0].offsetHeight-72),window.onresize=function(){var t;t=$("body")[0].offsetHeight,e===!1?$(".list").css("height",t-120):$(".list").css("height",$(".panel-default")[0].offsetTop-72),$(".list2").css("height",t-72),$(".right_search").css("height",$(".panel-default")[0].clientHeight-80)},e=!1,$(".collapsed").on("click",function(){var t,i;i=$(".right_panel")[0].clientHeight,e===!1?($(".panel-default").css("height","50%"),t=$(".panel-default")[0].clientHeight,$(".right_search ").css("height",t-118),$(".list").css("height",i/2-72),$(".right_search").css("height",$(".panel-default")[0].clientHeight-80),e=!0):($(".panel-default").css("height","auto"),$(".list").css("height",i-118),e=!1)})},$(".change-status").on("click",function(){var e,t;e=$(this)[0].text,t=e.replace(/[\n]( *) /,""),$.ajax({type:"GET",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},url:"../users/status/",dataType:"html",contentType:"text/html; charset=utf-8",data:{status:t}}).done(function(e){$("#drop1")[0].innerHTML='<span class="'+window.get_user_status_style(e)+'"></span>'+e+'<span class="glyphicon glyphicon-hand-down"></span>'})}),void 0!==location.pathname.toString().split("/")[2]&&null!=location.pathname.toString().split("/")[2].match(/^[0-9]+$/)&&e()})}.call(this),function(){$(function(){var e,t,i,n;$("#myModal").on("click","#modal-submit",function(){$("#myModal").modal("hide")}),$("#editModal").on("submit","form",function(){return $.ajax({url:"/users",type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{_method:"PUT","user[login]":$("#user_login").val(),"user[firstname]":$("#user_firstname").val(),"user[lastname]":$("#user_lastname").val(),"user[email]":$("#user_email").val(),"user[password]":$("#user_password").val(),"user[password_confirmation]":$("#user_password_confirmation").val(),"user[current_password]":$("#user_current_password").val()},success:function(e){var t,i,n,s,o,r,a,l,c,d;if(i=$("#error_explanation"),i.html(""),i.show(),-1!==e.indexOf('<div id="error_explanation">'))for(a=e.match("<ul><li>.+</li></ul>"),n=a.toString().replace("</li>","\n").replace(/(<([^>]+)>)/gi,"").split("\n"),c=0,d=n.length;d>c;c++)t=n[c],i.append(t+"<br>");else s=e.match(/gon.user_login=\"[a-zA-Z0-9\.\-_]+\"/).toString(),o=s.match(/\"[a-zA-Z0-9\.\-_]+\"/).toString().replace(/"/g,""),l=$(".current_user_login"),l.html(o),$("#user_name").html($("#user_firstname").val()+$("#user_lastname").val()),r="/persons/"+o.toString(),$(".user_name").html('<a href="'+r+'">'+$("#user_firstname").val()+" "+$("#user_lastname").val()+"</a>"),$(i).hide(),$("#editModal").modal("hide")}}),!1}),$("#editModal").on("hidden.bs.modal",function(){$("#error_explanation").hide()}),$("a.glyphicon-cog").click(function(){return $("#profile_avatar").attr("src",$(".avatar_mini").attr("src"))}),$(".script").each(function(){eval_($(this).text())}),i=function(e,t){var i,n;return i=void 0,n=e.get(0),n.focus(),"number"==typeof n.selectionStart?(n.value=t,void(n.selectionStart=n.selectionEnd=t.length)):(i=n.createTextRange(),i.text=t,void i.select())},e=$("#message"),n=e.get(0),void 0!==n&&(e.focus(),"number"==typeof n.selectionStart?n.selectionStart=n.selectionEnd=e.val().length:(t=n.createTextRange(),t.select()),e.keyup())})}.call(this),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){function t(){var t=i(this),r=o.settings;return isNaN(t.datetime)||(0==r.cutoff||s(t.datetime)<r.cutoff)&&e(this).text(n(t.datetime)),this}function i(t){if(t=e(t),!t.data("timeago")){t.data("timeago",{datetime:o.datetime(t)});var i=e.trim(t.text());o.settings.localeTitle?t.attr("title",t.data("timeago").datetime.toLocaleString()):!(i.length>0)||o.isTime(t)&&t.attr("title")||t.attr("title",i)}return t.data("timeago")}function n(e){return o.inWords(s(e))}function s(e){return(new Date).getTime()-e.getTime()}e.timeago=function(t){return n(t instanceof Date?t:"string"==typeof t?e.timeago.parse(t):"number"==typeof t?new Date(t):e.timeago.datetime(t))};var o=e.timeago;e.extend(e.timeago,{settings:{refreshMillis:6e4,allowPast:!0,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",inPast:"any moment now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(t){function i(i,s){var o=e.isFunction(i)?i(s,t):i,r=n.numbers&&n.numbers[s]||s;return o.replace(/%d/i,r)}if(!this.settings.allowPast&&!this.settings.allowFuture)throw"timeago allowPast and allowFuture settings can not both be set to false.";var n=this.settings.strings,s=n.prefixAgo,o=n.suffixAgo;if(this.settings.allowFuture&&0>t&&(s=n.prefixFromNow,o=n.suffixFromNow),!this.settings.allowPast&&t>=0)return this.settings.strings.inPast;var r=Math.abs(t)/1e3,a=r/60,l=a/60,c=l/24,d=c/365,u=45>r&&i(n.seconds,Math.round(r))||90>r&&i(n.minute,1)||45>a&&i(n.minutes,Math.round(a))||90>a&&i(n.hour,1)||24>l&&i(n.hours,Math.round(l))||42>l&&i(n.day,1)||30>c&&i(n.days,Math.round(c))||45>c&&i(n.month,1)||365>c&&i(n.months,Math.round(c/30))||1.5>d&&i(n.year,1)||i(n.years,Math.round(d)),h=n.wordSeparator||"";return void 0===n.wordSeparator&&(h=" "),e.trim([s,u,o].join(h))},parse:function(t){var i=e.trim(t);return i=i.replace(/\.\d+/,""),i=i.replace(/-/,"/").replace(/-/,"/"),i=i.replace(/T/," ").replace(/Z/," UTC"),i=i.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),i=i.replace(/([\+\-]\d\d)$/," $100"),new Date(i)},datetime:function(t){var i=e(t).attr(o.isTime(t)?"datetime":"title");return o.parse(i)},isTime:function(t){return"time"===e(t).get(0).tagName.toLowerCase()}});var r={init:function(){var i=e.proxy(t,this);i();var n=o.settings;n.refreshMillis>0&&(this._timeagoInterval=setInterval(i,n.refreshMillis))},update:function(i){var n=o.parse(i);e(this).data("timeago",{datetime:n}),o.settings.localeTitle&&e(this).attr("title",n.toLocaleString()),t.apply(this)},updateFromDOM:function(){e(this).data("timeago",{datetime:o.parse(e(this).attr(o.isTime(this)?"datetime":"title"))}),t.apply(this)},dispose:function(){this._timeagoInterval&&(window.clearInterval(this._timeagoInterval),this._timeagoInterval=null)}};e.fn.timeago=function(e,t){var i=e?r[e]:r.init;if(!i)throw new Error("Unknown function name '"+e+"' for timeago");return this.each(function(){i.call(this,t)}),this},document.createElement("abbr"),document.createElement("time")}),function(){var e;e="undefined"!=typeof exports&&null!==exports?exports:this,this.system_message=function(e){var t;t=new FormData,t.append("messages[body]",$.trim(e)),t.append("messages[room_id]",gon.room_id),t.append("messages[message_type]","system"),$.ajax({type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},url:"/messages",data:t,processData:!1,contentType:!1})},$(document).ready(function(){var t,i,n,s,o,r,a,l,c,d,u,h,p,f,m,g,v,y,b,w,_,x,k,S,C,T,E,P;k=function(){var e,t;for(t=document.getElementsByClassName("chat-body"),e=0;e<t.length;)emojify.run(t[e]),e++},n=function(e){var t;return t=location.origin+e,t.match(/http.*(jpg|JPG|gif|jpeg|png)/)?'<a href="'+t+'"></a><img src="'+t+'" height="200px" width="200px"/>':'<a href="'+t+'" download><span class="glyphicon glyphicon-download-alt"></span>'+e.match(/(\w|[-.])+$/)[0]+"</a>"},w=function(){var e;++s,31===s&&u!==!0&&$(".chat").prepend('<div class="pag"><div class="glyphicon glyphicon-chevron-up"></div></div>'),$('input[type="file"]')[0].files[0]&&$(".input").block({message:'<img src="../img/busy.gif" /><p>File uploading, please wait</p>',css:{}}),($.trim(d.val()).length>0||$('input[type="file"]')[0].files[0])&&(e=new FormData,e.append("messages[body]",$.trim(d.val())),e.append("messages[room_id]",gon.room_id),e.append("messages[attach_path]",$('input[type="file"]')[0].files[0]),$.ajax({type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},url:"/messages",data:e,processData:!1,contentType:!1,success:function(){$("#new_message")[0].reset(),$(".input").unblock()},error:function(e){console.log(e)}}))},x=function(){var e;e=$("label.upload-but"),r.change(function(){r[0].files[0].size>5e6?($.bootstrapGrowl("File size over than 5mb",{type:"success",offset:{from:"bottom",amount:50},align:"center",width:250,delay:5e3,allow_dismiss:!0,stackup_spacing:10}),r.replaceWith(r.clone(!0))):(e.attr({id:"attach_popup","data-container":"body","data-content":'<div class="attach_wrapper"><div class="attach_header"><span class="glyphicon glyphicon-remove"></span></div><div class="attach_content"><span>'+r[0].files[0].name+"</span></div></div>","data-placement":"top","data-toggle":"popover",type:"button"}),d.focus(),e.popover({html:!0}),e.popover("show"),$(".popover-content").find("span.glyphicon.glyphicon-remove").click(function(){$("#attach_path").val(""),$(".attach_wrapper").remove(),e.popover("hide")}))})},p=function(e){$("#messages-wrapper").append(C(e)),$(".nano").nanoScroller(),$(".nano").nanoScroller({scroll:"bottom"}),k(),_()},l=function(){var e,i,s;for(s=$("li .chat-body p"),i=0;i<s.length;)s[i].innerHTML=t(s[i].innerHTML),emojify.run(s[i]),_(),i++;for(e=$(".attach_file"),i=0;i<e.length;)e[i].innerHTML=n(e[i].innerHTML),_(),i++},_=function(){return $.each($(".url_image"),function(e,t){var i,n;return n=$(t).attr("src"),n?(i=new Image,i.onload=function(){return function(){return $(t).attr("src",n)}}(this),i.onerror=function(){return function(){return $(t).remove()}}(this),i.src=n):void 0}),$.each($(".attach_file"),function(e,t){var i,n;return n=$(t).find("img").attr("src"),n?(i=new Image,i.onload=function(){return function(){return $(t).find("img").attr("src",n)}}(this),i.onerror=function(){return function(){return $(t).find("img").remove()}}(this),i.src=n):void 0})},t=function(e){var t,i,n,s,o,r;for(r=e.split(" "),n=[],t=0;t<r.length;)o=r[t],!o.match(/\@\S*/)||o.match(/<span>\@\S*/)||o.match(/\@\S*/g)[0]!=="@"+gon.user_login&&"@all"!==o.match(/\@\S*/g)[0]?o.match(/http.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?].\S\S*)/)?n.push(o.replace(/http.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?].\S\S*)/,'<br><iframe width="560" height="315" src="//www.youtube.com/embed/'+P(o)+'" frameborder="0" allowfullscreen></iframe><br>')):o.match(/http.*(jpg|JPG|gif|jpeg|png)/)?(s=o.match(/http.*(jpg|JPG|gif|jpeg|png)/),n.push(o.replace(/http.*(jpg|JPG|gif|jpeg|png)/," <a href="+s[0]+(">"+s[0]+"</a><img class='url_image' src=")+s[0]+' height="500px" width="300px"/>'))):o.match(/http:\/\/(coub\.com\/view\/.*|coub\.com\/embed\/.*)/i)?(o=o.replace("view","embed"),s='"'+o.slice(0,27)+'?muted=false&autostart=false&originalSize=false&hideTopBar=false&noSiteButtons=false&startWithHD=false"',n.push("<br><iframe src="+s+'" frameborder="0" allowfullscreen="true" height="315px" width="560px"></iframe><br>')):n.push(o.match(/(\b\w+:\/\/\w+((\.\w)*\w+)*\.\S{2,3}(\/\S*|\.\w*|\?\w*\=\S*)*)/)?"<a href="+o+' target="_blank">'+o+"</a>":o):n.push(o.replace(/\@\S*/,'<span class="to-user">'+$.trim(o.match(/\@\S*/)[0])+"</span> ")),t++;return i=n.join(" ")},P=function(e){var t,i;return i=/http.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?].\S\S*)/,t=e.match(i),t&&11===t[7].length?t[7]:void 0},f=function(e){return S[e]||e},m=function(e){return e.replace(/[&<>]/g,f)},a=function(e){$.ajax({url:"/users/invite_user",type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{email:e},success:function(e){$.bootstrapGrowl("You have send invite to: "+e,{type:"success",offset:{from:"top",amount:50},align:"center",width:250,delay:1e4,allow_dismiss:!0,stackup_spacing:10}),$("#search-user").val(""),$(".right_search_user").html("")}})},b=function(){$("li .send_invite").on("click",function(){a($("#search-user").val())})},Handlebars.registerHelper("equal",function(e){return gon.user_id===e?"from":($("#new-message")[0].play(),"to")}),Handlebars.registerHelper("safe_mess",function(e){return e.length>800?e.match(/http.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?].\S\S*)/)||e.match(/http.*(jpg|JPG|gif|jpeg|png)/)||e.match(/http:\/\/(coub\.com\/view\/.*|coub\.com\/embed\/.*)/i)?'<div id="short-text" style="display: block;"><small class="pull-right text-muted"><span class="glyphicon glyphicon-chevron-down" style="cursor: pointer;"></span></small><p class="primary-font"><div class="text-muted"><i>this message has a content...</i></div></p></div><div id="long-text" style="display: none;"><small class="pull-right text-muted"><span class="glyphicon glyphicon-chevron-up" style="cursor: pointer;"></span></small><p>'+$.trim(t(m(e)))+"</p></div>":e.match(/(\b\w+:\/\/\w+((\.\w)*\w+)*\.\S{2,3}(\/\S*|\.\w*|\?\w*\=\S*)*)/)?'<div id="short-text" style="display: block;"><small class="pull-right text-muted"><span class="glyphicon glyphicon-chevron-down" style="cursor: pointer;"></span></small><p><a href='+e.substr(0,109)+'..."  target="_blank">'+e.substr(0,109)+'...</a></p></div><div id="long-text" style="display: none;"><small class="pull-right text-muted"><span class="glyphicon glyphicon-chevron-up" style="cursor: pointer;"></span></small><p>'+$.trim(t(m(e)))+"</p></div>":'<div id="short-text" style="display: block;"><small class="pull-right text-muted"><span class="glyphicon glyphicon-chevron-down" style="cursor: pointer;"></span></small><p>'+$.trim(t(m(e))).substr(0,109)+'...</p></div><div id="long-text" style="display: none;"><small class="pull-right text-muted"><span class="glyphicon glyphicon-chevron-up" style="cursor: pointer;"></span></small><p>'+$.trim(t(m(e)))+"</p></div>":"<p>"+$.trim(t(m(e)))+"</p>"}),Handlebars.registerHelper("attach-files",function(e){return n(e)}),Handlebars.registerHelper("change_login",function(e,t,i,n){return null!=e?'<a href="/persons/'+t+'">'+i+" "+n+"</a>":"chat notification"}),C=Handlebars.compile($("#template_message").html()),$("#pop").popover({html:!0}),d=$("#message"),o=$("iframe"),g=$("#search"),r=$("input[type=file]#attach_path"),e.users=["all"].concat(gon.rooms_users),c=10,l(),x(),gon.room_id&&(console.log("gon.pusher_app",gon.pusher_app),h=new Pusher(gon.pusher_app,{cluster:"eu",authEndpoint:"/pusher/auth?room_id="+gon.room_id}),i=h.subscribe("private-"+gon.room_id),i.bind("new_message",function(e){var t;for(p(e),t=0;$("#messages-wrapper li").size()>30;)$("#messages-wrapper li").first().remove(),t++})),$(document).on("click",".smile",function(e){d.val(d.val()+$(e.target).attr("id")),d.focus()}),$(document).on("click",".show_smile",function(){o.each(function(){var e,t;t=$(this).attr("src"),e="?",-1!==t.indexOf("?")&&(e="&"),$(this).attr("src",t+e+"wmode=transparent")})}),$(".list").on("click",".drop_room_user",function(t){var i;i=t.currentTarget,e.joined_member=$(i).parent()}),$(".drop_room_user").confirm({text:"Are you sure you want to delete user?",title:"User deleting confirmation",confirm:function(){$.ajax({url:"/rooms_users/"+e.joined_member.data("user-id")+"/"+e.joined_member.data("room-id"),type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{_method:"DELETE",room_id:e.joined_member.data("room-id"),user_id:e.joined_member.data("user-id")},success:function(t){e.system_message("User: "+t.users.login+" has been deleted from room"),e.joined_member.remove(),$(".right_search").html(y(t))}})},confirmButton:"Yes I am",cancelButton:"No",post:!1}),$(".content").on("click",".delete_room",function(t){e.element_delete_room=t.currentTarget}),$(".delete_room").confirm({text:"Are you sure you want to delete this room?",title:"Confirmation required",confirm:function(){$.ajax({url:"../rooms/"+$(e.element_delete_room).data("id"),type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{_method:"DELETE"},success:function(){$(e.element_delete_room).parents("table.rooms_group").hide(),$("a[room_id='"+$(e.element_delete_room).data("id")+"']").parents("li#room").hide()}})},confirmButton:"Yes I am",cancelButton:"No",post:!1}),o.each(function(){var e,t,i,n,s;t=$(this).attr("src"),s="wmode=transparent",-1!==t.indexOf("?")?(e=t.split("?"),n=e[1],i=e[0],$(this).attr("src",i+"?"+s+"&"+n)):$(this).attr("src",t+"?"+s)}),$(".panel-footer").on("submit",function(){return w(),!1}),d.keydown(function(e){13===e.keyCode&&e.ctrlKey===!1&&(w(),r&&($(".attach_wrapper").remove(),$("label.upload-but").popover("hide"),d.val("")),e.preventDefault()),13===e.keyCode&&e.ctrlKey&&(document.getElementById("message").value+="\r\n")}),$(".send_message_button").click(function(){w(),r&&($(".attach_wrapper").remove(),$("label.upload-but").popover("hide")),d.val("")}),$("#search").keyup(function(){$.ajax({type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},url:"../messages/search/",data:{query:$("#search").val(),room_id:gon.room_id}}).done(function(e){$("#messages-wrapper").html(C(e)),k(),_()})}),s=0,u=!1,$(".pag").length>0&&(u=!0),S={"&":"&amp;","<":"&lt;",">":"&gt;"},$("#message").textcomplete([{match:/\B@([\-+\w]*)$/,search:function(e,t){t($.map(users,function(t){return 0===t.indexOf(e)?t:null}))},template:function(e){return"@"+e},replace:function(e){return"@"+e+" "},index:1,maxCount:5}]).on({"textComplete:show":function(){var e;e=setInterval(function(){$("ul.dropdown-menu:last").css("top",-$("ul.dropdown-menu:last").height())},100)}}),$(".friend").click(function(){var e;e=$(this),self.location=-1!==self.location.toString().indexOf("persons/")?e.attr("user_id"):"persons/"+e.attr("user_id")}),$(".rooms_group").on("click",".friend_action.add_friend",function(){$.ajax({type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},url:"/friendships",data:{friend_id:$(this).parent().attr("friend_id")},success:function(e){$('tr[friend_id = "'+e+'"]').remove(),$(".nano").nanoScroller()}})}),$(".friend_action.remove_friend").click(function(){$.ajax({url:"/friendships/"+$(this).attr("friend_id"),type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{_method:"DELETE",friend_id:$(this).attr("friend_id")},success:function(e){$('tr[friend_id = "'+e+'"]').remove(),$(".nano").nanoScroller()}})}),$(".chat").on("click",".pag",function(){$.ajax({url:"../rooms/previous_messages",type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{room_id:gon.room_id,messages:$(".clearfix").first().data("id")},success:function(e){e.messages.length>0&&($("#messages-wrapper").prepend(C(e)),k(),_(),c+=10)}})}),$(".inv").on("click",function(e){a($("#email").val()),e.preventDefault()}),E='{{#users}}<div class="member" data-toggle="tooltip" data-placement="bottom" title="{{firstname}} {{lastname}}"> <a data-method="post" href="/persons/{{login}}" rel="nofollow"> <span class="{{#get_icon_status user_status}}{{/get_icon_status}}"></span>{{login}}</a> <span class="glyphicon glyphicon-plus pull-right user_friend" data-user-id="{{id}}"></span> </div>{{/users}}',y=Handlebars.compile(E),$("#search-user").keyup(function(){""===$("#search-user").val()?$(".right_search").html(""):$(this).val().match(/^[-a-z0-9!#$%&'*+\/=?^_`{|}~]+(\.[-a-z0-9!#$%&'*+\/=?^_`{|}~]+)*@([a-z0-9]([-a-z0-9]{0,61}[a-z0-9])?\.)*(aero|arpa|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel|[a-z][a-z])$/)?($(".right_search").html("<li style='text-align:center'><button class='btn send_invite'>Send invite</button></li>"),b()):$.ajax({url:"/users/search",type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{login:$("#search-user").val(),room_id:$("li.active").find("a").attr("room_id")},success:function(e){$(".right_search").html(y(e))}})}),T='{{#users}}<tr friend_id="{{id}}"><td><div class="friend_photo"> <img class="avatar" src="{{avatar}}"></div> <div class="friend_name"></div><a href="/persons/{{login}}">{{login}}</a></td> <td class="friend_action add_friend"><span class="glyphicon glyphicon-plus add_new_friend"></span></td></tr>{{/users}}',v=Handlebars.compile(T),$("#search-box").keyup(function(){""===$("#search-box").val()?$(".rooms_group").html(""):$.ajax({url:"/users/search",type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{login:$("#search-box").val(),room_id:0},success:function(e){$(".rooms_group").html(v(e))}})}),$("body").on("click",function(e){$('[data-toggle="popover"]').each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$(".popover").has(e.target).length||$(this).popover("hide")})}),$(".content").on("click","#short-text .glyphicon.glyphicon-chevron-down",function(){$(this).parents(".message").find("#short-text").hide(),$(this).parents(".message").find("#long-text").show()}),$(".content").on("click","#long-text .glyphicon.glyphicon-chevron-up",function(){$(this).parents(".message").find("#short-text").show(),$(this).parents(".message").find("#long-text").hide()})})}.call(this),+function(e){"use strict";var t=function(i,n){this.options=e.extend({},t.DEFAULTS,n),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(i),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var e=this.$window.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(this.$element.is(":visible")){var i=e(document).height(),n=this.$window.scrollTop(),s=this.$element.offset(),o=this.options.offset,r=o.top,a=o.bottom;"object"!=typeof o&&(a=r=o),"function"==typeof r&&(r=o.top(this.$element)),"function"==typeof a&&(a=o.bottom(this.$element));var l=null!=this.unpin&&n+this.unpin<=s.top?!1:null!=a&&s.top+this.$element.height()>=i-a?"bottom":null!=r&&r>=n?"top":!1;if(this.affixed!==l){null!=this.unpin&&this.$element.css("top","");var c="affix"+(l?"-"+l:""),d=e.Event(c+".bs.affix");this.$element.trigger(d),d.isDefaultPrevented()||(this.affixed=l,this.unpin="bottom"==l?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(c).trigger(e.Event(c.replace("affix","affixed"))),"bottom"==l&&this.$element.offset({top:s.top}))}}};var i=e.fn.affix;e.fn.affix=function(i){return this.each(function(){var n=e(this),s=n.data("bs.affix"),o="object"==typeof i&&i;s||n.data("bs.affix",s=new t(this,o)),"string"==typeof i&&s[i]()})},e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=i,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),i=t.data();i.offset=i.offset||{},i.offsetBottom&&(i.offset.bottom=i.offsetBottom),i.offsetTop&&(i.offset.top=i.offsetTop),t.affix(i)})})}(jQuery),+function(e){"use strict";var t='[data-dismiss="alert"]',i=function(i){e(i).on("click",t,this.close)};i.prototype.close=function(t){function i(){o.trigger("closed.bs.alert").remove()}var n=e(this),s=n.attr("data-target");s||(s=n.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,""));var o=e(s);t&&t.preventDefault(),o.length||(o=n.hasClass("alert")?n:n.parent()),o.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(o.removeClass("in"),e.support.transition&&o.hasClass("fade")?o.one(e.support.transition.end,i).emulateTransitionEnd(150):i())};var n=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var n=e(this),s=n.data("bs.alert");s||n.data("bs.alert",s=new i(this)),"string"==typeof t&&s[t].call(n)})},e.fn.alert.Constructor=i,e.fn.alert.noConflict=function(){return e.fn.alert=n,this},e(document).on("click.bs.alert.data-api",t,i.prototype.close)}(jQuery),+function(e){"use strict";var t=function(i,n){this.$element=e(i),this.options=e.extend({},t.DEFAULTS,n),this.isLoading=!1};t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(t){var i="disabled",n=this.$element,s=n.is("input")?"val":"html",o=n.data();t+="Text",o.resetText||n.data("resetText",n[s]()),n[s](o[t]||this.options[t]),setTimeout(e.proxy(function(){"loadingText"==t?(this.isLoading=!0,n.addClass(i).attr(i,i)):this.isLoading&&(this.isLoading=!1,n.removeClass(i).removeAttr(i))},this),0)},t.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var i=this.$element.find("input");"radio"==i.prop("type")&&(i.prop("checked")&&this.$element.hasClass("active")?e=!1:t.find(".active").removeClass("active")),e&&i.prop("checked",!this.$element.hasClass("active")).trigger("change")}e&&this.$element.toggleClass("active")};var i=e.fn.button;e.fn.button=function(i){return this.each(function(){var n=e(this),s=n.data("bs.button"),o="object"==typeof i&&i;s||n.data("bs.button",s=new t(this,o)),"toggle"==i?s.toggle():i&&s.setState(i)})},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=i,this},e(document).on("click.bs.button.data-api","[data-toggle^=button]",function(t){var i=e(t.target);i.hasClass("btn")||(i=i.closest(".btn")),i.button("toggle"),t.preventDefault()})}(jQuery),+function(e){"use strict";var t=function(t,i){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},t.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(".item"),this.$items.index(this.$active)},t.prototype.to=function(t){var i=this,n=this.getActiveIndex();return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){i.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){return this.sliding?void 0:this.slide("next")},t.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},t.prototype.slide=function(t,i){var n=this.$element.find(".item.active"),s=i||n[t](),o=this.interval,r="next"==t?"left":"right",a="next"==t?"first":"last",l=this;if(!s.length){if(!this.options.wrap)return;s=this.$element.find(".item")[a]()}if(s.hasClass("active"))return this.sliding=!1;var c=e.Event("slide.bs.carousel",{relatedTarget:s[0],direction:r});return this.$element.trigger(c),c.isDefaultPrevented()?void 0:(this.sliding=!0,o&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid.bs.carousel",function(){var t=e(l.$indicators.children()[l.getActiveIndex()]);t&&t.addClass("active")})),e.support.transition&&this.$element.hasClass("slide")?(s.addClass(t),s[0].offsetWidth,n.addClass(r),s.addClass(r),n.one(e.support.transition.end,function(){s.removeClass([t,r].join(" ")).addClass("active"),n.removeClass(["active",r].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger("slid.bs.carousel")},0)}).emulateTransitionEnd(1e3*n.css("transition-duration").slice(0,-1))):(n.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger("slid.bs.carousel")),o&&this.cycle(),this)};var i=e.fn.carousel;e.fn.carousel=function(i){return this.each(function(){var n=e(this),s=n.data("bs.carousel"),o=e.extend({},t.DEFAULTS,n.data(),"object"==typeof i&&i),r="string"==typeof i?i:o.slide;s||n.data("bs.carousel",s=new t(this,o)),"number"==typeof i?s.to(i):r?s[r]():o.interval&&s.pause().cycle()})},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=i,this},e(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(t){var i,n=e(this),s=e(n.attr("data-target")||(i=n.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")),o=e.extend({},s.data(),n.data()),r=n.attr("data-slide-to");r&&(o.interval=!1),s.carousel(o),(r=n.attr("data-slide-to"))&&s.data("bs.carousel").to(r),t.preventDefault()}),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var t=e(this);t.carousel(t.data())})})}(jQuery),+function(e){"use strict";var t=function(i,n){this.$element=e(i),this.options=e.extend({},t.DEFAULTS,n),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},t.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t=e.Event("show.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var i=this.$parent&&this.$parent.find("> .panel > .in");if(i&&i.length){var n=i.data("bs.collapse");if(n&&n.transitioning)return;i.collapse("hide"),n||i.data("bs.collapse",null)}var s=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[s](0),this.transitioning=1;var o=function(t){return t&&t.target!=this.$element[0]?void this.$element.one(e.support.transition.end,e.proxy(o,this)):(this.$element.removeClass("collapsing").addClass("collapse in")[s]("auto"),this.transitioning=0,void this.$element.trigger("shown.bs.collapse"))};if(!e.support.transition)return o.call(this);var r=e.camelCase(["scroll",s].join("-"));this.$element.one(e.support.transition.end,e.proxy(o,this)).emulateTransitionEnd(350)[s](this.$element[0][r])}}},t.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var n=function(t){return t&&t.target!=this.$element[0]?void this.$element.one(e.support.transition.end,e.proxy(n,this)):(this.transitioning=0,void this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse"))};return e.support.transition?void this.$element[i](0).one(e.support.transition.end,e.proxy(n,this)).emulateTransitionEnd(350):n.call(this)}}},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var i=e.fn.collapse;e.fn.collapse=function(i){return this.each(function(){var n=e(this),s=n.data("bs.collapse"),o=e.extend({},t.DEFAULTS,n.data(),"object"==typeof i&&i);!s&&o.toggle&&"show"==i&&(i=!i),s||n.data("bs.collapse",s=new t(this,o)),"string"==typeof i&&s[i]()
})},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=i,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var i,n=e(this),s=n.attr("data-target")||t.preventDefault()||(i=n.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),o=e(s),r=o.data("bs.collapse"),a=r?"toggle":n.data(),l=n.attr("data-parent"),c=l&&e(l);r&&r.transitioning||(c&&c.find('[data-toggle="collapse"][data-parent="'+l+'"]').not(n).addClass("collapsed"),n[o.hasClass("in")?"addClass":"removeClass"]("collapsed")),o.collapse(a)})}(jQuery),+function(e){"use strict";function t(t){e(n).remove(),e(s).each(function(){var n=i(e(this)),s={relatedTarget:this};n.hasClass("open")&&(n.trigger(t=e.Event("hide.bs.dropdown",s)),t.isDefaultPrevented()||n.removeClass("open").trigger("hidden.bs.dropdown",s))})}function i(t){var i=t.attr("data-target");i||(i=t.attr("href"),i=i&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n=i&&e(i);return n&&n.length?n:t.parent()}var n=".dropdown-backdrop",s='[data-toggle="dropdown"]',o=function(t){e(t).on("click.bs.dropdown",this.toggle)};o.prototype.toggle=function(n){var s=e(this);if(!s.is(".disabled, :disabled")){var o=i(s),r=o.hasClass("open");if(t(),!r){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t);var a={relatedTarget:this};if(o.trigger(n=e.Event("show.bs.dropdown",a)),n.isDefaultPrevented())return;s.trigger("focus"),o.toggleClass("open").trigger("shown.bs.dropdown",a)}return!1}},o.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var n=e(this);if(t.preventDefault(),t.stopPropagation(),!n.is(".disabled, :disabled")){var o=i(n),r=o.hasClass("open");if(!r||r&&27==t.keyCode)return 27==t.which&&o.find(s).trigger("focus"),n.trigger("click");var a=" li:not(.divider):visible a",l=o.find('[role="menu"]'+a+', [role="listbox"]'+a);if(l.length){var c=l.index(l.filter(":focus"));38==t.keyCode&&c>0&&c--,40==t.keyCode&&c<l.length-1&&c++,~c||(c=0),l.eq(c).trigger("focus")}}}};var r=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var i=e(this),n=i.data("bs.dropdown");n||i.data("bs.dropdown",n=new o(this)),"string"==typeof t&&n[t].call(i)})},e.fn.dropdown.Constructor=o,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=r,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",s,o.prototype.toggle).on("keydown.bs.dropdown.data-api",s+', [role="menu"], [role="listbox"]',o.prototype.keydown)}(jQuery),+function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,i=t.closest("ul:not(.dropdown-menu)"),n=t.data("target");if(n||(n=t.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var s=i.find(".active:last a")[0],o=e.Event("show.bs.tab",{relatedTarget:s});if(t.trigger(o),!o.isDefaultPrevented()){var r=e(n);this.activate(t.parent("li"),i),this.activate(r,r.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:s})})}}},t.prototype.activate=function(t,i,n){function s(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),r?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),n&&n()}var o=i.find("> .active"),r=n&&e.support.transition&&o.hasClass("fade");r?o.one(e.support.transition.end,s).emulateTransitionEnd(150):s(),o.removeClass("in")};var i=e.fn.tab;e.fn.tab=function(i){return this.each(function(){var n=e(this),s=n.data("bs.tab");s||n.data("bs.tab",s=new t(this)),"string"==typeof i&&s[i]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=i,this},e(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(jQuery),+function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return{end:t[i]};return!1}e.fn.emulateTransitionEnd=function(t){var i=!1,n=this;e(this).one(e.support.transition.end,function(){i=!0});var s=function(){i||e(n).trigger(e.support.transition.end)};return setTimeout(s,t),this},e(function(){e.support.transition=t()})}(jQuery),+function(e){"use strict";function t(i,n){var s,o=e.proxy(this.process,this);this.$element=e(e(i).is("body")?window:i),this.$body=e("body"),this.$scrollElement=this.$element.on("scroll.bs.scrollspy",o),this.options=e.extend({},t.DEFAULTS,n),this.selector=(this.options.target||(s=e(i).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=e([]),this.targets=e([]),this.activeTarget=null,this.refresh(),this.process()}t.DEFAULTS={offset:10},t.prototype.refresh=function(){var t=this.$element[0]==window?"offset":"position";this.offsets=e([]),this.targets=e([]);var i=this;this.$body.find(this.selector).map(function(){var n=e(this),s=n.data("target")||n.attr("href"),o=/^#./.test(s)&&e(s);return o&&o.length&&o.is(":visible")&&[[o[t]().top+(!e.isWindow(i.$scrollElement.get(0))&&i.$scrollElement.scrollTop()),s]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){i.offsets.push(this[0]),i.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,i=this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight),n=i-this.$scrollElement.height(),s=this.offsets,o=this.targets,r=this.activeTarget;if(t>=n)return r!=(e=o.last()[0])&&this.activate(e);if(r&&t<=s[0])return r!=(e=o[0])&&this.activate(e);for(e=s.length;e--;)r!=o[e]&&t>=s[e]&&(!s[e+1]||t<=s[e+1])&&this.activate(o[e])},t.prototype.activate=function(t){this.activeTarget=t,e(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var i=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(i).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")};var i=e.fn.scrollspy;e.fn.scrollspy=function(i){return this.each(function(){var n=e(this),s=n.data("bs.scrollspy"),o="object"==typeof i&&i;s||n.data("bs.scrollspy",s=new t(this,o)),"string"==typeof i&&s[i]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=i,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(jQuery),+function(e){"use strict";var t=function(t,i){this.options=i,this.$body=e(document.body),this.$element=e(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},t.prototype.show=function(t){var i=this,n=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var n=e.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),n&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var s=e.Event("shown.bs.modal",{relatedTarget:t});n?i.$element.find(".modal-dialog").one(e.support.transition.end,function(){i.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(300):i.$element.trigger("focus").trigger(s)}))},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=e.support.transition&&i;if(this.$backdrop=e('<div class="modal-backdrop '+i+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;n?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()},t.prototype.checkScrollbar=function(){document.body.clientWidth>=window.innerWidth||(this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar())},t.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0);this.scrollbarWidth&&this.$body.css("padding-right",e+this.scrollbarWidth)},t.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},t.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var i=e.fn.modal;e.fn.modal=function(i,n){return this.each(function(){var s=e(this),o=s.data("bs.modal"),r=e.extend({},t.DEFAULTS,s.data(),"object"==typeof i&&i);o||s.data("bs.modal",o=new t(this,r)),"string"==typeof i?o[i](n):r.show&&o.show(n)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=i,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var i=e(this),n=i.attr("href"),s=e(i.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),o=s.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(n)&&n},s.data(),i.data());i.is("a")&&t.preventDefault(),s.modal(o,this).one("hide",function(){i.is(":visible")&&i.trigger("focus")})})}(jQuery),+function(e){"use strict";var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},t.prototype.init=function(t,i,n){this.enabled=!0,this.type=t,this.$element=e(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);for(var s=this.options.trigger.split(" "),o=s.length;o--;){var r=s[o];if("click"==r)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=r){var a="hover"==r?"mouseenter":"focusin",l="hover"==r?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&e.each(this._options,function(e,n){i[e]!=n&&(t[e]=n)}),t},t.prototype.enter=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show()},t.prototype.leave=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide()},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(t),t.isDefaultPrevented())return;var i=this,n=this.tip();this.setContent(),this.options.animation&&n.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,n[0],this.$element[0]):this.options.placement,o=/\s?auto?\s?/i,r=o.test(s);r&&(s=s.replace(o,"")||"top"),n.detach().css({top:0,left:0,display:"block"}).addClass(s),this.options.container?n.appendTo(this.options.container):n.insertAfter(this.$element);var a=this.getPosition(),l=n[0].offsetWidth,c=n[0].offsetHeight;if(r){var d=s,u=this.$element.parent(),h=this.getPosition(u);s="bottom"==s&&a.top+a.height+c-h.scroll>h.height?"top":"top"==s&&a.top-h.scroll-c<0?"bottom":"right"==s&&a.right+l>h.width?"left":"left"==s&&a.left-l<h.left?"right":s,n.removeClass(d).addClass(s)}var p=this.getCalculatedOffset(s,a,l,c);this.applyPlacement(p,s),this.hoverState=null;var f=function(){i.$element.trigger("shown.bs."+i.type)};e.support.transition&&this.$tip.hasClass("fade")?n.one(e.support.transition.end,f).emulateTransitionEnd(150):f()}},t.prototype.applyPlacement=function(t,i){var n=this.tip(),s=n[0].offsetWidth,o=n[0].offsetHeight,r=parseInt(n.css("margin-top"),10),a=parseInt(n.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(a)&&(a=0),t.top=t.top+r,t.left=t.left+a,e.offset.setOffset(n[0],e.extend({using:function(e){n.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),n.addClass("in");var l=n[0].offsetWidth,c=n[0].offsetHeight;"top"==i&&c!=o&&(t.top=t.top+o-c);var d=this.getViewportAdjustedDelta(i,t,l,c);d.left?t.left+=d.left:t.top+=d.top;var u=d.left?2*d.left-s+l:2*d.top-o+c,h=d.left?"left":"top",p=d.left?"offsetWidth":"offsetHeight";n.offset(t),this.replaceArrow(u,n[0][p],h)},t.prototype.replaceArrow=function(e,t,i){this.arrow().css(i,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(){function t(){"in"!=i.hoverState&&n.detach(),i.$element.trigger("hidden.bs."+i.type)}var i=this,n=this.tip(),s=e.Event("hide.bs."+this.type);return this.$element.trigger(s),s.isDefaultPrevented()?void 0:(n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?n.one(e.support.transition.end,t).emulateTransitionEnd(150):t(),this.hoverState=null,this)},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(t){t=t||this.$element;var i=t[0],n="BODY"==i.tagName;return e.extend({},"function"==typeof i.getBoundingClientRect?i.getBoundingClientRect():null,{scroll:n?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop(),width:n?e(window).width():t.outerWidth(),height:n?e(window).height():t.outerHeight()},n?{top:0,left:0}:t.offset())},t.prototype.getCalculatedOffset=function(e,t,i,n){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-i/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-i}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},t.prototype.getViewportAdjustedDelta=function(e,t,i,n){var s={top:0,left:0};if(!this.$viewport)return s;var o=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(e)){var a=t.top-o-r.scroll,l=t.top+o-r.scroll+n;a<r.top?s.top=r.top-a:l>r.top+r.height&&(s.top=r.top+r.height-l)}else{var c=t.left-o,d=t.left+o+i;c<r.left?s.left=r.left-c:d>r.width&&(s.left=r.left+r.width-d)}return s},t.prototype.getTitle=function(){var e,t=this.$element,i=this.options;return e=t.attr("data-original-title")||("function"==typeof i.title?i.title.call(t[0]):i.title)},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var i=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;i.tip().hasClass("in")?i.leave(i):i.enter(i)},t.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var i=e.fn.tooltip;e.fn.tooltip=function(i){return this.each(function(){var n=e(this),s=n.data("bs.tooltip"),o="object"==typeof i&&i;(s||"destroy"!=i)&&(s||n.data("bs.tooltip",s=new t(this,o)),"string"==typeof i&&s[i]())})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=i,this}}(jQuery),+function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),i=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").empty()[this.options.html?"string"==typeof i?"html":"append":"text"](i),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var i=e.fn.popover;e.fn.popover=function(i){return this.each(function(){var n=e(this),s=n.data("bs.popover"),o="object"==typeof i&&i;(s||"destroy"!=i)&&(s||n.data("bs.popover",s=new t(this,o)),"string"==typeof i&&s[i]())})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=i,this}}(jQuery),function(){var e;e=$("#myModal"),$("#modal-submit").click(function(){e.hide(),$(".modal-backdrop").hide()}),jQuery(function(t){var i;t(".create-room").on("click",function(){var e,i;return e=t(this).parents(".member").attr("data-user-login"),i=t(this).parents(".member").attr("data-user-id"),parseInt(i)!==gon.user_id&&t.ajax({type:"POST",url:"/rooms",data:{express:!0,room:{name:gon.user_login+" vs. "+e,topic:"express chat"},user_id:i}}).done(function(e){self.location=e}),!1}),t(".go-profile").on("click",function(){var e,i;return e=t(this).parents(".member").attr("data-user-login"),i=t(this).parents(".member").attr("data-user-id"),self.location="/persons/"+e,!1}),i=function(){var e,i;e=t("#drop1.change_topic.glyphicon.glyphicon-pencil"),i=e.data("id"),t.ajax({type:"PUT",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",t('meta[name="csrf-token"]').attr("content"))},url:"/rooms/"+i,data:{query:t("input[name='change']").val(),room_id:gon.room_id}}).done(function(e){window.system_message('Rooms topic has been changed from: "'+e.prev_topic+'" on: "'+e.curr_topic+'"'),t("#change").val("")})},e.on("click","#modal-submit",function(){e.modal("hide")}),t(".right_search_user").on("click",".user_friend",function(){return t.ajax({url:"/rooms_users",type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",t('meta[name="csrf-token"]').attr("content"))},data:{room_id:gon.room_id,user_id:t(this).data("user-id")}}).done(function(e){window.system_message("User: "+e.joined_user.login+" has been added to room: "+e.room_name),t(".user_friend[data-user-id = "+e.joined_user.id+"]").parent().remove()}),!1}),t(".change-topic").on("submit",function(){return i(),!1})})}.call(this),function(){$(document).ready(function(){var e;return $("body").append("<div id='dialog-modal' title='Video dialog'></div>"),$("#dialog-modal").hide,e=!0,$(".video-chat").click(function(){var t,i,n;return e===!0&&($("#dialog-modal").html(""),$("#dialog-modal").append("<div id='videos-container'></div></section>"),t=new RTCMultiConnection,i="https://chat.firebaseio.com/",n=new Firebase(i+t.channel+"-session"),console.log("roomFirebase",n),n.once("value",function(i){var s;e=!1,s=i.val(),null==s?($.ajax({url:"/rooms_users",type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{room_id:gon.room_id,user_id:gon.user_id}}).done(function(){window.system_message("User: "+gon.user_login+" has been created video conference")}),t.open(t.sessionid),n.set(t.sessionDescription),n.onDisconnect().remove()):t.join(s),console.debug("room is present?",null==s)})),$("#dialog-modal").dialog(),$(".ui-dialog-titlebar-close").click(function(){return t.leave(),t.autoCloseEntireSession=!0})})})}.call(this),$(document).ready(function(){var e=$("#dropZone"),t=5e5;e[0]&&("undefined"==typeof window.FileReader&&e.addClass("error"),e[0].ondragover=function(){return e.addClass("hover"),!1},e[0].ondragleave=function(){return e.removeClass("hover"),!1},e[0].ondrop=function(i){i.preventDefault(),e.removeClass("hover"),e.addClass("drop");var n=i.dataTransfer.files[0];if(n.size>t)return $.bootstrapGrowl("File size over than 1mb",{type:"success",offset:{from:"bottom",amount:50},align:"center",width:250,delay:5e3,allow_dismiss:!0,stackup_spacing:10}),e.addClass("error"),!1;var s=new FormData;s.append("messages[body]",$("#message").val()),s.append("messages[room_id]",gon.room_id),s.append("messages[attach_path]",n),$.ajax({type:"POST",url:"/messages",data:s,processData:!1,contentType:!1,success:function(){$("#new_message")[0].reset()},error:function(e){console.log(e)}})}),jQuery.ajaxSetup({beforeSend:function(e){e.setRequestHeader("Accept","text/javascript")}}),$.fn.ajaxPagination=function(){this.on("click",function(){return $.get(this.href,null,null,"script"),!1})},$(document).ready(function(){$(".pagination a").ajaxPagination()})}),window.onload=function(){if(ieversion=msieversion(),10>ieversion&&ieversion>=3){var e=document.createElement("div");e.className="bws_reload",$("body").html('<div class="cwrp"><h1>Did you know that your Internet Browser is out of date?</h1><p>Your browser is out of date, and may not be compatible with our website. </p> <p> A list of the most popular web browsers can be found below. It is insistently recommended to you to choose and establish any of modern browsers.</p><p>Just click on the icons to get to the download page.  It is free of charge and also will take only some minutes.</p><ul><li class="firefox"><h2>Mozilla Firefox</h2><div><ul class="file"><li style="padding-left: 0px;"><noindex><a rel="nofollow" href="http://www.mozilla.org/en-US/firefox/new/">Mozilla Firefox</a></noindex></li></ul></div></li><li class="chrome"><h2>Google Chrome</h2><div><ul class="file"><li style="padding-left: 0px;"><noindex><a rel="nofollow" href="https://www.google.com/intl/en/chrome/browser/">Google Chrome</a></noindex></li></ul></div></li><li class="opera"><h2>Opera</h2><div><ul class="file"><li style="padding-left: 0px;"><noindex><a rel="nofollow" href="http://www.opera.com/">Opera</a></noindex></li></ul></div></li><li class="ie"><h2>Internet Explorer</h2><div><ul class="file"><li style="padding-left: 0px;"><noindex><a rel="nofollow" href="http://windows.microsoft.com/en-us/windows/home">Internet Explorer</a></noindex></li></ul></div></li></ul></div>'),document.body.appendChild(e)}},function(){var e,t,i,n,s,o,r,a,l,c,d;a="undefined"!=typeof exports&&null!==exports?exports:this,this.get_user_status_style=function(e){switch(e){case"Available":return"glyphicon glyphicon-eye-open drop-av drop-col-mar";case"Away":return"glyphicon glyphicon-eye-close drop-away drop-col-mar";case"Do not disturb":return"glyphicon glyphicon-eye-close drop-dnd drop-col-mar";case"Help":return"glyphicon glyphicon-question-sign drop-hlp drop-col-mar";case"Offline":return"glyphicon glyphicon-eye-close drop-col-mar"}},console.log("gon.pusher_app",gon.pusher_app),Handlebars.registerHelper("get_icon_status",function(e){return get_user_status_style(e)}),Handlebars.registerHelper("set_user_to_drop",function(e){var t;return t="",e===gon.user_id&&(t='<span class="glyphicon glyphicon-minus pull-right drop_room_user"></span>'),t}),l='<div class="member" id="{{user_id}}" data-room-id="{{room_id}}" data-toggle="tooltip" data-user-id="{{user_id}}" title="{{user_status}}"> <span class ="{{#get_icon_status user_status}}{{/get_icon_status}}"></span> <a href="#">{{user_firstname}} {{user_lastname}}</a>{{#set_user_to_drop rooms_owner_id}}{{/set_user_to_drop}}</div>',e=Handlebars.compile(l),c=void 0,d=void 0,r=new Pusher(gon.pusher_app,{cluster:"eu"}),s=r.subscribe("presence-status"),s.bind("change_status",function(e){var t;t=$("div[data-user-id="+e.user_id+"]"),t.attr("title",e.status),$("div[friend_id="+e.user_id+"]").find("a > span").attr("class",get_user_status_style(e.status)),t.find(":first-child").attr("class",get_user_status_style(e.status)),window.location.toString().match(/\/persons\//)&&("Offline"===e.status?$("#last_activity").html("Last seen at:"+jQuery.timeago(e.user_sign_out_time)):t.attr("title",e.status),$("#last_activity").html(""))}),s.bind("pusher:member_removed",function(e){var t;d=setTimeout(t=function(){$.ajax({type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},url:"../pusher/stat/",data:{client_status:"Offline",user_id:e.id}})},5e3)}),s.bind("pusher:member_added",function(e){clearTimeout(d),$.ajax({type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},url:"../pusher/stat/",data:{client_status:"Available",user_id:e.id}})}),s.bind("delete_room",function(e){$("table[data-room='"+e.room_id+"']").hide(),$("a[room_id='"+e.room_id+"']").parents("li#room").hide()}),o=new Pusher(gon.pusher_app,{cluster:"eu"}),i=o.subscribe("private-"+gon.user_id),i.bind("user_add_to_room",function(e){var t,i;$.bootstrapGrowl("You have been added to the room: "+e.rooms_name,{type:"success",offset:{from:"top",amount:50},align:"center",width:250,delay:1e4,allow_dismiss:!0,stackup_spacing:10},gon.room_members_count=e.room_members_count),$(".lobby-panel #tabs").append('<li id="room"><a room_id='+e.rooms_id+" href=/rooms/"+e.rooms_id+">"+e.rooms_name+"</a></li>"),t="",gon.user_id===e.rooms_owner_id&&(t="<span class='delete_room glyphicon glyphicon-remove-circle' data-id='"+e.rooms_id+"'></span>"),$("div#room_list").append("<table class='rooms_group' data-room='"+e.rooms_id+"'><tr><td class='name'><a class='clean'><a href='/rooms/"+e.rooms_id+"' room_id='"+e.rooms_id+"'>"+e.rooms_name+"</a></a></td><td class='memb-count'>"+e.room_members_count+" members</td><td class='owner'> Owned by: <a href='/persons/"+e.room_owner_id+"'>"+e.rooms_owner_login+"</a></td><td class='set-arr'>"+t+"</td></tr></table>"),i=e.rooms_owner_id}),i.bind("private_del_user_from_room",function(e){$.bootstrapGrowl("You have been removed from the room: "+e.rooms_name,{type:"success",offset:{from:"top",amount:50},align:"center",width:250,delay:1e4,allow_dismiss:!0,stackup_spacing:10}),$("a[room_id='"+e.room_id+"']").parent().remove(),"/rooms"===self.location.pathname&&$(".rooms_group[data-room='"+e.room_id+"']").remove(),"/rooms"!==self.location.pathname&&(self.location="/rooms")}),gon.room_id&&(o=new Pusher(gon.pusher_app,{cluster:"eu",authEndpoint:"/pusher/auth?room_id="+gon.room_id}),t=o.subscribe("private-"+gon.room_id),n=o.subscribe("private-"+gon.user_id),n.bind("notification-room",function(e){var t,i,n;e.room_id!==parseInt(gon.room_id)&&(t=function(){document.title=document.title===n?i:n},clearTimeout(c),i="New message",n=document.title,c=setInterval(t,800),$('li#room a[room_id="'+e.room_id+'"]').parent().css("background-color","#999"))}),t.bind("add_user_to_room",function(t){var i;gon.room_members_count=t.room_members_count,a.users.push(t.user_login),a.users.push(t.user_firstname),a.users.push(t.user_lastname),$(".list").append(e(t)),document.getElementById(t.user_id).title="Offline"===t.user_status?"Offline "+jQuery.timeago(t.user_sign_out_time):t.user_status,i=$(".member[id = '"+t.user_id+"']"),$(i.find(".drop_room_user")).confirm({text:"Are you sure you want to delete user?",title:"User deleting confirmation",confirm:function(){$.ajax({url:"/rooms_users/"+i.data("user-id")+"/"+i.data("room-id"),type:"POST",beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},data:{_method:"DELETE",room_id:i.attr("data-room-id"),user_id:i.attr("data-user-id")},success:function(e){var t;t=Handlebars.compile('{{#users}}<div class="member"><a data-method="post" href="/persons/{{login}}" rel="nofollow"><span class="{{#get_icon_status user_status}}{{/get_icon_status}}"></span>{{login}}</a><span class="glyphicon glyphicon-plus pull-right user_friend" data-user-id="{{id}}"></span></div>{{/users}}'),$(".right_search").append(t(e)),i.remove()}})},confirmButton:"Yes I am",cancelButton:"No",post:!1})}),t.bind("change-topic",function(e){$("h3.room_topic").text(e.topic)}),t.bind("del_user_from_room",function(e){$('.member[data-user-id = "'+e.drop_user_id+'"]').remove()})),window.onfocus=function(){clearTimeout(c),$("title").text("Chat")}}.call(this);